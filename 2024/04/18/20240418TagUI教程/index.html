<!DOCTYPE html>
<html lang="zh-CN,en,zh-TW,default">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="keywords" content="Hexo Theme Redefine">
    
    <meta name="author" content="Yiuhang Chan">
    <!-- preconnect -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

    
    <!--- Seo Part-->
    
    <link rel="canonical" href="https://www.yiuhangblog.com/2024/04/18/20240418tagui教程/"/>
    <meta name="robots" content="index,follow">
    <meta name="googlebot" content="index,follow">
    <meta name="revisit-after" content="1 days">
    
        <meta name="description" content="TagUI教程">
<meta property="og:type" content="article">
<meta property="og:title" content="TagUI教程">
<meta property="og:url" content="https://www.yiuhangblog.com/2024/04/18/20240418TagUI%E6%95%99%E7%A8%8B/index.html">
<meta property="og:site_name" content="角灯随笔">
<meta property="og:description" content="TagUI教程">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://imagedelivery.net/sodhLvOXTBoeXxRe03g_RA/d374c9e6-4a53-4e5d-d6ae-406ac41dee00/public">
<meta property="og:image" content="https://imagedelivery.net/sodhLvOXTBoeXxRe03g_RA/00378a81-5b77-4315-c312-b074a32f4b00/public">
<meta property="og:image" content="https://imagedelivery.net/sodhLvOXTBoeXxRe03g_RA/fd2c1247-9365-4d4c-734a-ada5ca4b6700/public">
<meta property="og:image" content="https://imagedelivery.net/sodhLvOXTBoeXxRe03g_RA/4109df34-da60-49eb-1acc-db8dde905d00/public">
<meta property="og:image" content="https://imagedelivery.net/sodhLvOXTBoeXxRe03g_RA/a53676d2-d7bb-4132-77a7-2562e9f35000/public">
<meta property="og:image" content="https://imagedelivery.net/sodhLvOXTBoeXxRe03g_RA/58ca9007-0872-4669-e310-d3316c655500/public">
<meta property="og:image" content="https://imagedelivery.net/sodhLvOXTBoeXxRe03g_RA/ff6d3171-0012-49e1-d65c-9d42b775e300/public">
<meta property="og:image" content="https://imagedelivery.net/sodhLvOXTBoeXxRe03g_RA/7333175d-893d-4eeb-a593-93f4cea6d600/public">
<meta property="og:image" content="https://imagedelivery.net/sodhLvOXTBoeXxRe03g_RA/070ba1ce-0e84-4c34-e1e2-4d03c36dbd00/public">
<meta property="article:published_time" content="2024-04-18T03:39:15.000Z">
<meta property="article:modified_time" content="2024-04-19T02:52:06.265Z">
<meta property="article:author" content="Yiuhang Chan">
<meta property="article:tag" content="基础">
<meta property="article:tag" content="理论">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://imagedelivery.net/sodhLvOXTBoeXxRe03g_RA/d374c9e6-4a53-4e5d-d6ae-406ac41dee00/public">
    
    
        <!-- Google tag (gtag.js) -->
        <script src="https://www.googletagmanager.com/gtag/js?id=G-MQ43G0NKCT"></script>
        <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-MQ43G0NKCT');
        </script>
    
    <!--- Icon Part-->
    <link rel="icon" type="image/png" href="https://imagedelivery.net/sodhLvOXTBoeXxRe03g_RA/e75f26bb-7787-428d-ec58-214a6faf9800/public" sizes="192x192">
    <link rel="apple-touch-icon" sizes="180x180" href="https://imagedelivery.net/sodhLvOXTBoeXxRe03g_RA/e75f26bb-7787-428d-ec58-214a6faf9800/public">
    <meta name="theme-color" content="#A1AFC9">
    <link rel="shortcut icon" href="https://imagedelivery.net/sodhLvOXTBoeXxRe03g_RA/e75f26bb-7787-428d-ec58-214a6faf9800/public">
    <!--- Page Info-->
    
    <title>
        
            TagUI教程 -
        
        角灯随笔
    </title>

    
<link rel="stylesheet" href="/fonts/Chillax/chillax.css">


    <!--- Inject Part-->
    

    
        <style>
    :root {
        --preloader-background-color: #fff;
        --preloader-text-color: #000;
    }

    @media (prefers-color-scheme: dark) {
        :root {
            --preloader-background-color: #202124;
            --preloader-text-color: #fff;
        }
    }

    @media (prefers-color-scheme: light) {
        :root {
            --preloader-background-color: #fff;
            --preloader-text-color: #000;
        }
    }

    @media (max-width: 600px) {
        .ml13 {
            font-size: 2.6rem !important; /* Adjust this value as needed */
        }
    }

    .preloader {
        display: flex;
        flex-direction: column;
        gap: 1rem; /* Tailwind 'gap-4' is 1rem */
        align-items: center;
        justify-content: center;
        position: fixed;
        padding: 12px;
        top: 0;
        right: 0;
        bottom: 0;
        left: 0;
        width: 100vw;
        height: 100vh; /* 'h-screen' is 100% of the viewport height */
        background-color: var(--preloader-background-color);
        z-index: 1100; /* 'z-[1100]' sets the z-index */
        transition: opacity 0.2s ease-in-out;
    }

    .ml13 {
        font-size: 3.2rem;
        /* text-transform: uppercase; */
        color: var(--preloader-text-color);
        letter-spacing: -1px;
        font-weight: 500;
        font-family: 'Chillax-Variable', sans-serif;
        text-align: center;
    }

    .ml13 .word {
        display: inline-flex;
        flex-wrap: wrap;
        white-space: nowrap;
    }

    .ml13 .letter {
        display: inline-block;
        line-height: 1em;
    }
</style>

<div class="preloader">
    
<script src="/js/libs/anime.min.js"></script>

    <h1 class="ml13">
        角灯随笔
    </h1>
    <script>
        var textWrapper = document.querySelector('.ml13');
        // Split text into words
        var words = textWrapper.textContent.trim().split(' ');

        // Clear the existing content
        textWrapper.innerHTML = '';

        // Wrap each word and its letters in spans
        words.forEach(function(word) {
            var wordSpan = document.createElement('span');
            wordSpan.classList.add('word');
            wordSpan.innerHTML = word.replace(/\S/g, "<span class='letter'>$&</span>");
            textWrapper.appendChild(wordSpan);
            textWrapper.appendChild(document.createTextNode(' ')); // Add space between words
        });


        anime.timeline({loop: true})
            .add({
                targets: '.ml13 .letter',
                translateY: [100,0],
                translateZ: 0,
                opacity: [0,1],
                easing: "easeOutExpo",
                duration: 1400,
                delay: (el, i) => 300 + 30 * i
            }).add({
            targets: '.ml13 .letter',
            translateY: [0,-100],
            opacity: [1,0],
            easing: "easeInExpo",
            duration: 1200,
            delay: (el, i) => 100 + 30 * i
        });

        let themeStatus = JSON.parse(localStorage.getItem('REDEFINE-THEME-STATUS'))?.isDark;

        // If the theme status is not found in local storage, check the preferred color scheme
        if (themeStatus === undefined || themeStatus === null) {
            if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                themeStatus = 'dark';
            } else {
                themeStatus = 'light';
            }
        }

        // Now you can use the themeStatus variable in your code
        if (themeStatus) {
            document.documentElement.style.setProperty('--preloader-background-color', '#202124');
            document.documentElement.style.setProperty('--preloader-text-color', '#fff');
        } else {
            document.documentElement.style.setProperty('--preloader-background-color', '#fff');
            document.documentElement.style.setProperty('--preloader-text-color', '#000');
        }

        window.addEventListener('load', function () {
            hidePreloaderAfterTimeout(1000); // Hide after 1000 milliseconds once the window has loaded
        });

        // Backup failsafe: Hide preloader after a maximum of 5000 milliseconds, regardless of the window load event
        hidePreloaderAfterTimeout(5000);

        function hidePreloaderAfterTimeout(delay) {
            setTimeout(function () {
                var preloader = document.querySelector('.preloader');
                preloader.style.opacity = '0';
                setTimeout(function () {
                    preloader.style.display = 'none';
                }, 200);
            }, delay);
        }
    </script>
</div>
    

    
<link rel="stylesheet" href="/css/style.css">


    
        
<link rel="stylesheet" href="/assets/build/styles.css">

    

    
<link rel="stylesheet" href="/fonts/fonts.css">

    
<link rel="stylesheet" href="/fonts/Satoshi/satoshi.css">

    <!--- Font Part-->
    
    
    
    


    <script id="hexo-configurations">
    window.config = {"hostname":"www.yiuhangblog.com","root":"/","language":["zh-CN","en","zh-TW","default"]};
    window.theme = {"articles":{"style":{"font_size":"16px","line_height":1.5,"image_border_radius":"14px","image_alignment":"center","image_caption":false,"link_icon":true,"title_alignment":"left","headings_top_spacing":{"h1":"5rem","h2":"4rem","h3":"2.8rem","h4":"2.5rem","h5":"2.2rem","h6":"2rem"}},"word_count":{"enable":true,"count":true,"min2read":true},"author_label":{"enable":false,"auto":false,"list":[]},"code_block":{"copy":true,"style":"mac","font":{"enable":false,"family":null,"url":null}},"toc":{"enable":true,"max_depth":6,"number":false,"expand":true,"init_open":true},"copyright":{"enable":true,"default":"cc_by_nc_sa"},"lazyload":true,"recommendation":{"enable":false,"title":"推荐阅读","limit":5,"mobile_limit":2,"placeholder":"/images/wallhaven-wqery6-light.webp","skip_dirs":[]}},"colors":{"primary":"#A1AFC9","secondary":null,"default_mode":"light"},"global":{"fonts":{"chinese":{"enable":false,"family":null,"url":null},"english":{"enable":false,"family":null,"url":null}},"content_max_width":"1000px","sidebar_width":"210px","hover":{"shadow":true,"scale":true},"scroll_progress":{"bar":true,"percentage":true},"website_counter":{"url":"https://cn.vercount.one/js","enable":true,"site_pv":true,"site_uv":true,"post_pv":true},"single_page":true,"preloader":true,"open_graph":true,"google_analytics":{"enable":true,"id":"G-MQ43G0NKCT"}},"home_banner":{"enable":true,"style":"fixed","image":{"light":"https://imagedelivery.net/sodhLvOXTBoeXxRe03g_RA/e63fc400-dd0e-4395-bd1b-9ee1ac3bfb00/public","dark":"https://imagedelivery.net/sodhLvOXTBoeXxRe03g_RA/a34140d6-7960-45dd-b8b5-c3ddd14d1f00/public"},"title":"角灯随笔","subtitle":{"text":["全栈也不是不行"],"hitokoto":{"enable":false,"api":"https://v1.hitokoto.cn"},"typing_speed":100,"backing_speed":80,"starting_delay":500,"backing_delay":1500,"loop":false,"smart_backspace":true},"text_color":{"light":"#fff","dark":"#d1d1b6"},"text_style":{"title_size":"2.8rem","subtitle_size":"1.5rem","line_height":1.2},"custom_font":{"enable":false,"family":null,"url":null},"social_links":{"enable":true,"style":"default","links":{"github":"https://github.com/CosmicTrace","instagram":null,"zhihu":null,"twitter":null,"email":"kenchansk0@gmail.com"},"qrs":null}},"plugins":{"feed":{"enable":true},"aplayer":{"enable":false,"type":"fixed","audios":[{"name":null,"artist":null,"url":null,"cover":null}]},"mermaid":{"enable":true,"version":"9.3.0"}},"version":"2.6.1","navbar":{"auto_hide":false,"color":{"left":"#f78736","right":"#367df7","transparency":35},"width":{"home":"1200px","pages":"1000px"},"links":{"Home":{"path":"/","icon":"fa-regular fa-house"},"Tags":{"icon":"fa-solid fa-tags","path":"/tags/"},"Categories":{"icon":"fa-solid fa-folder","path":"/categories/"},"Archives":{"path":"/archives","icon":"fa-regular fa-archive"},"娱乐":{"icon":"fa-solid fa-gamepad","submenus":{"王者荣耀":"/hok","守望先锋":"/ow","使命召唤":"/cod"}},"About":{"icon":"fa-regular fa-user","submenus":{"Me":"/about","Github":"https://github.com/CosmicTrace"}}},"search":{"enable":true,"preload":true}},"page_templates":{"friends_column":2,"tags_style":"blur"},"home":{"sidebar":{"enable":true,"position":"left","first_item":"menu","announcement":"谦逊","show_on_mobile":true,"links":null},"article_date_format":"auto","categories":{"enable":true,"limit":3},"tags":{"enable":true,"limit":8}},"footerStart":"2018/07/15 10:15:24"};
    window.lang_ago = {"second":"%s seconds ago","minute":"%s minutes ago","hour":"%s hours ago","day":"%s days ago","week":"%s weeks ago","month":"%s months ago","year":"%s years ago"};
    window.data = {"masonry":false};
  </script>
    
    <!--- Fontawesome Part-->
    
<link rel="stylesheet" href="/fontawesome/fontawesome.min.css">

    
<link rel="stylesheet" href="/fontawesome/brands.min.css">

    
<link rel="stylesheet" href="/fontawesome/solid.min.css">

    
<link rel="stylesheet" href="/fontawesome/regular.min.css">

    
    
    
    
<meta name="generator" content="Hexo 7.1.1"><link rel="alternate" href="/atom.xml" title="角灯随笔" type="application/atom+xml">
</head>


<body>
<div class="progress-bar-container">
    
        <span class="scroll-progress-bar"></span>
    

    
        <span class="pjax-progress-bar"></span>
<!--        <span class="swup-progress-icon">-->
<!--            <i class="fa-solid fa-circle-notch fa-spin"></i>-->
<!--        </span>-->
    
</div>


<main class="page-container" id="swup">

    

    <div class="main-content-container">


        <div class="main-content-header">
            <header class="navbar-container px-6 md:px-12">

    <div class="navbar-content ">
        <div class="left">
            
                <a class="logo-image" href="/">
                    <img src="https://imagedelivery.net/sodhLvOXTBoeXxRe03g_RA/e75f26bb-7787-428d-ec58-214a6faf9800/public">
                </a>
            
            <a class="logo-title" href="/">
                
                角灯随笔
                
            </a>
        </div>

        <div class="right">
            <!-- PC -->
            <div class="desktop">
                <ul class="navbar-list">
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class=""
                                   href="/"
                                        >
                                    <i class="fa-regular fa-house fa-fw"></i>
                                    首页
                                    
                                </a>

                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class=""
                                   href="/tags/"
                                        >
                                    <i class="fa-solid fa-tags fa-fw"></i>
                                    标签
                                    
                                </a>

                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class=""
                                   href="/categories/"
                                        >
                                    <i class="fa-solid fa-folder fa-fw"></i>
                                    分类
                                    
                                </a>

                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class=""
                                   href="/archives"
                                        >
                                    <i class="fa-regular fa-archive fa-fw"></i>
                                    归档
                                    
                                </a>

                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class="has-dropdown"
                                   href="#"
                                        onClick=&#34;return false;&#34;>
                                    <i class="fa-solid fa-gamepad fa-fw"></i>
                                    娱乐
                                    <i class="fa-solid fa-chevron-down fa-fw"></i>
                                </a>

                                <!-- Submenu -->
                                
                                    <ul class="sub-menu">
                                        
                                            <li>
                                                <a href="/hok">
                                                    王者荣耀
                                                </a>
                                            </li>
                                        
                                            <li>
                                                <a href="/ow">
                                                    守望先锋
                                                </a>
                                            </li>
                                        
                                            <li>
                                                <a href="/cod">
                                                    使命召唤
                                                </a>
                                            </li>
                                        
                                    </ul>
                                
                            </li>
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class="has-dropdown"
                                   href="#"
                                        onClick=&#34;return false;&#34;>
                                    <i class="fa-regular fa-user fa-fw"></i>
                                    关于
                                    <i class="fa-solid fa-chevron-down fa-fw"></i>
                                </a>

                                <!-- Submenu -->
                                
                                    <ul class="sub-menu">
                                        
                                            <li>
                                                <a href="/about">
                                                    ME
                                                </a>
                                            </li>
                                        
                                            <li>
                                                <a target="_blank" rel="noopener" href="https://github.com/CosmicTrace">
                                                    GITHUB
                                                </a>
                                            </li>
                                        
                                    </ul>
                                
                            </li>
                    
                    
                        <li class="navbar-item search search-popup-trigger">
                            <i class="fa-solid fa-magnifying-glass"></i>
                        </li>
                    
                </ul>
            </div>
            <!-- Mobile -->
            <div class="mobile">
                
                    <div class="icon-item search search-popup-trigger"><i class="fa-solid fa-magnifying-glass"></i>
                    </div>
                
                <div class="icon-item navbar-bar">
                    <div class="navbar-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Mobile sheet -->
    <div class="navbar-drawer h-screen w-full absolute top-0 left-0 bg-background-color flex flex-col justify-between">
        <ul class="drawer-navbar-list flex flex-col px-4 justify-center items-start">
            
                
                    

                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                           href="/"
                        >
                            <span>
                                首页
                            </span>
                            
                                <i class="fa-regular fa-house fa-sm fa-fw"></i>
                            
                        </a>
                        

                        
                    </li>
            
                
                    

                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                           href="/tags/"
                        >
                            <span>
                                标签
                            </span>
                            
                                <i class="fa-solid fa-tags fa-sm fa-fw"></i>
                            
                        </a>
                        

                        
                    </li>
            
                
                    

                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                           href="/categories/"
                        >
                            <span>
                                分类
                            </span>
                            
                                <i class="fa-solid fa-folder fa-sm fa-fw"></i>
                            
                        </a>
                        

                        
                    </li>
            
                
                    

                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                           href="/archives"
                        >
                            <span>
                                归档
                            </span>
                            
                                <i class="fa-regular fa-archive fa-sm fa-fw"></i>
                            
                        </a>
                        

                        
                    </li>
            
                
                    

                    <li class="drawer-navbar-item-sub text-base my-1.5 flex flex-col w-full">
                        
                        <div class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary cursor-pointer text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                             navbar-data-toggle="submenu-娱乐"
                        >
                            <span>
                                娱乐
                            </span>
                            
                                <i class="fa-solid fa-chevron-right fa-sm fa-fw transition-all"></i>
                            
                        </div>
                        

                        
                            <div class="flex-col items-start px-2 py-2 hidden" data-target="submenu-娱乐">
                                
                                    <div class="drawer-navbar-item text-base flex flex-col justify-center items-start hover:underline active:underline hover:underline-offset-1 rounded-3xl">
                                        <a class=" text-third-text-color text-xl"
                                           href="/hok">王者荣耀</a>
                                    </div>
                                
                                    <div class="drawer-navbar-item text-base flex flex-col justify-center items-start hover:underline active:underline hover:underline-offset-1 rounded-3xl">
                                        <a class=" text-third-text-color text-xl"
                                           href="/ow">守望先锋</a>
                                    </div>
                                
                                    <div class="drawer-navbar-item text-base flex flex-col justify-center items-start hover:underline active:underline hover:underline-offset-1 rounded-3xl">
                                        <a class=" text-third-text-color text-xl"
                                           href="/cod">使命召唤</a>
                                    </div>
                                
                            </div>
                        
                    </li>
            
                
                    

                    <li class="drawer-navbar-item-sub text-base my-1.5 flex flex-col w-full">
                        
                        <div class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary cursor-pointer text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                             navbar-data-toggle="submenu-About"
                        >
                            <span>
                                关于
                            </span>
                            
                                <i class="fa-solid fa-chevron-right fa-sm fa-fw transition-all"></i>
                            
                        </div>
                        

                        
                            <div class="flex-col items-start px-2 py-2 hidden" data-target="submenu-About">
                                
                                    <div class="drawer-navbar-item text-base flex flex-col justify-center items-start hover:underline active:underline hover:underline-offset-1 rounded-3xl">
                                        <a class=" text-third-text-color text-xl"
                                           href="/about">ME</a>
                                    </div>
                                
                                    <div class="drawer-navbar-item text-base flex flex-col justify-center items-start hover:underline active:underline hover:underline-offset-1 rounded-3xl">
                                        <a class=" text-third-text-color text-xl"
                                           target="_blank" rel="noopener" href="https://github.com/CosmicTrace">GITHUB</a>
                                    </div>
                                
                            </div>
                        
                    </li>
            

            
            
        </ul>

        <div class="statistics flex justify-around my-2.5">
    <a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/tags">
        <div class="number text-2xl sm:text-xl text-second-text-color font-semibold">96</div>
        <div class="label text-third-text-color text-sm">标签</div>
    </a>
    <a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/categories">
        <div class="number text-2xl sm:text-xl text-second-text-color font-semibold">7</div>
        <div class="label text-third-text-color text-sm">分类</div>
    </a>
    <a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/archives">
        <div class="number text-2xl sm:text-xl text-second-text-color font-semibold">41</div>
        <div class="label text-third-text-color text-sm">文章</div>
    </a>
</div>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="main-content-body">

            

            <div class="main-content">

                
                    <div class="post-page-container flex relative justify-between box-border w-full h-full">
    <div class="article-content-container">

        <div class="article-title relative w-full">
            
                
                
                <img src="https://imagedelivery.net/sodhLvOXTBoeXxRe03g_RA/3b6677de-70dd-4887-25dd-e4d29181ed00/public" alt="TagUI教程" class="w-full h-60 sm:h-72 md:h-80 object-cover sm:rounded-t-large dark:brightness-75"/>
                
                <div class="w-full flex items-center absolute bottom-0 justify-start">
                    <h1 class="article-title-cover text-center mx-6 my-6 text-second-text-color bg-background-color-transparent px-4 py-3 text-3xl sm:text-4xl md:text-5xl font-bold backdrop-blur-lg rounded-xl border border-border-color ">TagUI教程</h1>
                </div>
            
            </div>

        
            <div class="article-header flex flex-row gap-2 items-center px-2 sm:px-6 md:px-8">
                <div class="avatar w-[46px] h-[46px] flex-shrink-0 rounded-medium border border-border-color p-[1px]">
                    <img src="https://imagedelivery.net/sodhLvOXTBoeXxRe03g_RA/26329e9f-d1fb-4280-a0a5-754547bf8500/public">
                </div>
                <div class="info flex flex-col justify-between">
                    <div class="author flex items-center">
                        <span class="name text-default-text-color text-lg font-semibold">Yiuhang Chan</span>
                        
                    </div>
                    <div class="meta-info">
                        <div class="article-meta-info">
    <span class="article-date article-meta-item">
        <i class="fa-regular fa-pen-fancy"></i>&nbsp;
        <span class="desktop">2024-04-18 11:39:15</span>
        <span class="mobile">2024-04-18 11:39:15</span>
        <span class="hover-info">创建</span>
    </span>
    
        <span class="article-date article-meta-item">
            <i class="fa-regular fa-wrench"></i>&nbsp;
            <span class="desktop">2024-04-19 10:52:06</span>
            <span class="mobile">2024-04-19 10:52:06</span>
            <span class="hover-info">更新</span>
        </span>
    

    
        <span class="article-categories article-meta-item">
            <i class="fa-regular fa-folders"></i>&nbsp;
            <ul>
                
                
                    
                        
                        <li>
                            <a href="/categories/RPA/">RPA</a>&nbsp;
                        </li>
                    
                    
                
            </ul>
        </span>
    
    
        <span class="article-tags article-meta-item">
            <i class="fa-regular fa-tags"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/tags/%E5%9F%BA%E7%A1%80/">基础</a>&nbsp;
                    </li>
                
                    <li>
                        | <a href="/tags/%E7%90%86%E8%AE%BA/">理论</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    

    
    
        <span class="article-wordcount article-meta-item">
            <i class="fa-regular fa-typewriter"></i>&nbsp;<span>11.6k 字</span>
        </span>
    
    
        <span class="article-min2read article-meta-item">
            <i class="fa-regular fa-clock"></i>&nbsp;<span>49 分钟</span>
        </span>
    
    
        <span class="article-pv article-meta-item">
            <i class="fa-regular fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span>
        </span>
    
</div>

                    </div>
                </div>
            </div>
        

        


        <div class="article-content markdown-body px-2 sm:px-6 md:px-8 pb-8">
            <h2 id="资源网址"><a href="#资源网址" class="headerlink" title="资源网址"></a>资源网址</h2><p>GitHub开源地址：<a class="link"   target="_blank" rel="noopener" href="https://github.com/aisingapore/TagUI" >https://github.com/aisingapore/TagUI <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p>中文技术文档：<a class="link"   target="_blank" rel="noopener" href="http://www.tagui.com.cn/setup.html" >http://www.tagui.com.cn/setup.html <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p>原技术文档：<a class="link"   target="_blank" rel="noopener" href="https://tagui.readthedocs.io/en/latest/index.html" >https://tagui.readthedocs.io/en/latest/index.html <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<h2 id="环境安装"><a href="#环境安装" class="headerlink" title="环境安装"></a>环境安装</h2><h3 id="Windows"><a href="#Windows" class="headerlink" title="Windows"></a>Windows</h3><h4 id="资源下载"><a href="#资源下载" class="headerlink" title="资源下载"></a>资源下载</h4><p>各类TagUI安装&#x2F;插件&#x2F;资源 国内下载，请访问：</p>
<p>链接：<a class="link"   target="_blank" rel="noopener" href="https://pan.baidu.com/s/1GrkOxmu9fTBpwzO1JzaNUw?pwd=tagu" >https://pan.baidu.com/s/1GrkOxmu9fTBpwzO1JzaNUw?pwd=tagu <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a> </p>
<p>各类TagUI安装&#x2F;插件&#x2F;资源 原下载，请访问：</p>
<p>TagUI v6.110 zip 文件: <a class="link"   target="_blank" rel="noopener" href="https://github.com/kelaberetiv/TagUI/releases/download/v6.110.0/TagUI_Windows.zip" >https://github.com/kelaberetiv/TagUI/releases/download/v6.110.0/TagUI_Windows.zip <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<ul>
<li>[MS Word 插件安装程序](<a class="link"   target="_blank" rel="noopener" href="https://storage.googleapis.com/tagui-dependencies/TagUI" >https://storage.googleapis.com/tagui-dependencies/TagUI <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a> WordAddIn&#x2F;TagUIWordAddInSetupV3.18.zip)（一个使 RPA 变得非常简单的全功能应用程序）</li>
<li><a class="link"   target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=mtiuzU6e4XE" >RPA 学习者提供的 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>有关安装和运行第一个 MS Word RPA 机器人的视频。</li>
<li><a class="link"   target="_blank" rel="noopener" href="https://github.com/kelaberetiv/TagUI/releases/download/v6.64.0/TagUIExcelAddInSetupv3.06.zip" >MS Excel 插件安装程序 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a> (Excel 中定义 RPA 数据参数并从 Excel 运行 TagUI)</li>
<li><a class="link"   target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=YsA9hpveROs" >RPA 学习者提供的 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>有关使用 Excel 插件安装和创建可视化的视频。</li>
</ul>
<h4 id="简易自动安装方式-不建议"><a href="#简易自动安装方式-不建议" class="headerlink" title="简易自动安装方式 (不建议)"></a>简易自动安装方式 (不建议)</h4><p><a class="link"   target="_blank" rel="noopener" href="https://github.com/kelaberetiv/TagUI/releases/download/v6.46.0/TagUI_Windows.exe" >TagUI v6.46 Windows 安装包 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>，下载安装即可。</p>
<h4 id="手动配置安装方式"><a href="#手动配置安装方式" class="headerlink" title="手动配置安装方式"></a>手动配置安装方式</h4><ol>
<li>下载 TugUI zip 压缩包，下载点击： <a class="link"   target="_blank" rel="noopener" href="https://github.com/kelaberetiv/TagUI/archive/master.zip" >TagUI v6.109 for Windows <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></li>
<li>解压到硬盘，例如： <code>D:\</code>，不建议解压在文件夹内</li>
<li>安装 OpenJDK for Windows（已经安装可跳过）</li>
<li>安装 Python （已经安装可跳过）</li>
<li>安装 Chrome 浏览器（已经安装可跳过）</li>
<li>安装 Microsoft Visual C++ Redistributable 2012 X86 版本（已经安装可跳过）</li>
<li>环境变量Path增加TagUI路径，注意需要<code>scr</code>目录，不是根目录，例如： <code>D:\tagui\src</code></li>
<li>按 <strong>Win + R</strong>，输入<code>cmd</code>，进入CMD命令行模式。</li>
<li>复制下面这行命令，粘贴到CMD运行展示样例：（路径改为安装的实际路径）</li>
</ol>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tagui D:\tagui\flows\samples\8_chineseflow.tag</span><br></pre></td></tr></table></figure></div>



<h4 id="系统编码设置"><a href="#系统编码设置" class="headerlink" title="系统编码设置"></a>系统编码设置</h4><p>中文Windows系统的CMD默认编码是GBK，流程执行中的中文会显示乱码，改成UTF-8编码:</p>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://imagedelivery.net/sodhLvOXTBoeXxRe03g_RA/d374c9e6-4a53-4e5d-d6ae-406ac41dee00/public"
                      width = "600"
                >

<ol>
<li>首先，<strong>管理员身份</strong>打开命令提示符窗口。在窗口顶部右击选择属性，选中选项后会看到默认编码为GBK。（OEM一样乱码）</li>
</ol>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://imagedelivery.net/sodhLvOXTBoeXxRe03g_RA/00378a81-5b77-4315-c312-b074a32f4b00/public"
                      width = "600"
                >

<ol start="2">
<li><strong>Win + R</strong> 打开运行窗口后输入<code>regedit</code>，点击确定按钮，打开注册表窗口，按照图中的路径打开<code>command processor</code>项</li>
</ol>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://imagedelivery.net/sodhLvOXTBoeXxRe03g_RA/fd2c1247-9365-4d4c-734a-ada5ca4b6700/public"
                      width = "600"
                >

<ol start="3">
<li>右键新建字符串值，设置完名称后右击打开窗口后输入数值数据<code>chcp 65001</code>，点击确定保存，即可完成设置了</li>
</ol>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://imagedelivery.net/sodhLvOXTBoeXxRe03g_RA/4109df34-da60-49eb-1acc-db8dde905d00/public"
                      width = "600"
                >

<h2 id="基础功能"><a href="#基础功能" class="headerlink" title="基础功能"></a>基础功能</h2><h3 id="执行流程"><a href="#执行流程" class="headerlink" title="执行流程"></a>执行流程</h3><p>TagUI通过运行 <strong>流程文件</strong> <code>flows</code> 自动执行操作，流程文件扩展名是 <code>.tag</code>。</p>
<p>可以在CMD命令提示符&#x2F;终端中运行流程： <strong>命令使用</strong>格式：</p>
<p>当前目录：</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tagui my_flow.tag</span><br></pre></td></tr></table></figure></div>



<p>绝对路径：</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tagui c:\tagui\samples\1_google.tag</span><br></pre></td></tr></table></figure></div>

<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://imagedelivery.net/sodhLvOXTBoeXxRe03g_RA/a53676d2-d7bb-4132-77a7-2562e9f35000/public"
                      width = "600"
                >

<p>也可以设定按固定计划运行流程，按固定计划自动运行流程通常很有用：每月、每周、每天甚至每 5 分钟一次。例如在 Windows 上，使用任务计划程序：</p>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://imagedelivery.net/sodhLvOXTBoeXxRe03g_RA/58ca9007-0872-4669-e310-d3316c655500/public"
                      width = "600"
                >

<h3 id="快捷执行"><a href="#快捷执行" class="headerlink" title="快捷执行"></a>快捷执行</h3><p>可以使用以下命令创建快捷方式文件 <code>-deploy</code>：</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tagui my_flow.tag -deploy</span><br></pre></td></tr></table></figure></div>

<p>或者使缩写方式 <code>-d</code>：</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tagui my_flow.tag -d</span><br></pre></td></tr></table></figure></div>

<p>这将创建一个快捷方式 (my_flow.cmd)，只需双击快捷方式即可运行流程。该快捷方式与流程位于同一文件夹中，但可以将其移动到桌面或其他任何位置。</p>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://imagedelivery.net/sodhLvOXTBoeXxRe03g_RA/ff6d3171-0012-49e1-d65c-9d42b775e300/public"
                      width = "600"
                >

<p>如果想增加更多参数，例如 <code>-headless</code> (<code>-h</code>)，可以这样写命令：</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tagui my_flow.tag -h -d</span><br></pre></td></tr></table></figure></div>


  <div class="note-large orange">
    <div class="notel-title rounded-t-lg p-3 font-bold text-lg flex flex-row gap-2 items-center">
      <i class="notel-icon fa-solid fa-circle-exclamation"></i><p>注意</p>

    </div>
    <div class="notel-content">
      <p>原.tag文件路径被移动，相关的.cmd快捷文件会失效。</p>

    </div>
  </div>

<h3 id="运行云端-tag"><a href="#运行云端-tag" class="headerlink" title="运行云端.tag"></a>运行云端.tag</h3><p>可以把<code>.tag</code>文件放在服务器，并用下面命令运行：</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tagui https://raw.githubusercontent.com/kelaberetiv/TagUI/master/flows/samples/1_google.tag</span><br></pre></td></tr></table></figure></div>

<h3 id="隐藏浏览器运行"><a href="#隐藏浏览器运行" class="headerlink" title="隐藏浏览器运行"></a>隐藏浏览器运行</h3><p>可以不显示Web浏览器来运行Web流程，使用 <code>-headless</code> 参数</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tagui my_flow.tag -headless</span><br></pre></td></tr></table></figure></div>

<p>或使用快捷方式<code>-h</code>：</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tagui my_flow.tag -h</span><br></pre></td></tr></table></figure></div>

<p>这允许在流程运行时正常使用电脑，但如果流程中使用可视自动化（例如OCR、图像识别等），则无法正常运行，因为流程需要读取并单击屏幕上的内容</p>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://imagedelivery.net/sodhLvOXTBoeXxRe03g_RA/7333175d-893d-4eeb-a593-93f4cea6d600/public"
                      width = "600"
                >

<h2 id="基础命令"><a href="#基础命令" class="headerlink" title="基础命令"></a>基础命令</h2><p>自动化RPA流程是由基础命令组成的，以下是一些常见命令。</p>
<h3 id="click-鼠标左键单击"><a href="#click-鼠标左键单击" class="headerlink" title="click 鼠标左键单击"></a>click 鼠标左键单击</h3><p>点击命令，可以使用它来单击Web元素：</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">click Getting started</span><br></pre></td></tr></table></figure></div>

<p>此命令单击WEB元素，点击定位可以用“ID”，“name”，“class”或“title”属性，这里有个使用 <a href="https://www.yiuhangblog.com/2021/02/23/20210223%E9%A1%B5%E9%9D%A2%E8%A7%A3%E6%9E%90%E5%B7%A5%E5%85%B7/">XPath</a>的例子：</p>
<p>XPath是一种强大的定位元素方式，例如：</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">click //a[@class=<span class="string">&quot;icon icon-home&quot;</span>]</span><br></pre></td></tr></table></figure></div>

<p>还可以单击屏幕上的某个坐标点：</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">click (500,300)</span><br></pre></td></tr></table></figure></div>

<p>命令里的500和300是X-Y坐标。此命令点击距离屏幕左侧为500像素，距离屏幕顶部300像素的位置。可以在TagUI Live模式下使用 <code>mouse_xy()</code> 辅助函数寻找XY坐标点，当然更推荐使用一些小工具更方便的知道XY坐标。</p>
<p><code>click</code>还可以使用图像识别(Visual Automation)单击先前保存的图像所匹配的位置。下面这条命令会在屏幕范围寻找类似 button.png 的位置，然后单击它。注意：TagUI只识别桌面区域，浏览器区域不一定识别。</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">click button.png</span><br></pre></td></tr></table></figure></div>

<p>当然，好的编程习惯，是把图片都放在 <code>image</code> 目录下：</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">click image/button.png</span><br></pre></td></tr></table></figure></div>

<h3 id="WEB访问"><a href="#WEB访问" class="headerlink" title="WEB访问"></a>WEB访问</h3><p>直接输入网址，TagUI就会在Chrome里打开：</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://somewebsite.com</span><br></pre></td></tr></table></figure></div>

<h3 id="type-文本输入"><a href="#type-文本输入" class="headerlink" title="type 文本输入"></a>type 文本输入</h3><p>可以在网络输入中输入内容。此命令以与<strong>单击</strong>步骤相同的方式查找元素<code>some-input</code>（元素定位），并在其中键入<code>some-text</code>（文本内容）：</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">type</span> some-input as some-text</span><br></pre></td></tr></table></figure></div>

<p>可以用 <code>[clear]</code> 来清除元素文本，用 <code>[enter]</code> 来按回车：</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">type</span> some-input as [clear]some-text[enter]</span><br></pre></td></tr></table></figure></div>

<p>也可以用图片进行输入定位, 类似 <code>click</code> 一样：</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">type</span> some-input.png as some-text</span><br></pre></td></tr></table></figure></div>

<h3 id="read-读取元素，可读取文本-或某些属性值"><a href="#read-读取元素，可读取文本-或某些属性值" class="headerlink" title="read 读取元素，可读取文本 或某些属性值"></a>read 读取元素，可读取文本 或某些属性值</h3><p>用 <strong>read</strong> 命令读取元素的文本，并且赋值给变量。</p>
<p>下面命令里的 <code>some-element </code>是元素， <code>some-variable</code> 是变量：</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">read some-element to some-variable</span><br></pre></td></tr></table></figure></div>

<p><strong>read</strong> 还可以使用Visual Automation和OCR功能从屏幕区域读取文本。依赖于OCR的读取可能不完全准确。</p>
<p>此命令读取在点（300,400）和（500,550）之间形成的矩形中的所有文本：</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">read (300,400)-(500,550) to some-variable</span><br></pre></td></tr></table></figure></div>

<p>还可以使用XPath读取Web元素的某些属性值。此命令从元素中读取ID属性：</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">read //some-element/@some-attribute to some-variable</span><br></pre></td></tr></table></figure></div>

<h3 id="assign-赋值"><a href="#assign-赋值" class="headerlink" title="assign 赋值"></a>assign 赋值</h3><p>对变量进行赋值：</p>
<p>此示例使用<code>count()</code> 辅助函数，计算在 id&#x2F;name&#x2F;text 中找到的包含“row”的元素数量，并将其分配给一个变量<code>row_count</code>以供以后使用：</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">row_count = count(<span class="string">&#x27;row&#x27;</span>)</span><br></pre></td></tr></table></figure></div>

<h2 id="元素定位"><a href="#元素定位" class="headerlink" title="元素定位"></a>元素定位</h2><p>DOM 和 XPath 标识符仅适用于 Chrome&#x2F;Edge。要自动化其他浏览器，请使用点&#x2F;区域和图像标识符。</p>
<h3 id="DOM-元素属性定位"><a href="#DOM-元素属性定位" class="headerlink" title="DOM 元素属性定位"></a>DOM 元素属性定位</h3><div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">click Getting started</span><br></pre></td></tr></table></figure></div>

<p>DOM (Document Object Model) 方式用元素属性进行定位匹配，可以用 id, name, class attributes 或元素本身的文本内容定位元素。注意：这种方式可能因为同名造成定位不准确。</p>
<h3 id="XPath-页面路径定位"><a href="#XPath-页面路径定位" class="headerlink" title="XPath 页面路径定位"></a>XPath 页面路径定位</h3><div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">click //body/div[1]/nav/div/div[1]/a</span><br></pre></td></tr></table></figure></div>

<p><a class="link"   target="_blank" rel="noopener" href="http://www.tagui.com.cn/faq.html#find-xpath" >XPath <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>（XML Path Language）用树状结构来定位元素，表达方式可以理解成“某小区66号楼601室书房里桌子左边的第一个抽屉”。</p>
<p>这是针对 Web 元素的最准确的定位方式，推荐使用 XPath 进行元素定位描述。</p>

  <div class="note-large blue">
    <div class="notel-title rounded-t-lg p-3 font-bold text-lg flex flex-row gap-2 items-center">
      <i class="notel-icon fa-solid fa-circle-info"></i><p>信息</p>

    </div>
    <div class="notel-content">
      <p>可以使用 CSS selectors 代替XPath，但XPath是首选。</p>

    </div>
  </div>

<h3 id="Point-坐标点定位"><a href="#Point-坐标点定位" class="headerlink" title="Point 坐标点定位"></a>Point 坐标点定位</h3><div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">click (200,500)</span><br></pre></td></tr></table></figure></div>

<p>坐标原点是在屏幕左上角，横向称为X坐标，竖向称为Y坐标，Y坐标100表示从上往下100个像素的位置。本条命令会到距离屏幕左侧200像素，距离屏幕顶部500像素的位置 进行点击。</p>
<h3 id="Region-屏幕区域定位"><a href="#Region-屏幕区域定位" class="headerlink" title="Region 屏幕区域定位"></a>Region 屏幕区域定位</h3><div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">read</span> (300,400)-(500,550) to some-variable</span><br></pre></td></tr></table></figure></div>

<p>这与两点（300,400）和（500,550）之间形成的矩形匹配坐标点。</p>
<h3 id="Image-图像定位"><a href="#Image-图像定位" class="headerlink" title="Image 图像定位"></a>Image 图像定位</h3><div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">click button.png</span><br></pre></td></tr></table></figure></div>

<p>在全屏范围寻找类似图像文件 <code>button.png</code> 的位置进行点击。首先需要截图保存为 &#96;button.png。</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">click image/button.png</span><br></pre></td></tr></table></figure></div>

<p>可以使用图片的绝对路径，同时好的编程习惯，是把图片都放到 <code>image</code> 目录下。并且使用容易理解的文件名，例如：<code>button.png</code>。</p>
<h2 id="Live-mode-用于调试的Live模式"><a href="#Live-mode-用于调试的Live模式" class="headerlink" title="Live mode 用于调试的Live模式"></a>Live mode 用于调试的Live模式</h2><p>在流程开发中，经常需要测试下一步的操作代码，建议使用Live Mode。</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tagui live</span><br></pre></td></tr></table></figure></div>

<p>启动 Live 模式后，可以输入一行才执行一行，这样调试起来很方便。下面这张图展示了这个操作。进入 Live Mode 时，TagUI 会自动打开Chrome。</p>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://imagedelivery.net/sodhLvOXTBoeXxRe03g_RA/070ba1ce-0e84-4c34-e1e2-4d03c36dbd00/public"
                      width = "600"
                >

<h2 id="If-条件语句"><a href="#If-条件语句" class="headerlink" title="If 条件语句"></a>If 条件语句</h2><p>if 就是“如果”怎样就怎样 的条件逻辑语言，例如：如果出现“登录按钮”就进行点击。</p>
<p>代码举例： 如果 URL网址包含 “success”, 就点击 buttons1 和 buttons2</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> url() contains <span class="string">&quot;success&quot;</span></span><br><span class="line">  click button1.png</span><br><span class="line">  click button2.png</span><br></pre></td></tr></table></figure></div>

<p><code>url()</code> 是一个辅助函数，用于获取当前网页的网址URL。注意，需要 <code>if</code> 执行的命令，需要在前面缩进空格（或Tab），这表示它们在<code>if</code>块 中。如果满足条件，就执行<code>if</code>块 中的命令。</p>
<p>另一个常见的情况是判断某元素是否存在。在这里，“如果在等待超时后未出现某些元素，则访问此网页”。</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> !exist(<span class="string">&#x27;some-element&#x27;</span>)</span><br><span class="line">  https://tagui.readthedocs.io/</span><br></pre></td></tr></table></figure></div>

<p>这 <code>!</code>否定条件来自 JavaScript，TagUI 代码最终会翻译成 JavaScript。</p>
<p>在下面的示例中，检查变量row_count，是否等于5：</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> row_count equals to 5</span><br><span class="line">  some steps</span><br></pre></td></tr></table></figure></div>

<p>以下是 大于more than 和 小于 less than 的命令方式：</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> row_count more than 5</span><br><span class="line">  some steps</span><br><span class="line"><span class="keyword">if</span> row_count less than 5</span><br><span class="line">  some steps</span><br></pre></td></tr></table></figure></div>

<h2 id="For-循环"><a href="#For-循环" class="headerlink" title="For 循环"></a>For 循环</h2><p>可以在同一流程中使用循环执行多次同样的流程。为了使用不同变量多次运行一个流程，标准方式是使用 DataTables (高级命令).</p>
<p>在此示例中，我们重复块内的流程总共20次：</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> n from 1 to 20</span><br><span class="line">  some step to take</span><br><span class="line">  some other step</span><br><span class="line">  some more step</span><br></pre></td></tr></table></figure></div>

<h2 id="functions-函数"><a href="#functions-函数" class="headerlink" title="functions 函数"></a>functions 函数</h2><p>函数功能是调用 JavaScript 函数，并且返回需要的值。</p>
<p>每个函数后跟小括号 <code>()</code>，小括号内可以填写函数的参数。</p>
<h3 id="csv-row"><a href="#csv-row" class="headerlink" title="csv_row()"></a>csv_row()</h3><p>将一些变量转换为CSV文本以写入CSV文件。它将变量作为参数输入，包含在方括号内 <code>[]</code> (实际上是一个数组 array).</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">read</span> name_element to name</span><br><span class="line"><span class="built_in">read</span> price_element to price</span><br><span class="line"><span class="built_in">read</span> details_element to details</span><br><span class="line">write `csv_row([name, price, details])` to product_list.csv</span><br></pre></td></tr></table></figure></div>

<h3 id="clipboard-剪贴板"><a href="#clipboard-剪贴板" class="headerlink" title="clipboard() 剪贴板"></a>clipboard() 剪贴板</h3><p>从剪贴板读取文本：</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">dclick pdf_document.png</span><br><span class="line"><span class="built_in">wait</span> 3 seconds</span><br><span class="line">keyboard [ctrl]a</span><br><span class="line">keyboard [ctrl]c</span><br><span class="line">text_contents = clipboard()</span><br></pre></td></tr></table></figure></div>

<p>对于大量文本内容输入，建议将文本先放到剪贴板，在用 Ctrl+V 粘贴，这比用 <strong>type</strong> 快很多：</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">long_text = <span class="string">&quot;This is a very long text which takes a long time to type&quot;</span></span><br><span class="line">clipboard(long_text)</span><br><span class="line">click text_input</span><br><span class="line">keyboard [ctrl]v</span><br><span class="line">keyboard [enter]</span><br></pre></td></tr></table></figure></div>

<h3 id="mouse-x-mouse-y-获得坐标点当前位置"><a href="#mouse-x-mouse-y-获得坐标点当前位置" class="headerlink" title="mouse_x(), mouse_y() 获得坐标点当前位置"></a>mouse_x(), mouse_y() 获得坐标点当前位置</h3><p>获取鼠标的x或y坐标。</p>
<p>在偏移点击目标时，需要先获得 x 或 y 坐标，以下代码示例表示，鼠标先移动到 <code>element.png</code> ，再获得偏移的 x 和 y ，然后单击元素右侧的200像素：</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">hover element.png</span><br><span class="line">x = mouse_x() + 200</span><br><span class="line">y = mouse_y()</span><br><span class="line">click (`x`,`y`)</span><br></pre></td></tr></table></figure></div>

<h3 id="mouse-xy"><a href="#mouse-xy" class="headerlink" title="mouse_xy()"></a>mouse_xy()</h3><p>在Live模式下，可以使用 <strong>echo `mouse_xy()&#96;</strong>  找到鼠标的坐标。</p>
<p>注意，这里用的不是单引号</p>
<p><strong>‘</strong></p>
<p>而是键盘数字1左边按键的 </p>
<p><strong>&#96;</strong></p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> `mouse_xy()`</span><br></pre></td></tr></table></figure></div>

<h2 id="高级命令"><a href="#高级命令" class="headerlink" title="高级命令"></a>高级命令</h2><h3 id="保存流程运行结果"><a href="#保存流程运行结果" class="headerlink" title="保存流程运行结果"></a>保存流程运行结果</h3><p><code>tagui/src/tagui_report.csv</code> 可以使用<code>-report</code>选项（快捷方式）保存运行的 html 日志和流程运行结果<code>-r</code>。</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tagui my_flow.tag -report</span><br></pre></td></tr></table></figure></div>

<p>CSV 文件将显示每次运行的一行、开始时间、完成时间、运行期间的任何错误消息、该运行日志文件的链接以及用户的工作组\用户 ID。</p>
<h3 id="处理异常和错误"><a href="#处理异常和错误" class="headerlink" title="处理异常和错误"></a>处理异常和错误</h3><p>当流程没按预期进行时，有3种方法可以在Tagui中处理。</p>
<p>第一种方式是针对<strong>单条指令错误处理</strong>，可以增加 if 判断来预防。例如，检查是否缺少某些UI元素，然后执行XYZ步骤。使用这种方式。</p>
<p>第二种方式是对针对<strong>某个流程的错误处理</strong>。类似下面的语法，当 Flow.tag 成功运行时才运行。当它检测到丢失（缺少截图文件）或其他一些未知错误时，Tagui将自动抛出错误。</p>
<p>Windows 代码例子：</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">call tagui flow.tag || tagui error.tag</span><br><span class="line">call tagui flow.tag &amp;&amp; tagui success.tag</span><br></pre></td></tr></table></figure></div>

<p>第三种方式是<strong>全局错误处理</strong>。可以对 TagUI 进行配置，以便在每次运行后，进行特殊处理，将报告选项生成的数据或文件发送到某个目标文件夹或 API 端点，以进行错误&#x2F;成功处理。例如，将所有自动化运行同步到中央存储以进行审计。特殊处理适用于所有运行的 TagUI 流。</p>
<h3 id="DataTables数据表格批量自动化"><a href="#DataTables数据表格批量自动化" class="headerlink" title="DataTables数据表格批量自动化"></a>DataTables数据表格批量自动化</h3><p>DataTables是 csv 文件，可以把数据表格作为变化，多次循环运行流程。</p>
<p>Datatable数据文件 (<code>trade_data.csv</code>) 类似下面格式:</p>
<table>
<thead>
<tr>
<th>#</th>
<th>trade</th>
<th>username</th>
<th>password</th>
<th>pair</th>
<th>size</th>
<th>direction</th>
</tr>
</thead>
<tbody><tr>
<td>1</td>
<td>Trade USDSGD</td>
<td>test_account</td>
<td>12345678</td>
<td>USDSGD</td>
<td>10000</td>
<td>BUY</td>
</tr>
<tr>
<td>2</td>
<td>Trade USDSGD</td>
<td>test_account</td>
<td>12345678</td>
<td>USDJPY</td>
<td>1000</td>
<td>SELL</td>
</tr>
<tr>
<td>3</td>
<td>Trade EURUSD</td>
<td>test_account</td>
<td>12345678</td>
<td>EURUSD</td>
<td>100000</td>
<td>BUY</td>
</tr>
</tbody></table>
<p>要使用它，可以使用 运行流程。 TagUI 将为数据表中的每一行运行一次（标题除外）。<code>tagui my_flow.tag trade_data.csv``my_flow.tag</code></p>
<p>在流程中，TagUI 可以使用变量<code>trade</code>、<code>username</code>、<code>password</code>等，就好像它们位于本地对象存储库中一样，并且值将来自该运行的行。</p>
<p>要知道的流程处于哪个迭代中，可以使用该<code>iteration</code>变量：</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> current iteration: `iteration`</span><br><span class="line"><span class="keyword">if</span> iteration equals to 1</span><br><span class="line">  // go to login URL and <span class="keyword">do</span> the login steps</span><br><span class="line">  www.xero.com</span><br><span class="line"></span><br><span class="line">// <span class="keyword">do</span> rest of the steps <span class="keyword">for</span> every iteration</span><br></pre></td></tr></table></figure></div>

<h3 id="可重用性的对象存储库"><a href="#可重用性的对象存储库" class="headerlink" title="可重用性的对象存储库"></a>可重用性的对象存储库</h3><p>对象存储库是可选的csv 文件，可以存储在流中使用的变量。它们有助于将流与个人数据（例如 Web 流的登录信息）分开，并允许在多个流之间共享通用信息以便于更新。</p>
<p>每个流都有一个<strong>本地对象存储库</strong>，所有流共享<strong>全局对象存储库</strong>。本地对象存储库<code>tagui_local.csv</code>与流位于同一文件夹中。全局对象存储库位于<code>tagui_global.csv</code>该<code>tagui/src/</code>文件夹中。</p>
<p>对象存储库可能如下所示：</p>
<table>
<thead>
<tr>
<th>object</th>
<th>definition</th>
</tr>
</thead>
<tbody><tr>
<td>email</td>
<td>user-email-textbox</td>
</tr>
<tr>
<td>create account</td>
<td>btn btn–green btn-xl signup-btn</td>
</tr>
</tbody></table>
<p>在流程中，TagUI 可以使用对象<code>email</code>,作为变量，并且在运行之前它们将直接被定义替换。局部定义优先于全局定义。<code>create account</code></p>
<p>如果<code>user-email-textbox</code>是某些 Web 文本输入的标识符，那么可以在流程中使用以下内容：</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">type</span> `email` as my_email@email.com</span><br></pre></td></tr></table></figure></div>

<h3 id="调用流程"><a href="#调用流程" class="headerlink" title="调用流程"></a>调用流程</h3><p>可以通过将大型工作流程文件分解为许多子流程文件来模块化 RPA 工作流程。对于更复杂的 RPA 场景，甚至可以让一个子流程运行其他子流程。</p>
<p>这样做的一些常见原因包括方便在其他流程中重用相同的子流程、通过在子流程中保留步骤顺序来执行更容易组织的特定操作，或者将 Python 或 JavaScript 代码和函数存储在单独的子流程中（使用例如 <code>py begin</code> 和 <code>py finish</code> 代码块）。</p>
<p>在一个流程内调用另一个流程，命令如下：</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tagui login_crm.tag</span><br></pre></td></tr></table></figure></div>

<p>被调用流程也可以存储在子文件夹中：</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// Windows example</span><br><span class="line">tagui CRM\login.tag</span><br><span class="line"></span><br><span class="line">// Mac/Linux example</span><br><span class="line">tagui CRM/login.tag</span><br></pre></td></tr></table></figure></div>

<p>变量可以在父流程和子流程之间使用：（可以理解成变量是全局的）</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">// username 和 password 变量可以被使用在 login.tag</span><br><span class="line">username = <span class="string">&#x27;jennifer&#x27;</span>; password = <span class="string">&#x27;12345678&#x27;</span>;</span><br><span class="line">tagui login.tag</span><br><span class="line"></span><br><span class="line">// 也可以把变量分行来写，这样更清晰</span><br><span class="line">username = <span class="string">&#x27;jennifer&#x27;</span></span><br><span class="line">password = <span class="string">&#x27;12345678&#x27;</span></span><br><span class="line">tagui login.tag</span><br><span class="line"></span><br><span class="line">// 在子流程 login.tag 里，也可以定义和返回变量，给父流程使用</span><br><span class="line"><span class="built_in">echo</span> `login_result`</span><br></pre></td></tr></table></figure></div>

<p>可以在父子流中赋值变量 <code>action = &#39;login&#39;</code>，配合 <code>if</code> 来控制具体执行哪个子流程：</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">// crm_steps.tag</span><br><span class="line"><span class="keyword">if</span> action equals to <span class="string">&#x27;login&#x27;</span></span><br><span class="line">  <span class="keyword">do</span> some steps</span><br><span class="line">  <span class="keyword">do</span> some more steps</span><br><span class="line"></span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> action equals to <span class="string">&#x27;report&#x27;</span></span><br><span class="line">  <span class="keyword">do</span> some steps</span><br><span class="line">  <span class="keyword">do</span> some more steps</span><br><span class="line"></span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> action equals to <span class="string">&#x27;logout&#x27;</span></span><br><span class="line">  <span class="keyword">do</span> some steps</span><br><span class="line">  <span class="keyword">do</span> some more steps</span><br><span class="line"></span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">  <span class="built_in">echo</span> ERROR - action undefined</span><br></pre></td></tr></table></figure></div>

<h3 id="Turbo-mode-极速模式，10倍速运行"><a href="#Turbo-mode-极速模式，10倍速运行" class="headerlink" title="Turbo mode 极速模式，10倍速运行"></a>Turbo mode 极速模式，10倍速运行</h3><p>运行流产时，可使用 turbo 参数开启极速模式（谨慎使用）：</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">tagui flow.tag -turbo</span><br><span class="line"></span><br><span class="line">or</span><br><span class="line"></span><br><span class="line">tagui flow.tag -t</span><br></pre></td></tr></table></figure></div>

<p>大多数网站和桌面应用程序都无法适应TagUI的极速模式。如果RPA以超出这些网站的速度运行，经常会报错。报错的点可能是字段和数据未正确填写，表单缺少数据等。</p>
<p>极速模式下问题可能会随机发生，包括在PC上工作，但由于CPU速度的差异而无法在另一台PC上工作。因此，不建议使用Turbo极速模式。实际应用中，如果用极速模式造成某些数据错误，可能最终需要花费更多时间来排除或修复错误造成的后果。</p>
<p>但是，极速模式对某些特定场景的某些用户非常有用。例如，从应用程序中获取数据，超越人类速度的Web端数据输入等。</p>
<h3 id="视觉自动化-OCR"><a href="#视觉自动化-OCR" class="headerlink" title="视觉自动化 OCR"></a>视觉自动化 OCR</h3><p>对于许多步骤，可以使用或来结束步骤，告诉 TagUI 使用 OCR（光学字符识别）与屏幕上的某些 UI 元素进行交互。请参阅下面的示例。可以执行此操作的步骤：单击、rclick、dclick、悬停、键入、选择、读取、捕捉、exist()、present()。<code>using ocr``using OCR</code></p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">click Submit using ocr</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> exist(<span class="string">&#x27;Special Offer using ocr&#x27;</span>)</span><br><span class="line">  click Add To Cart using OCR</span><br><span class="line"></span><br><span class="line">// various usage combinations <span class="keyword">for</span> <span class="keyword">select</span> step</span><br><span class="line"><span class="keyword">select</span> Dress Color using OCR as Dark Blue using OCR</span><br><span class="line"><span class="keyword">select</span> dress_color.png as Bright Pink using ocr</span><br><span class="line"><span class="keyword">select</span> Dress Color using OCR as dark_black.png</span><br><span class="line"><span class="keyword">select</span> dress_color.png as bright_white.png</span><br></pre></td></tr></table></figure></div>

<p>如果使用图像编辑器将文件中 UI 元素的背景设置为<code>.png</code>100% 透明，则 TagUI 将能够定位该元素，无论其背景如何。</p>
<p>相反，还可以删除某些锚元素（例如框架）附近的前景内容，以便可以使用<strong>读取</strong>步骤对空白区域中的不同内容进行 OCR。</p>
<h3 id="在流程中编写Python"><a href="#在流程中编写Python" class="headerlink" title="在流程中编写Python"></a>在流程中编写Python</h3><p>可以在 TagUI 流程中编写 Python 代码。Python 开发环境需要单独安装。</p>
<p>使用 <code>py</code> 命令告诉 TagUI 调用 <code>python</code> 运行python命令。可以将字符串值传递回 TagUI 然后在Python里 print()。 Python 运行结果将存放到 TagUI 变量 <code>py_result</code> 里。</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">py a=1</span><br><span class="line">py b=2</span><br><span class="line">py c=a+b</span><br><span class="line">py <span class="built_in">print</span>(c)</span><br><span class="line"><span class="built_in">echo</span> `py_result`</span><br></pre></td></tr></table></figure></div>

<p>也可以使用 <code>py begin</code> 和 <code>py finish</code> 来告诉 TagUI 这部分是 Python 语言：</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">py begin</span><br><span class="line">a=1</span><br><span class="line">b=2</span><br><span class="line">c=a+b</span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line">py finish</span><br><span class="line"><span class="built_in">echo</span> `py_result`</span><br></pre></td></tr></table></figure></div>

<p>可以这样将变量传递给Python：</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">phone = 1234567</span><br><span class="line">py_step(<span class="string">&#x27;phone = &#x27;</span> + phone)</span><br><span class="line">py <span class="built_in">print</span>(phone)</span><br><span class="line"><span class="built_in">echo</span> `py_result`</span><br><span class="line"></span><br><span class="line">name = <span class="string">&#x27;Donald&#x27;</span></span><br><span class="line">py_step(<span class="string">&#x27;name = &quot;&#x27;</span> + name + <span class="string">&#x27;&quot;&#x27;</span>)</span><br><span class="line">py <span class="built_in">print</span>(name)</span><br><span class="line"><span class="built_in">echo</span> `py_result`</span><br></pre></td></tr></table></figure></div>

<p>要传递并返回更复杂的数据，例如多个变量，可以使用 JavaScript 和 Python JSON 库来发送和接收 JSON 字符串。传递2个变量，执行一些处理，并返回2个变量：</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="number">1</span></span><br><span class="line">b = <span class="number">2</span></span><br><span class="line">c = &#123;<span class="string">&quot;a&quot;</span>:a, <span class="string">&quot;b&quot;</span>:b&#125;</span><br><span class="line">json_c = JSON.stringify(c)</span><br><span class="line">echo `json_c`</span><br><span class="line">py_step(<span class="string">&quot;json_c = &#x27;&quot;</span> + json_c + <span class="string">&quot;&#x27;&quot;</span>)</span><br><span class="line"></span><br><span class="line">py begin</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line">c = json.loads(json_c)</span><br><span class="line">d = c[<span class="string">&quot;a&quot;</span>] * <span class="number">10</span></span><br><span class="line">e = c[<span class="string">&quot;b&quot;</span>] * <span class="number">10</span></span><br><span class="line">f = &#123;<span class="string">&quot;d&quot;</span>:d, <span class="string">&quot;e&quot;</span>:e&#125;</span><br><span class="line">json_f = json.dumps(f)</span><br><span class="line"><span class="built_in">print</span>(json_f)</span><br><span class="line">py finish</span><br><span class="line"></span><br><span class="line">echo `py_result`</span><br><span class="line">f = JSON.parse(py_result)</span><br><span class="line">echo `f.d`</span><br><span class="line">echo `f.e`</span><br></pre></td></tr></table></figure></div>

<p>上面将 2 个变量从 TagUI 传递到 Python，进行修改，返回 2 个变量，并显示下面的 <code>e</code> 和 <code>f</code> ：</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">10</span><br><span class="line">20</span><br></pre></td></tr></table></figure></div>

<h3 id="创建运行Log日志便于调试"><a href="#创建运行Log日志便于调试" class="headerlink" title="创建运行Log日志便于调试"></a>创建运行Log日志便于调试</h3><p>要执行高级调试，可以通过在 <code>tagui/src/</code>中创建一个空的<code>tagui_logging</code>文件，在运行流程时记录运行日志。</p>
<ul>
<li><code>my_flow.log</code> 存储一步步的执行记录。</li>
<li><code>my_flow.js</code> 是已运行的生成的JavaScript文件。</li>
<li><code>my_flow.raw</code> is the expanded flow after parsing modules.</li>
</ul>
<h3 id="运行云端-TagUI"><a href="#运行云端-TagUI" class="headerlink" title="运行云端 TagUI"></a>运行云端 TagUI</h3><p>可以使用 <a class="link"   target="_blank" rel="noopener" href="https://github.com/kelaberetiv/TagUI/issues/913" >免费 Google 服务器 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>运行Web浏览器或手机上的 Tagui。可以在浏览器的不同选项卡上同时运行最多5个会话。</p>
<p>为了对在云上运行的更多控制，可以在首选的云供应商上运行此<a class="link"   target="_blank" rel="noopener" href="https://hub.docker.com/r/openiap/nodered-tagui" >Docker 映像 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>（使用边缘标签获取最新版本）或<a class="link"   target="_blank" rel="noopener" href="https://github.com/open-rpa/openflow/blob/master/OpenFlowNodeRED/Dockerfiletagui" >Docker 文件。 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>
<p>或者在 OpenFlow 上的<a class="link"   target="_blank" rel="noopener" href="https://app.openiap.io/" >免费 Node-RED 实例 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>上运行。 Docker 镜像、Docker 文件和 OpenFlow 云由<a class="link"   target="_blank" rel="noopener" href="https://www.linkedin.com/in/skadefro/" >Allan Zimmermann <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>维护和赞助。</p>
<h2 id="命令手册"><a href="#命令手册" class="headerlink" title="命令手册"></a>命令手册</h2><p>在这里查询各种命令、辅助功能和运行选项</p>
<h3 id="流程命令"><a href="#流程命令" class="headerlink" title="流程命令"></a>流程命令</h3><h4 id="鼠标和键盘命令"><a href="#鼠标和键盘命令" class="headerlink" title="鼠标和键盘命令"></a>鼠标和键盘命令</h4><h5 id="click-单击"><a href="#click-单击" class="headerlink" title="click 单击"></a>click 单击</h5><p>鼠标左键点击目标</p>
<p>可以使用 DOM, XPath Point, Image进行目标定位。</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">click [DOM/XPath/Point/Image]</span><br></pre></td></tr></table></figure></div>

<p><em>例子：</em></p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">click Main concepts</span><br><span class="line">click //nav/div/div[2]/ul/li[4]/ul/li[1]/a</span><br><span class="line">click (500,200)</span><br><span class="line">click button.png</span><br></pre></td></tr></table></figure></div>

<h5 id="rclick-右键单击"><a href="#rclick-右键单击" class="headerlink" title="rclick 右键单击"></a>rclick 右键单击</h5><p>鼠标右键单击目标</p>
<p>可以使用 DOM, XPath Point, Image进行目标定位。</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rclick [DOM/XPath/Point/Image]</span><br></pre></td></tr></table></figure></div>

<p>参考 click 例子。</p>
<h5 id="dclick-双击"><a href="#dclick-双击" class="headerlink" title="dclick 双击"></a>dclick 双击</h5><p>鼠标左键双击目标</p>
<p>可以使用 DOM, XPath Point, Image进行目标定位。</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dclick [DOM/XPath/Point/Image]</span><br></pre></td></tr></table></figure></div>

<h5 id="hover-鼠标移动"><a href="#hover-鼠标移动" class="headerlink" title="hover 鼠标移动"></a>hover 鼠标移动</h5><p>鼠标移动到目标位置</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hover [DOM/XPath/Point/Image]</span><br></pre></td></tr></table></figure></div>

<h5 id="type-输入"><a href="#type-输入" class="headerlink" title="type 输入"></a>type 输入</h5><p>Web输入命令，可以使用 [clear] 清除字段和 [enter] 来点击ENTER键。</p>
<p>可以使用 DOM, XPath Point, Image进行目标定位。</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">type</span> [DOM/XPath/Point/Image] as [text to <span class="built_in">type</span>]</span><br></pre></td></tr></table></figure></div>

<p><em>例子：</em></p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">type</span> search-term as John Wick</span><br><span class="line"><span class="built_in">type</span> //input[@name=<span class="string">&quot;search&quot;</span>] as John Wick</span><br><span class="line"><span class="built_in">type</span> (500,200) as John Wick</span><br><span class="line"><span class="built_in">type</span> input_field.png as John Wick</span><br><span class="line"></span><br><span class="line"><span class="built_in">type</span> search-term as [clear]John Wick[enter]</span><br><span class="line"><span class="built_in">type</span> //input[@name=<span class="string">&quot;search&quot;</span>] as [clear]John Wick[enter]</span><br><span class="line"><span class="built_in">type</span> (500,200) as [clear]John Wick[enter]</span><br><span class="line"><span class="built_in">type</span> input_field.png as [clear]John Wick[enter]</span><br></pre></td></tr></table></figure></div>

<h5 id="keyboard-按键-按组合键"><a href="#keyboard-按键-按组合键" class="headerlink" title="keyboard 按键&#x2F;按组合键"></a>keyboard 按键&#x2F;按组合键</h5><p>模拟键盘按键</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">keyboard [keys]</span><br></pre></td></tr></table></figure></div>

<p>可以使用以下这些功能按键：</p>
<ul>
<li>[shift] [ctrl] [alt] [win] [cmd] [enter]</li>
<li>[space] [tab] [esc] [backspace] [delete] [clear]</li>
<li>[up] [down] [left] [right] [pageup] [pagedown]</li>
<li>[home] [end] [insert] [f1] .. [f15]</li>
<li>[printscreen] [scrolllock] [pause] [capslock] [numlock]</li>
</ul>
<p><em>例子：</em></p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">keyboard [win]run[enter]</span><br><span class="line">keyboard [printscreen]</span><br><span class="line">keyboard [ctrl]c</span><br><span class="line">keyboard [tab][tab][tab][enter]</span><br><span class="line"></span><br><span class="line">keyboard [cmd][space]</span><br><span class="line">keyboard safari[enter]</span><br><span class="line">keyboard []c</span><br></pre></td></tr></table></figure></div>

<h5 id="mouse-鼠标"><a href="#mouse-鼠标" class="headerlink" title="mouse 鼠标"></a>mouse 鼠标</h5><p>在当前鼠标位置，按下鼠标左键&#x2F;弹起鼠标左键。</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mouse down</span><br><span class="line">mouse up</span><br></pre></td></tr></table></figure></div>

<h4 id="Web-网页端命令"><a href="#Web-网页端命令" class="headerlink" title="Web 网页端命令"></a>Web 网页端命令</h4><h5 id="visit-打开网站-url"><a href="#visit-打开网站-url" class="headerlink" title="visit 打开网站&#x2F;url"></a>visit 打开网站&#x2F;url</h5><p>直接输入网址url（带上 http），TagUI 就会在 Chrome 打开这个 URL。</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[URL]</span><br></pre></td></tr></table></figure></div>

<p><em>例子：</em></p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://google.com</span><br></pre></td></tr></table></figure></div>

<h5 id="select-下拉选择"><a href="#select-下拉选择" class="headerlink" title="select 下拉选择"></a>select 下拉选择</h5><p>修改下拉选择框，注意 as 后面是区分大小写的。</p>
<p>可以用 <a class="link"   target="_blank" rel="noopener" href="http://www.tagui.com.cn/main_concepts.html#dom" >DOM <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>, <a class="link"   target="_blank" rel="noopener" href="http://www.tagui.com.cn/main_concepts.html#xpath" >XPath <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a> 进行目标定位。</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> [DOM/XPath of <span class="keyword">select</span> input element] as [option value or text]</span><br></pre></td></tr></table></figure></div>

<p><em>例子：</em></p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select variant as blue</span><br></pre></td></tr></table></figure></div>

<h5 id="table-保存表格数据"><a href="#table-保存表格数据" class="headerlink" title="table 保存表格数据"></a>table 保存表格数据</h5><p>将Table表格数据保存到CSV文件，基于网页的Table编号或其<a class="link"   target="_blank" rel="noopener" href="http://www.tagui.com.cn/main_concepts.html#xpath" >XPath <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a> 进行目标定位。</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">table [table number] to [filename.csv]</span><br><span class="line">table [XPath] to [filename.csv]</span><br></pre></td></tr></table></figure></div>

<p><em>例子：</em></p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">table 1 to regional_exchange_rates.csv</span><br><span class="line">table (//table)[2] to global_exchange_rates.csv</span><br><span class="line">table //table[@name=<span class="string">&#x27;report&#x27;</span>] to report.csv</span><br></pre></td></tr></table></figure></div>

<h5 id="popup-把下一步操作放到新标签页"><a href="#popup-把下一步操作放到新标签页" class="headerlink" title="popup 把下一步操作放到新标签页"></a>popup 把下一步操作放到新标签页</h5><p>把下一步操作放到新标签页里进行。</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">popup [新标签页URL的特征部分]</span><br><span class="line">  [steps]</span><br></pre></td></tr></table></figure></div>

<p><em>例子：popup board 这里也可以使用 popup top.baidu.com&#x2F;board 效果是一样的。</em></p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">https://baidu.com</span><br><span class="line">click 百度热搜</span><br><span class="line">popup board</span><br><span class="line">  click 电影榜</span><br><span class="line">  // some other steps</span><br></pre></td></tr></table></figure></div>

<h5 id="frame-针对某些框架操作"><a href="#frame-针对某些框架操作" class="headerlink" title="frame 针对某些框架操作"></a>frame 针对某些框架操作</h5><p>指定下一步操作的目标框架范围。</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">frame [frame name]</span><br><span class="line">  [steps]</span><br><span class="line"></span><br><span class="line">frame [frame name] | [subframe name]</span><br><span class="line">  [steps]</span><br></pre></td></tr></table></figure></div>

<p><em>例子：</em></p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">frame navigation</span><br><span class="line">  click Products</span><br><span class="line"></span><br><span class="line">frame main | register</span><br><span class="line">  click Register</span><br></pre></td></tr></table></figure></div>

<h5 id="download-to"><a href="#download-to" class="headerlink" title="download to"></a>download to</h5><p>指定 Chrome 下载文件的存储位置。默认位置是当前TagUI流程的文件夹。Specifies a location to store file downloads. The default location is the folder of the TagUI flow.</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">download to [folder location]</span><br></pre></td></tr></table></figure></div>

<p>默认情况下 TagUI 启动后 Chrome 不询问下载存放路径，可以在.tag 文件里增加下面这句，让 Chrome 在下载是询问下载文件存放目录。</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">js chrome_step(<span class="string">&#x27;Page.setDownloadBehavior&#x27;</span>,&#123;behavior: <span class="string">&#x27;default&#x27;</span>, downloadPath: location&#125;)</span><br></pre></td></tr></table></figure></div>

<h5 id="upload"><a href="#upload" class="headerlink" title="upload"></a>upload</h5><p>上传文件到网站。</p>
<p>仅支持 DOM 目标定位方式。</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">upload [DOM of upload element] as [filename]</span><br></pre></td></tr></table></figure></div>

<p><em>例子：</em></p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">upload <span class="comment">#element_id as report.csv</span></span><br></pre></td></tr></table></figure></div>

<h5 id="api"><a href="#api" class="headerlink" title="api"></a>api</h5><p>调用Web API,并将返回内容保存到变量 <code>api_result</code>。</p>
<p>如果 API 返回的是JSON数据格式，将自动创建 <code>api_json</code>。</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">api https://some-api-url</span><br></pre></td></tr></table></figure></div>

<p><em>例子：</em></p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">api https://api.github.com/repos/kelaberetiv/TagUI/releases</span><br><span class="line"><span class="built_in">echo</span> `api_result`</span><br><span class="line">author = api_json[0].author.login</span><br></pre></td></tr></table></figure></div>

<h4 id="Excel"><a href="#Excel" class="headerlink" title="Excel"></a>Excel</h4><h5 id="读取中文配置"><a href="#读取中文配置" class="headerlink" title="读取中文配置"></a>读取中文配置</h5><p>控制面板 &gt; 语言 &gt; 管理语言设置 &gt; 更改系统区域设置 &gt; 使用utf-8 提供全球语言支持</p>
<p>对 Excel 执行读取，写入，复制，删除 等操作，比如 <code>[workbook]sheet!range</code> 范围。 本功能适用于 Windows 和 Mac 的 Excel 程序。对于部分需要密码的Excel处理，需要用到 <code>excel_password = &#39;password&#39;</code>：</p>
<h5 id="variables-变量"><a href="#variables-变量" class="headerlink" title="variables 变量"></a>variables 变量</h5><p>可以在Excel语法中使用变量，例如范围或表格 <code>range</code> or <code>sheet</code>。TagUI 支持各种版本的 Excel 文件，必须把文件的.扩展名 作为语法的一部分，以便 TagUI 可以识别指令是Excel命令而不是一些JavaScript 代码。</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[`workbook`.xlsx]`sheet`!`range` = 123</span><br><span class="line">data = [`workbook`.xlsx]`sheet`!`range`</span><br></pre></td></tr></table></figure></div>

<h5 id="visibility-是否让Excel操作可见"><a href="#visibility-是否让Excel操作可见" class="headerlink" title="visibility 是否让Excel操作可见"></a>visibility 是否让Excel操作可见</h5><p>默认情况下，Excel 操作将在后台打开并运行，看不到后台的 Excel 操作。如果希望在 Excel 显示状态下操作，可以在流程中使用 <code>excel_focus = true</code>。使用 <code>excel_focus = false</code> 在工作流程中再次将其设置为OFF。</p>
<p>对于某些使用场景，甚至可能不希望 Excel 应用程序在后台可见。在这种情况下，可以在工作流程中设置以不可见方式运行 Excel。用于使 Excel 在 RPA 工作流程中再次可见。<code>excel_visible = false``excel_visible = true</code></p>
<h5 id="读取Excel"><a href="#读取Excel" class="headerlink" title="读取Excel"></a>读取Excel</h5><p>从Excel文件读取数据，支持的相对路径和绝对文件路径。如果指定的文件或工作表不存在，则会显示错误。接着，可以指定单元格或某个范围。</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">variable = [workbook]sheet!range</span><br></pre></td></tr></table></figure></div>

<p>读取 列column 和 行row 可以使用标准Excel语法范围描述方式，例如： A:A (column A), B:D (columns B to D), 2:2 (row 2), 3:5 (rows 3 to 5)。如果不指定范围，则默认对全部范围进行操作。</p>
<p><em>例子：</em></p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">top_profit = [Monthly Report.xlsx]August!E10</span><br><span class="line">top_salesman = [Monthly Report.xlsx]August!E11</span><br><span class="line">data_array = [Quarterly Metrics.xlsx]Main!B3:G100</span><br><span class="line">data_array = [C:\Reports\June.xls]Sheet1!A1:C2</span><br><span class="line"></span><br><span class="line">data_array = [C:\Reports\June.xls]Sheet1!A:A</span><br><span class="line">data_array = [C:\Reports\June.xls]Sheet1!B:D</span><br><span class="line">data_array = [C:\Reports\June.xls]Sheet1!2:2</span><br><span class="line">data_array = [C:\Reports\June.xls]Sheet1!3:5</span><br></pre></td></tr></table></figure></div>

<p>Tagui 的后端语言是JavaScript，因此 Data_array 可以像 JavaScript 数组一样使用。</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">// to work on data <span class="keyword">in</span> data_array cell by cell</span><br><span class="line"><span class="keyword">for</span> row from 0 to data_array.length-1</span><br><span class="line">  <span class="keyword">for</span> col from 0 to data_array[row].length-1</span><br><span class="line">    <span class="built_in">echo</span> `data_array[row][col]`</span><br></pre></td></tr></table></figure></div>

<p>注意 - 读取多行和列有一个限制，举例： B:D and 3:5 (data array returned will be a 1 x N array instead of the correct row x column array)。这个问题在 v6.87 中已经修复。使用 <code>tagui update</code> 命令升级，或者用 MS Word Plug-in <code>Update TagUI</code> 按钮升级。</p>
<h5 id="写入Excel"><a href="#写入Excel" class="headerlink" title="写入Excel"></a>写入Excel</h5><p>使用 Write 命令往Excel内写数据。支持相对和绝对文件路径。如果指定的文件不存在，将创建一个新文件。如果表单不存在，将创建新表。 If the data is an array, the given cell will be used as the top-left cell to write the range of cells.</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[workbook]sheet!cell = variable</span><br></pre></td></tr></table></figure></div>

<p><em>例子：</em></p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[Monthly Report.xlsx]August!E10 = 12345</span><br><span class="line">[Monthly Report.xlsx]August!E11 = <span class="string">&quot;Alan&quot;</span></span><br><span class="line">[Monthly Report.xlsx]August!E12 = variable</span><br><span class="line">[Quarterly Metrics.xlsx]Main!B3 = data_array</span><br></pre></td></tr></table></figure></div>

<p>Tagui 的后端语言是JavaScript，因此 Data_array 可以像 JavaScript 数组一样使用。</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">// to assign a <span class="built_in">set</span> of range data with 2 rows of 3 columns</span><br><span class="line">[C:\Reports\June.xls]Sheet1!A1 = [[1, 2, 3], [4, 5, 6]]</span><br><span class="line">[C:\Reports\June.xls]Sheet1!A1 = [[variable_1, variable_2, variable_3], [4, 5, 6]]</span><br><span class="line"></span><br><span class="line">// example spreadsheet data with <span class="comment">#, name and country</span></span><br><span class="line">[Participants.xlsx]Sheet1!A1 = [[<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;John&#x27;</span>, <span class="string">&#x27;USA&#x27;</span>], [2, <span class="string">&#x27;Jenny&#x27;</span>, <span class="string">&#x27;Russia&#x27;</span>], [3, <span class="string">&#x27;Javier&#x27;</span>, <span class="string">&#x27;Serbia&#x27;</span>]]</span><br><span class="line"></span><br><span class="line">// get the next row count <span class="keyword">for</span> the example spreadsheet</span><br><span class="line">column_A = [Participants.xlsx]Sheet1!A:A</span><br><span class="line">next_row = column_A.length + 1</span><br><span class="line"></span><br><span class="line">// write a new row accordingly to example spreadsheet</span><br><span class="line">[Participants.xlsx]Sheet1!A`next_row` = [[next_row, <span class="string">&#x27;Janice&#x27;</span>, <span class="string">&#x27;Brazil&#x27;</span>]]</span><br></pre></td></tr></table></figure></div>

<h5 id="copy-复制"><a href="#copy-复制" class="headerlink" title="copy 复制"></a>copy 复制</h5><p>在Excel文件中复制数据。支持相对和绝对文件路径。如果指定的目标文件不存在，将创建一个新文件。如果目标工作表不存在，将创建一个新工作表。如果数据是数组，则给定单元格将用作左上角单元格来写入单元格范围。</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[workbook]sheet!cell = [workbook]sheet!range</span><br></pre></td></tr></table></figure></div>

<p><em>例子：</em></p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[Monthly Report.xlsx]August!A1 = [Jennifer Report.xlsx]August!A1</span><br><span class="line">[Monthly Report.xlsx]August!A1 = [Jennifer Report.xlsx]August!A1:E200</span><br></pre></td></tr></table></figure></div>

<h5 id="delete-删除"><a href="#delete-删除" class="headerlink" title="delete 删除"></a>delete 删除</h5><p>删除 Excel 内的数据。支持相对和绝对文件路径。如果指定的文件或工作表不存在，将显示错误。Delete a range of cells by assigning an empty array to it.</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[workbook]sheet!cell = <span class="string">&quot;&quot;</span></span><br></pre></td></tr></table></figure></div>

<p><em>例子：</em></p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[Monthly Report.xlsx]August!E10 = <span class="string">&quot;&quot;</span></span><br><span class="line">[Quarterly Metrics.xlsx]Main!A1 = [[<span class="string">&quot;&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="string">&quot;&quot;</span>], [<span class="string">&quot;&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="string">&quot;&quot;</span>]]</span><br></pre></td></tr></table></figure></div>

<h4 id="Word"><a href="#Word" class="headerlink" title="Word"></a>Word</h4><p>只需将 Microsoft Word 文档的文件名分配给变量即可读取其文本内容，如下所示。 TagUI 将自动 Microsoft Word 复制文本内容并分配给变量。此功能适用于 Windows 和 Mac。</p>
<p><em>Windows 设置word文件路径举例：</em></p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">word_text = [Research Report.docx]</span><br><span class="line">word_text = [C:\Users\Jennifer\Desktop\Report.docx]</span><br><span class="line">word_text = [FY2021 Reports\Research Report.docx]</span><br><span class="line"></span><br><span class="line">filename = <span class="string">&#x27;C:\\Users\\Jennifer\\Desktop\\Report&#x27;</span></span><br><span class="line">word_text = [`filename`.docx]</span><br><span class="line">filename = <span class="string">&#x27;Research Report&#x27;</span></span><br><span class="line">word_text = [`filename`.docx]</span><br></pre></td></tr></table></figure></div>

<p><em>Mac 设置word文件路径举例：</em></p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">word_text = [Research Report.docx]</span><br><span class="line">word_text = [/Users/jennifer/Desktop/Report.docx]</span><br><span class="line">word_text = [FY2021 Reports/Research Report.docx]</span><br><span class="line"></span><br><span class="line">filename = <span class="string">&#x27;/Users/jennifer/Desktop/Report&#x27;</span></span><br><span class="line">word_text = [`filename`.docx]</span><br><span class="line">filename = <span class="string">&#x27;Research Report&#x27;</span></span><br><span class="line">word_text = [`filename`.docx]</span><br></pre></td></tr></table></figure></div>

<p>将文本内容读入变量后，可以使用Tagui的函数来处理它，例如 get_text() 和 del_chars()，以获得RPA流程所需的特定信息。标准JavaScript函数也可用于进行字符串处理，可以 Google 搜索 <code>javascript how to xxxx</code>。 从 Word 读取文本内容后，TagUI 将关闭 Microsoft Word 并继续执行接下去的流程。</p>
<h4 id="PDF"><a href="#PDF" class="headerlink" title="PDF"></a>PDF</h4><p>只需要将文件名分配给变量，就可以将PDF文件的文本内容赋值给变量。TagUI 将自动执行 PDF Viewer 应用程序以复制文本内容并分配给变量。在 Windows 系统, 需要安装 Adobe Acrobat Reader，并且设置为打开pdf的默认程序。在Mac 系统, TagUI 使用可以查看PDF文件的默认预览应用程序。</p>
<p><em>Windows 设置pdf文件路径举例：</em></p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">pdf_text = [Research Report.pdf]</span><br><span class="line">pdf_text = [C:\Users\Jennifer\Desktop\Report.pdf]</span><br><span class="line">pdf_text = [FY2021 Reports\Research Report.pdf]</span><br><span class="line"></span><br><span class="line">filename = <span class="string">&#x27;C:\\Users\\Jennifer\\Desktop\\Report&#x27;</span></span><br><span class="line">pdf_text = [`filename`.pdf]</span><br><span class="line">filename = <span class="string">&#x27;Research Report&#x27;</span></span><br><span class="line">pdf_text = [`filename`.pdf]</span><br></pre></td></tr></table></figure></div>

<p><em>Mac 设置pdf文件路径举例：</em></p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">pdf_text = [Research Report.pdf]</span><br><span class="line">pdf_text = [/Users/jennifer/Desktop/Report.pdf]</span><br><span class="line">pdf_text = [FY2021 Reports/Research Report.pdf]</span><br><span class="line"></span><br><span class="line">filename = <span class="string">&#x27;/Users/jennifer/Desktop/Report&#x27;</span></span><br><span class="line">pdf_text = [`filename`.pdf]</span><br><span class="line">filename = <span class="string">&#x27;Research Report&#x27;</span></span><br><span class="line">pdf_text = [`filename`.pdf]</span><br></pre></td></tr></table></figure></div>

<p>将文本内容读入变量后，可以使用 Tagui 的函数 get_text() 和 del_chars() 来获得RPA流程所需的特定信息。标准JavaScript函数也可用于进行字符串处理，具体可以 Google 搜索<code>javascript how to xxxx</code>。从PDF文件读取文本内容后，TagUI将关闭PDF查看器并继续使用其余自动化步骤。</p>
<h4 id="Using-variables-使用变量"><a href="#Using-variables-使用变量" class="headerlink" title="Using variables 使用变量"></a>Using variables 使用变量</h4><h5 id="read-读取目标内容放入变量"><a href="#read-读取目标内容放入变量" class="headerlink" title="read 读取目标内容放入变量"></a>read 读取目标内容放入变量</h5><p>获取一些文本或值并将其存储在变量中。</p>
<p>可以使用 DOM, XPath, Region, Image 进行目标定位。</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">read</span> [DOM/XPath/Region/Image] to [variable]</span><br></pre></td></tr></table></figure></div>

<p>当提供区域Region 或 图像Image 元素特征时，Tagui 会使用OCR从屏幕中读取字符。</p>
<p><em>例子：</em></p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">read</span> //p[@<span class="built_in">id</span>=<span class="string">&quot;address&quot;</span>] to address</span><br><span class="line"></span><br><span class="line"><span class="built_in">read</span> //p[@<span class="built_in">id</span>=<span class="string">&quot;address&quot;</span>]/@class to address-class</span><br><span class="line"></span><br><span class="line"><span class="built_in">read</span> (500,200)-(600,400) to id-number</span><br><span class="line"></span><br><span class="line"><span class="built_in">read</span> frame.png to email</span><br></pre></td></tr></table></figure></div>

<h5 id="变量赋值"><a href="#变量赋值" class="headerlink" title="变量赋值"></a>变量赋值</h5><p>将文本保存到变量。</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[variable] = [value]</span><br></pre></td></tr></table></figure></div>

<p>在值中使用文本时，请围绕引号中的文本，如 “某些文本”。这使用 JavaScript 的规则，因此可以将数字分配给变量或使用其他 JavaScript 函数。变量名称需要是一个单词，不能以数字开头。</p>
<p><em>例子：</em></p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">count = 5</span><br><span class="line">username = <span class="string">&quot;johncleese&quot;</span></span><br><span class="line">fullname = firstname + lastname</span><br></pre></td></tr></table></figure></div>

<h4 id="File-saving-loading-文件保存和读取"><a href="#File-saving-loading-文件保存和读取" class="headerlink" title="File saving&#x2F;loading 文件保存和读取"></a>File saving&#x2F;loading 文件保存和读取</h4><h5 id="dump-文本保存到文件"><a href="#dump-文本保存到文件" class="headerlink" title="dump 文本保存到文件"></a>dump 文本保存到文件</h5><p>将文本保存到新文件，例如把一个文本变量，保存到一个txt里。</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">dump [text] to [filename]</span><br><span class="line">dump [`variable`] to [filename]</span><br><span class="line">// creates blank CSV file with header</span><br><span class="line">dump First Name,Last Name to names.csv</span><br></pre></td></tr></table></figure></div>

<h5 id="write-追加写入"><a href="#write-追加写入" class="headerlink" title="write 追加写入"></a>write 追加写入</h5><p>将新的文本保存到现有文件中。</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">write [text] to [filename]</span><br><span class="line">write [`variable`] to [filename]</span><br></pre></td></tr></table></figure></div>

<p><em>例子：</em></p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">write firstname,lastname to names.csv</span><br><span class="line">write `fullreport` to report.txt</span><br></pre></td></tr></table></figure></div>

<h5 id="load-读取"><a href="#load-读取" class="headerlink" title="load 读取"></a>load 读取</h5><p>将文件内容加载到变量。</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">load [filename] to [variable]</span><br></pre></td></tr></table></figure></div>

<p><em>例子：</em></p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">load report.txt to report</span><br></pre></td></tr></table></figure></div>

<h5 id="snap-截屏"><a href="#snap-截屏" class="headerlink" title="snap 截屏"></a>snap 截屏</h5><p>屏幕截图功能，可以是全屏、某个元素或区域。</p>
<p>可以使用 DOM, XPath, Region, Image 进行目标定位。</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">snap [DOM/XPath/Region/Image/page] to [filename]</span><br></pre></td></tr></table></figure></div>

<p>如果使用 <code>page</code> 定位目标，会把整个网页进行截图。</p>
<p><em>例子：</em></p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">snap logo to logo.png</span><br><span class="line"></span><br><span class="line">snap page to webpage.png</span><br></pre></td></tr></table></figure></div>

<h4 id="显示输出"><a href="#显示输出" class="headerlink" title="显示输出"></a>显示输出</h4><h5 id="echo-信息输出"><a href="#echo-信息输出" class="headerlink" title="echo 信息输出"></a>echo 信息输出</h5><p>在命令行上显示输出内容，比如显示变量。</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> [text]</span><br><span class="line"><span class="built_in">echo</span> [`variable`]</span><br></pre></td></tr></table></figure></div>

<p><em>例子：</em></p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">echo Flow has started</span><br><span class="line">echo The user is `username`</span><br></pre></td></tr></table></figure></div>

<h5 id="show-显示元素文本"><a href="#show-显示元素文本" class="headerlink" title="show 显示元素文本"></a>show 显示元素文本</h5><p>在命令行上直接显示元素文本。</p>
<p>可以用 DOM, XPath 进行目标定位。</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show [DOM/XPath]</span><br></pre></td></tr></table></figure></div>

<p><em>例子：</em></p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">show review-text</span><br></pre></td></tr></table></figure></div>

<h5 id="check-根据条件显示文本"><a href="#check-根据条件显示文本" class="headerlink" title="check 根据条件显示文本"></a>check 根据条件显示文本</h5><p>基于条件显示不同文本信息。</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">check [条件] | [结果为 <span class="literal">true</span> 的文本] | [结果为 <span class="literal">false</span> 的文本]</span><br></pre></td></tr></table></figure></div>

<p><em>例子：</em></p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">check header_home_text equals to <span class="string">&quot;Home&quot;</span> | <span class="string">&quot;header text is correct&quot;</span> | <span class="string">&quot;header text is wrong&quot;</span></span><br></pre></td></tr></table></figure></div>

<h4 id="Custom-code-自定义代码"><a href="#Custom-code-自定义代码" class="headerlink" title="Custom code 自定义代码"></a>Custom code 自定义代码</h4><h5 id="JavaScript"><a href="#JavaScript" class="headerlink" title="JavaScript"></a>JavaScript</h5><p>运行 JavaScript 代码。TagUI 直接访问 JavaScript 变量。</p>
<p>TagUI 可以“智能”判断以下 3 种情况使用，无需使用js或js begin&#x2F; js finish：</p>
<ol>
<li>分配或改变变量 分配变量时，TagUI 可以检测&#x3D;符号并自动将该行视为 JavaScript 代码。</li>
<li>以 ; 结尾：如果一行以 ; 字符结尾，并且该行无法匹配任何已知的 TagUI 命令，则将其视为 JavaScript 代码。</li>
<li>常见的JavaScript关键字开头：如果一行无法匹配任何已知的 TagUI 命令，并且该行以常见的JavaScript 关键字（例如 if、for、switch、else、while、case、break、continue 等）开头，它将自动被视为 JavaScript 代码。</li>
</ol>
<p><code>js</code>，<code>js begin</code>和<code>js finish</code>方式使用 -</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">js 1-line JavaScript code</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">js begin</span><br><span class="line">JavaScript code line 1</span><br><span class="line">JavaScript code line 2</span><br><span class="line">JavaScript code line 3</span><br><span class="line">js finish</span><br></pre></td></tr></table></figure></div>

<p>每当有一些 JavaScript 代码（除了 TagUI 步骤或辅助函数之外的任何代码）时，都需要上面的代码。然而，TagUI 可以“智能”地检测到以下 3 种使用 JavaScript 但<code>js</code>不需要的情况。</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">js [JavaScript statement]</span><br><span class="line"></span><br><span class="line">js begin</span><br><span class="line">[JavaScript statements]</span><br><span class="line">js finish</span><br></pre></td></tr></table></figure></div>

<p><em>例子：</em></p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">js obj = JSON.parse(api_result)</span><br><span class="line">dump `obj` to result.json</span><br><span class="line"></span><br><span class="line">js begin</span><br><span class="line">obj = JSON.parse(api_result)</span><br><span class="line">randomInteger = Math.floor(Math.random() * Math.floor(5)) + 1</span><br><span class="line">js finish</span><br><span class="line">dump `obj` to result.json</span><br><span class="line"></span><br><span class="line">// <span class="built_in">declare</span> and initilise variable to use it inside/outside js code block</span><br><span class="line">a = <span class="string">&quot;&quot;</span></span><br><span class="line">js begin</span><br><span class="line">a = <span class="string">&quot;some string&quot;</span></span><br><span class="line">js finish</span><br><span class="line"><span class="built_in">echo</span> `a`</span><br></pre></td></tr></table></figure></div>

<p><strong>1. 分配或更改变量</strong></p>
<p>当分配变量时，TagUI 可以检测符号<code>=</code>并自动将该行视为 JavaScript 代码，而无需用户显式使用<code>js</code>或<code>js begin</code>&#x2F; <code>js finish</code>。</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">name = <span class="string">&quot;Johnny&quot;</span></span><br></pre></td></tr></table></figure></div>

<p><strong>2. 以 ; 结尾的行特点</strong></p>
<p>如果一行以<code>;</code>字符结尾，并且该行无法匹配任何已知的 TagUI 步骤，则将其视为 JavaScript 代码。</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// below line quit TagUI</span><br><span class="line">this.exit();</span><br></pre></td></tr></table></figure></div>

<p><strong>3. 常用JavaScript关键字</strong></p>
<p>如果一行无法匹配任何已知的 TagUI 步骤，并且该行以常见的 JavaScript 关键字（例如 if、for、switch、else、while、case、break、continue 等）开头，它将自动被视为 JavaScript 代码，而无需使用<code>js</code>.</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> n from 1 to 10</span><br><span class="line">    <span class="built_in">echo</span> `n`</span><br><span class="line">    <span class="keyword">if</span> n equals to 5</span><br><span class="line">        <span class="built_in">break</span></span><br></pre></td></tr></table></figure></div>

<h5 id="Python"><a href="#Python" class="headerlink" title="Python"></a>Python</h5><p>运行Python代码并将stdout 保存到变量 <code>py_result</code> 作为字符串。</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">py [Python statement]</span><br><span class="line"></span><br><span class="line">py begin</span><br><span class="line">[Python statements]</span><br><span class="line">py finish</span><br></pre></td></tr></table></figure></div>

<p><em>例子：</em></p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">py result = 2 + 3</span><br><span class="line">py <span class="built_in">print</span>(result)</span><br><span class="line"><span class="built_in">echo</span> `py_result`</span><br><span class="line"></span><br><span class="line">py begin</span><br><span class="line">import random</span><br><span class="line">random_integer = random.randint(1,6)</span><br><span class="line"><span class="built_in">print</span>(random_integer)</span><br><span class="line">py finish</span><br><span class="line"><span class="built_in">echo</span> `py_result`</span><br></pre></td></tr></table></figure></div>

<p>有关运行Python代码的更多示例和使用模式查看高级命令</p>
<h5 id="RUN"><a href="#RUN" class="headerlink" title="RUN"></a>RUN</h5><p>在命令提示符或终端中运行命令，并将 stdout 保存到变量 <code>run_result</code>。</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run [shell <span class="built_in">command</span>]</span><br></pre></td></tr></table></figure></div>

<p><em>例子：</em></p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">run cmd /c <span class="built_in">mkdir</span> new_directory</span><br></pre></td></tr></table></figure></div>

<h5 id="Sikuli"><a href="#Sikuli" class="headerlink" title="Sikuli"></a>Sikuli</h5><p>运行 Sikuli 代码，例如需要把OCR设置成中文</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">vision begin</span><br><span class="line">import org.sikuli.script.TextRecognizer as TR</span><br><span class="line">Settings.OcrReadText = True</span><br><span class="line">Settings.OcrLanguage = <span class="string">&quot;chi_sim&quot;</span></span><br><span class="line">TR.reset()</span><br><span class="line">vision finish</span><br></pre></td></tr></table></figure></div>

<p><em>例子：</em></p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vision click(<span class="string">&quot;button1.png&quot;</span>)</span><br></pre></td></tr></table></figure></div>

<h5 id="DOM"><a href="#DOM" class="headerlink" title="DOM"></a>DOM</h5><p>在浏览器 DOM 中运行代码并将返回值保存到变量 <code>dom_result</code>。</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">dom [JavaScript statement to run <span class="keyword">in</span> the DOM]</span><br><span class="line"></span><br><span class="line">dom begin</span><br><span class="line">[JavaScript statements to run <span class="keyword">in</span> the DOM]</span><br><span class="line">dom finish</span><br></pre></td></tr></table></figure></div>

<p><em>例子：</em></p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// goes back to previous page</span><br><span class="line">dom window.history.back()</span><br><span class="line"></span><br><span class="line">// returns text of an element</span><br><span class="line">dom <span class="built_in">return</span> document.querySelector(<span class="string">&#x27;#some_id&#x27;</span>).textContent</span><br></pre></td></tr></table></figure></div>

<h5 id="R"><a href="#R" class="headerlink" title="R"></a>R</h5><p>运行 R 语句并将 stdout 保存到变量 <code>r_result</code>。</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">r [R statement]</span><br><span class="line"></span><br><span class="line">r begin</span><br><span class="line">[R statements]</span><br><span class="line">r finish</span><br></pre></td></tr></table></figure></div>

<h4 id="更多命令"><a href="#更多命令" class="headerlink" title="更多命令"></a>更多命令</h4><h5 id="wait-等待"><a href="#wait-等待" class="headerlink" title="wait 等待"></a>wait 等待</h5><p>等待一段时间，默认时间单位：秒。</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">wait</span> [seconds to <span class="built_in">wait</span>]</span><br><span class="line"><span class="built_in">wait</span> [seconds to <span class="built_in">wait</span>] s</span><br><span class="line"><span class="built_in">wait</span> [seconds to <span class="built_in">wait</span>] seconds</span><br></pre></td></tr></table></figure></div>

<p><em>例子：</em></p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">wait</span> 5.5</span><br><span class="line"><span class="built_in">wait</span> 10 s</span><br><span class="line"><span class="built_in">wait</span> 20 seconds</span><br></pre></td></tr></table></figure></div>

<h5 id="timeout-设置等待超时"><a href="#timeout-设置等待超时" class="headerlink" title="timeout 设置等待超时"></a>timeout 设置等待超时</h5><p>等待 Web 元素出现时，设置自动等待超时（默认为10秒）。</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">timeout</span> [seconds to <span class="built_in">wait</span> before <span class="built_in">timeout</span>]</span><br></pre></td></tr></table></figure></div>

<p><em>例子：</em></p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">timeout</span> 300</span><br></pre></td></tr></table></figure></div>

<h5 id="ask"><a href="#ask" class="headerlink" title="ask"></a>ask</h5><p>提示用户输入，并将用户输入内容保存为变量 <code>ask_result</code>。</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ask [prompt]</span><br></pre></td></tr></table></figure></div>

<p><em>例子：</em></p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ask What is the <span class="built_in">date</span> of the receipt? (<span class="keyword">in</span> DD-MM-YYYY)</span><br><span class="line"><span class="built_in">type</span> search as `ask_result`</span><br></pre></td></tr></table></figure></div>

<h5 id="live"><a href="#live" class="headerlink" title="live"></a>live</h5><p>一步步执行命令并立即看到输出。输入 “done” 退出Live模式。</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">live</span><br></pre></td></tr></table></figure></div>

<h5 id="tagui-调用流程"><a href="#tagui-调用流程" class="headerlink" title="tagui 调用流程"></a>tagui 调用流程</h5><p>调用另一个 TagUI 流程，注意文件路径别写错。</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tagui [flow file]</span><br><span class="line">tagui [folder/flow file]</span><br></pre></td></tr></table></figure></div>

<p><em>例子：</em></p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tagui update-forex.tag</span><br><span class="line">tagui flows/update-forex.tag</span><br></pre></td></tr></table></figure></div>

<h4 id="添加注释"><a href="#添加注释" class="headerlink" title="&#x2F;&#x2F; 添加注释"></a>&#x2F;&#x2F; 添加注释</h4><p>添加代码注释。在使用条件或循环命令是，注释也要相应缩进，以便在转换为JavaScript代码后正确运行。</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">// 这里写注释，不会被程序运行</span><br></pre></td></tr></table></figure></div>

<p><em>例子：</em></p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">// 点击登录按钮</span><br></pre></td></tr></table></figure></div>

<h4 id="Telegram"><a href="#Telegram" class="headerlink" title="Telegram"></a>Telegram</h4><p>Telegram 是国外的一款聊天软件，中国使用人数极少。TagUI 通过发送 telegram 消息，及时获得机器人的工作结果或报错状态信息。国内一般都用 企业微信、钉钉等。</p>
<p>首先要获得 <a class="link"   target="_blank" rel="noopener" href="https://t.me/taguibot" >@taguibot <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a> 发消息授权，然后再用 TagUI 下面的命令：</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">telegram [<span class="built_in">id</span>] [message]</span><br></pre></td></tr></table></figure></div>

<p><em>例子：</em></p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">// this line sends message to Telegram user with ID 1234567890, \n means a new line</span><br><span class="line">telegram 1234567890 Hello Alena,\n\nYour HR onboarding bot has completed successfully.</span><br><span class="line"></span><br><span class="line">// show telegram_result variable - <span class="string">&#x27;success&#x27;</span> means sent, <span class="string">&#x27;fail&#x27;</span> means sending failed</span><br><span class="line"><span class="built_in">echo</span> Telegram message - `telegram_result`</span><br><span class="line"></span><br><span class="line">// <span class="keyword">if</span> condition to check telegram_result <span class="string">&#x27;success&#x27;</span> or <span class="string">&#x27;fail&#x27;</span> and handle accordingly</span><br><span class="line"><span class="keyword">if</span> telegram_result equals to <span class="string">&#x27;success&#x27;</span></span><br><span class="line">  <span class="built_in">echo</span> Message sent successfully.</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">  <span class="built_in">echo</span> Message sending failed.</span><br></pre></td></tr></table></figure></div>


  <div class="note-large orange">
    <div class="notel-title rounded-t-lg p-3 font-bold text-lg flex flex-row gap-2 items-center">
      <i class="notel-icon fa-solid fa-circle-exclamation"></i><p>注意</p>

    </div>
    <div class="notel-content">
      <p>电报步骤需要互联网连接。此功能托管在<a class="link"   target="_blank" rel="noopener" href="https://tebel.org/" >https://tebel.org <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>上，但如果希望在自己的云或服务器上托管此功能，则<a class="link"   target="_blank" rel="noopener" href="https://github.com/kelaberetiv/TagUI/tree/master/src/telegram" >源代码 <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>位于 GitHub 上。该实现是在纯 PHP 中实现的，没有任何依赖项。</p>
<p>记录的唯一信息是 chat_id、消息长度、日期时间戳（以防止滥用）。如果希望自行托管，请首先阅读此链接以了解有关 Telegram Bot API、创建的 bot API 令牌并设置 webhook 的更多信息 - <a class="link"   target="_blank" rel="noopener" href="https://core.telegram.org/bots" >https://core.telegram.org/bots <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></p>

    </div>
  </div>

<h4 id="Run-options-运行流程选项"><a href="#Run-options-运行流程选项" class="headerlink" title="Run options 运行流程选项"></a>Run options 运行流程选项</h4><p>可以使用 <code>tagui</code> 命令，查看选项说明。</p>
<p>举例：这条命令运行 <code>my_flow.tag</code> 而隐藏Web浏览器，同时把流程运行结果存储到 <code>tagui_report.csv</code> 中。</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tagui my_flow.tag -headless -report</span><br></pre></td></tr></table></figure></div>

<h5 id="deploy-or-d-生产CMD快捷方式"><a href="#deploy-or-d-生产CMD快捷方式" class="headerlink" title="-deploy or -d 生产CMD快捷方式"></a>-deploy or -d 生产CMD快捷方式</h5><p>创建一个可以双击运行流程的快捷方式。如果移动文件，则必须创建一个新的快捷方式。流程将在创建快捷方式时使用的所有选项运行。</p>
<h5 id="headless-or-h-隐藏浏览器"><a href="#headless-or-h-隐藏浏览器" class="headerlink" title="-headless or -h 隐藏浏览器"></a>-headless or -h 隐藏浏览器</h5><p>运行时，隐藏 Chrome Web浏览器（隐藏浏览器就无法使用 Visual Automation）。</p>
<h5 id="nobrowser-or-n-不使用Web浏览器"><a href="#nobrowser-or-n-不使用Web浏览器" class="headerlink" title="-nobrowser or -n 不使用Web浏览器"></a>-nobrowser or -n 不使用Web浏览器</h5><p>不使用Web浏览器，例如仅使用可视自动化执行自动化。</p>
<h5 id="report-or-r-保存HTML日志"><a href="#report-or-r-保存HTML日志" class="headerlink" title="-report or -r 保存HTML日志"></a>-report or -r 保存HTML日志</h5><p>追踪流程运行结果，记录在<code>tagui/src/tagui_report.csv</code> 中，并保存流量执行的HTML日志。</p>
<h5 id="turbo-or-t-十倍速运行"><a href="#turbo-or-t-十倍速运行" class="headerlink" title="-turbo or -t 十倍速运行"></a>-turbo or -t 十倍速运行</h5><p>在10倍的速度下运行流程。谨慎使用！</p>
<h5 id="quiet-or-q-减少非主动信息输出"><a href="#quiet-or-q-减少非主动信息输出" class="headerlink" title="-quiet or -q 减少非主动信息输出"></a>-quiet or -q 减少非主动信息输出</h5><p>除了 echo, show, check steps and errors etc 之外，不显示其他输出。在执行期间显示和隐藏输出的细粒度控制（例如，隐藏密码显示出来）, 可以在流处里使用 <code>quiet_mode = true</code> 和 <code>quiet_mode = false</code> 进行控制。</p>
<h5 id="edge-or-e-使用Edge浏览器"><a href="#edge-or-e-使用Edge浏览器" class="headerlink" title="-edge or -e 使用Edge浏览器"></a>-edge or -e 使用Edge浏览器</h5><p>使用 Microsoft Edge浏览器而不是Chrome运行（可与-headless选项一起使用）。</p>
<h5 id="my-datatable-csv"><a href="#my-datatable-csv" class="headerlink" title="my_datatable.csv"></a>my_datatable.csv</h5><p>使用指定的CSV文件作为批量自动化的DataTable。查看 <a class="link"   target="_blank" rel="noopener" href="http://www.tagui.com.cn/advanced.html#datatables" >datatables <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>。</p>
<h5 id="input-s-流程参数"><a href="#input-s-流程参数" class="headerlink" title="input(s) 流程参数"></a>input(s) 流程参数</h5><p>添加自己的流程参数，在的流程中做为变量P1至P8使用。</p>
<p>例如在CMD里,运行 <code>register_attendence.tag</code> 流程，需要用 Edge 浏览器，同时向该流程输入4个变量（4个人名）。</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tagui register_attendence.tag -edge Jenny Jason John Joanne</span><br></pre></td></tr></table></figure></div>

<p>在流程里, 4个人名会自动分配给4个变量 <code>p1</code>, <code>p2</code>, <code>p3</code>, <code>p4</code> 。例如在需要输入不同数据时，就特别方便，下面的命令会显示出这4个变量，可以试试。</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> `p1`</span><br><span class="line"><span class="built_in">echo</span> `p2`</span><br><span class="line"><span class="built_in">echo</span> `p3`</span><br><span class="line"><span class="built_in">echo</span> `p4`</span><br></pre></td></tr></table></figure></div>

<h3 id="辅助函数"><a href="#辅助函数" class="headerlink" title="辅助函数"></a>辅助函数</h3><h4 id="csv-row-1"><a href="#csv-row-1" class="headerlink" title="csv_row()"></a>csv_row()</h4><p>以数组方式写入CSV文件。</p>
<p><em>例子：</em></p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">read</span> name_element to name</span><br><span class="line"><span class="built_in">read</span> price_element to price</span><br><span class="line"><span class="built_in">read</span> details_element to details</span><br><span class="line">write `csv_row([name, price, details])` to product_list.csv</span><br></pre></td></tr></table></figure></div>

<h4 id="count-数量计算"><a href="#count-数量计算" class="headerlink" title="count() 数量计算"></a>count() 数量计算</h4><p>获取符合指定元素特征的元素数，例如计算有多少个新闻标题，然后用for读取它们。请注意，元素特征需要单引号 <code>&#39;&#39;</code>。</p>
<p><em>例子：</em></p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rows = count(<span class="string">&#x27;table-rows&#x27;</span>)</span><br></pre></td></tr></table></figure></div>

<h4 id="clipboard-剪贴板-1"><a href="#clipboard-剪贴板-1" class="headerlink" title="clipboard() 剪贴板"></a>clipboard() 剪贴板</h4><p>将文本放在剪贴板上，或获取剪贴板文本。</p>
<p><em>例子：</em></p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">clipboard(<span class="string">&#x27;some text&#x27;</span>)</span><br><span class="line">keyboard [ctrl]v</span><br><span class="line"></span><br><span class="line">keyboard [ctrl]c</span><br><span class="line">contents = clipboard()</span><br></pre></td></tr></table></figure></div>

<h4 id="url-获取当前URL"><a href="#url-获取当前URL" class="headerlink" title="url() 获取当前URL"></a>url() 获取当前URL</h4><p>获取当前网页的URL。</p>
<p><em>例子：</em></p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> url() contains <span class="string">&#x27;success&#x27;</span></span><br><span class="line">  click button1</span><br></pre></td></tr></table></figure></div>

<h4 id="title-获取当前网页标题。"><a href="#title-获取当前网页标题。" class="headerlink" title="title() 获取当前网页标题。"></a>title() 获取当前网页标题。</h4><p>获取当前网页的标题title。</p>
<p><em>例子：</em></p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> title() contains <span class="string">&#x27;Confirmation&#x27;</span></span><br><span class="line">  click button1</span><br></pre></td></tr></table></figure></div>

<h4 id="text"><a href="#text" class="headerlink" title="text()"></a>text()</h4><p>获取当前网页的所有文本内容。</p>
<p><em>例子：</em></p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> text() contains <span class="string">&#x27;success&#x27;</span></span><br><span class="line">  click button1</span><br></pre></td></tr></table></figure></div>

<h4 id="timer"><a href="#timer" class="headerlink" title="timer()"></a>timer()</h4><p>获得一段命令执行的时间周期，时间单位：秒。</p>
<p><em>例子：</em></p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">timer()</span><br><span class="line">click button1</span><br><span class="line">click button2</span><br><span class="line">click button3</span><br><span class="line"><span class="built_in">echo</span> `timer()`</span><br></pre></td></tr></table></figure></div>

<h4 id="exist-等待元素出现"><a href="#exist-等待元素出现" class="headerlink" title="exist() 等待元素出现"></a>exist() 等待元素出现</h4><p>等待元素出现，如果元素出现返回<code>true</code> ，如果元素等待时间超时，元素还没有出现，就返回 <code>false</code>，通常在网页搜索、查询等流程时使用本命令，以确定查询结果已经出现后，才继续下面的流程。请注意，元素特征包含在引号 ‘’ 内。</p>
<p>可以使用 DOM, XPath, Image 进行目标定位。</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">exist(<span class="string">&#x27;[DOM/XPath/Image]&#x27;</span>)</span><br></pre></td></tr></table></figure></div>

<p><em>例子：</em></p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> exist(<span class="string">&#x27;//table&#x27;</span>)</span><br><span class="line">  click button1</span><br></pre></td></tr></table></figure></div>

<h4 id="present-判断元素是否存在"><a href="#present-判断元素是否存在" class="headerlink" title="present() 判断元素是否存在"></a>present() 判断元素是否存在</h4><p>判断元素是否存在，并且直接返回 <code>true</code> 或 <code>false</code>。</p>
<p>请注意，元素特征包含在单引号 <code>&#39;</code> 内。</p>
<p>可以使用DOM, XPath, Image 进行目标定位。</p>
<p><em>例子：</em></p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> present(<span class="string">&#x27;//table&#x27;</span>)</span><br><span class="line">  click button1</span><br></pre></td></tr></table></figure></div>

<h4 id="mouse-xy-1"><a href="#mouse-xy-1" class="headerlink" title="mouse_xy()"></a>mouse_xy()</h4><p>获取当前鼠标位置的x，y坐标。</p>
<p>适合用在 live mode。</p>
<p><em>例子：</em></p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> `mouse_xy()`</span><br></pre></td></tr></table></figure></div>

<h4 id="mouse-x"><a href="#mouse-x" class="headerlink" title="mouse_x()"></a>mouse_x()</h4><p>获取当前鼠标位置的 x 坐标。</p>
<p><em>例子：</em></p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">hover element.png</span><br><span class="line">x = mouse_x() + 200</span><br><span class="line">y = mouse_y()</span><br><span class="line">click (`x`,`y`)</span><br></pre></td></tr></table></figure></div>

<h4 id="mouse-y"><a href="#mouse-y" class="headerlink" title="mouse_y()"></a>mouse_y()</h4><p>获取当前鼠标位置的 y 坐标。</p>
<p><em>例子：</em></p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">hover element.png</span><br><span class="line">x = mouse_x() + 200</span><br><span class="line">y = mouse_y()</span><br><span class="line">click (`x`,`y`)</span><br></pre></td></tr></table></figure></div>

<h4 id="get-files"><a href="#get-files" class="headerlink" title="get_files()"></a>get_files()</h4><p>获取文件或文件夹列表，支持相对和绝对路径。Returns an array of files and folders in a given folder. Both relative and absolute paths supported.</p>
<p><em>例子：</em></p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">// list of files <span class="keyword">in</span> the same folder as the flow file</span><br><span class="line">list = get_files(<span class="string">&#x27;.&#x27;</span>)</span><br><span class="line"></span><br><span class="line">// list of files <span class="keyword">in</span> the Desktop folder of user Alan</span><br><span class="line">// note double backslash because of JavaScript string</span><br><span class="line">list = get_files(<span class="string">&#x27;C:\\Users\\Alan\\Desktop&#x27;</span>)</span><br><span class="line"></span><br><span class="line">// alternatively, use single forward slash instead</span><br><span class="line">list = get_files(<span class="string">&#x27;C:/Users/Alan/Desktop&#x27;</span>)</span><br><span class="line"></span><br><span class="line">// showing the list of files after retrieving it</span><br><span class="line">// JavaScript array start from 0 <span class="keyword">for</span> 1st element</span><br><span class="line"><span class="keyword">for</span> n from 0 to list.length-1</span><br><span class="line">  <span class="built_in">echo</span> `list[n]`</span><br><span class="line"></span><br><span class="line">// checking to process a specific file extension</span><br><span class="line"><span class="keyword">for</span> n from 0 to list.length-1</span><br><span class="line">  <span class="keyword">if</span> list[n] contains <span class="string">&#x27;.XLSX&#x27;</span></span><br><span class="line">    <span class="built_in">echo</span> `list[n]`</span><br></pre></td></tr></table></figure></div>

<h4 id="get-text-截取文本"><a href="#get-text-截取文本" class="headerlink" title="get_text() 截取文本"></a>get_text() 截取文本</h4><p>从文本中提取2的锚点之间的文本。当有多个匹配结果时的可选第4参数（例如，3判断函数返回找到的第3匹配）。</p>
<p><em>例子：</em></p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">pdf_text = <span class="string">&#x27;Name: John State: Texas City: Plano Contact: ...&#x27;</span></span><br><span class="line"></span><br><span class="line">name = get_text(pdf_text, <span class="string">&#x27;Name:&#x27;</span>, <span class="string">&#x27;State:&#x27;</span>)</span><br><span class="line">state = get_text(pdf_text, <span class="string">&#x27;State:&#x27;</span>, <span class="string">&#x27;City:&#x27;</span>)</span><br><span class="line">city = get_text(pdf_text, <span class="string">&#x27;City:&#x27;</span>, <span class="string">&#x27;Contact:&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">echo</span> `name`, `state`, `city`</span><br></pre></td></tr></table></figure></div>

<h4 id="del-chars-删除文本"><a href="#del-chars-删除文本" class="headerlink" title="del_chars() 删除文本"></a>del_chars() 删除文本</h4><p>删除特征字符后的文本，并返回结果来清除数据。Cleans data by removing provided character(s) from given text and returning the result.</p>
<p><em>例子：</em></p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pdf_text = <span class="string">&#x27;Name: John\n State: Texas\t City: Plano\n Contact: ...&#x27;</span></span><br><span class="line"><span class="built_in">echo</span> `del_chars(pdf_text, <span class="string">&#x27;\n\t:&#x27;</span>)`</span><br></pre></td></tr></table></figure></div>

<h4 id="get-env-获得当前用户环境变量"><a href="#get-env-获得当前用户环境变量" class="headerlink" title="get_env() 获得当前用户环境变量"></a>get_env() 获得当前用户环境变量</h4><p>从操作系统返回给定环境变量的值。例如：C:\Users\Administrator</p>
<p><em>例子：</em></p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">// getting %USERPROFILE% variable <span class="keyword">for</span> Windows</span><br><span class="line"><span class="built_in">echo</span> `get_env(<span class="string">&#x27;USERPROFILE&#x27;</span>)`</span><br><span class="line">home_dir = get_env(<span class="string">&#x27;USERPROFILE&#x27;</span>)</span><br><span class="line"></span><br><span class="line">// getting <span class="variable">$HOME</span> variable <span class="keyword">for</span> Mac or Linux</span><br><span class="line"><span class="built_in">echo</span> `get_env(<span class="string">&#x27;HOME&#x27;</span>)`</span><br><span class="line">home_dir = get_env(<span class="string">&#x27;HOME&#x27;</span>)</span><br></pre></td></tr></table></figure></div>

<h2 id="RPA-for-Python-TagUI-在-Python-里使用"><a href="#RPA-for-Python-TagUI-在-Python-里使用" class="headerlink" title="RPA for Python (TagUI 在 Python 里使用)"></a>RPA for Python (TagUI 在 Python 里使用)</h2><p>RPA for Python 是一个 Python 库 (安装方式：<code>pip install rpa</code>) 这个库可以使用 Python API 来调用 TagUI 执行自动化RPA操作。查看<a class="link"   target="_blank" rel="noopener" href="https://github.com/tebelorg/RPA-Python" > 这里  <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a>， RPA for Python 由 TagUI’s creator Ken Soh <a class="link"   target="_blank" rel="noopener" href="https://github.com/kensoh" >@kensoh <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a> 创建和维护。</p>
<h2 id="TagUI-源代码的和依赖库"><a href="#TagUI-源代码的和依赖库" class="headerlink" title="TagUI 源代码的和依赖库"></a>TagUI 源代码的和依赖库</h2><p>可以查看这些源代码，帮助这些项目的迭代及Bug修复，因为这些项目都有大量用户在使用。</p>
<ul>
<li>TagUI - <a class="link"   href="javascript:if(confirm(https://github.com/kelaberetiv/TagUI" >https://github.com/kelaberetiv/TagUI <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></li>
<li>SikuliX - <a class="link"   target="_blank" rel="noopener" href="https://github.com/RaiMan/SikuliX1" >https://github.com/casperjs/casperjs <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></li>
<li>PhantomJS - <a class="link"   target="_blank" rel="noopener" href="https://github.com/ariya/phantomjs" >https://github.com/ariya/phantomjs <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></li>
<li>SlimerJS - <a class="link"   target="_blank" rel="noopener" href="https://github.com/laurentj/slimerjs" >https://github.com/laurentj/slimerjs <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></li>
<li>Python - <a class="link"   target="_blank" rel="noopener" href="https://github.com/python/cpython" >https://github.com/python/cpython <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></li>
<li>R - <a class="link"   target="_blank" rel="noopener" href="https://github.com/wch/r-source" >https://github.com/wch/r-source <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></li>
<li>PHP - <a class="link"   target="_blank" rel="noopener" href="https://github.com/php/php-src" >https://github.com/php/php-src <i class="fa-regular fa-arrow-up-right-from-square fa-sm"></i></a></li>
</ul>
<h2 id="示例代码块"><a href="#示例代码块" class="headerlink" title="示例代码块"></a>示例代码块</h2><h3 id="第一个例子"><a href="#第一个例子" class="headerlink" title="第一个例子"></a>第一个例子</h3><p>TagUI 支持运行服务器上的.tag文件，试试直接输入下面命令，会打开百度进行简单点击操作。</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tagui http://www.TagUI.com.cn/baidu.tag</span><br></pre></td></tr></table></figure></div>

<h3 id="把cmd设置成UTF-8"><a href="#把cmd设置成UTF-8" class="headerlink" title="把cmd设置成UTF-8"></a>把cmd设置成UTF-8</h3><p>这样在CMD环境里，echo输出就可以正常显示简体中文。</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// 把cmd设置成UTF-8</span><br><span class="line">run cmd /c chcp 65001</span><br></pre></td></tr></table></figure></div>

<h3 id="字符串查找替换"><a href="#字符串查找替换" class="headerlink" title="字符串查找替换"></a>字符串查找替换</h3><p>字符串替换命令，TagUI字符串处理，请参考 JS 语法</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">//字符串查找替换</span><br><span class="line">txt=<span class="string">&quot;http://baidu.com&quot;</span></span><br><span class="line">txt=txt.replace(<span class="string">&quot;baidu&quot;</span>,<span class="string">&quot;kkyyww&quot;</span>)</span><br></pre></td></tr></table></figure></div>

<h3 id="查找字符串目标文字位置"><a href="#查找字符串目标文字位置" class="headerlink" title="查找字符串目标文字位置"></a>查找字符串目标文字位置</h3><p>，参考JS语法</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">//查找字符串目标文字位置</span><br><span class="line">字符位置=txt.lastIndexOf(<span class="string">&quot;du.&quot;</span>)</span><br><span class="line"><span class="built_in">echo</span> `字符位置`</span><br></pre></td></tr></table></figure></div>

<h3 id="下载图片"><a href="#下载图片" class="headerlink" title="下载图片"></a>下载图片</h3><p>下载图片需要用curl.exe这个命令，百度 curl 具体了解。</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// 下载图片</span><br><span class="line">run curl -k -s -L -o c:/aaa.png http://www.bbb.com/ccc.jpg</span><br></pre></td></tr></table></figure></div>

<h3 id="download-命令的使用例子"><a href="#download-命令的使用例子" class="headerlink" title="download 命令的使用例子"></a>download 命令的使用例子</h3><p>download命令下载视频</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">https://www.videvo.net/video/apollo-command-and-service-module-separation/8/</span><br><span class="line">download to C:\Users\Administrator\Documents\TagUI\TCvideo\v</span><br><span class="line">click //*[@<span class="built_in">id</span>=<span class="string">&quot;download-button&quot;</span>]</span><br><span class="line"><span class="built_in">wait</span> 10</span><br></pre></td></tr></table></figure></div>

<h3 id="API-例子"><a href="#API-例子" class="headerlink" title="API 例子"></a>API 例子</h3><p>调用有道API翻译，初学者可以看看这里的数组处理方式</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// 用API翻译</span><br><span class="line">api http://fanyi.youdao.com/translate?&amp;doctype=json&amp;<span class="built_in">type</span>=AUTO&amp;i=i love you</span><br><span class="line">中文词 = JSON.parse(api_result)</span><br><span class="line">中文词 = 中文词[<span class="string">&quot;translateResult&quot;</span>][0][0][<span class="string">&quot;tgt&quot;</span>]</span><br><span class="line"><span class="built_in">echo</span> `中文词`</span><br></pre></td></tr></table></figure></div>

<h3 id="抓取百度首页新闻标题"><a href="#抓取百度首页新闻标题" class="headerlink" title="抓取百度首页新闻标题"></a>抓取百度首页新闻标题</h3><p>循环抓取 XPATH 的例子</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">// 抓取百度首页新闻标题</span><br><span class="line">http://baidu.com</span><br><span class="line">新闻总数量 = count(<span class="string">&#x27;/html/body/div[1]/div[1]/div[5]/div/div/div[3]/ul/li[*]/a/span[2]&#x27;</span>)</span><br><span class="line"><span class="built_in">echo</span> `新闻总数量`</span><br><span class="line"><span class="keyword">for</span> i from 1 to 新闻总数量</span><br><span class="line">  <span class="built_in">read</span> /html/body/div[1]/div[1]/div[5]/div/div/div[3]/ul/li[`i`]/a/span[2] to 标题</span><br><span class="line">  <span class="built_in">echo</span> `标题`</span><br></pre></td></tr></table></figure></div>

<h3 id="判断目录内是否包含指定扩展名文件"><a href="#判断目录内是否包含指定扩展名文件" class="headerlink" title="判断目录内是否包含指定扩展名文件"></a>判断目录内是否包含指定扩展名文件</h3><p>判断目录内是否包含指定扩展名文件，可用于判断下载是否完成</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// 判断目录内是否包含指定扩展名文件，可用于判断下载是否完成</span><br><span class="line">list = get_files(<span class="string">&#x27;C:\\Users\\Administrator\\Documents\\TagUI\\TCvideo\\v\\视频翻译\\&#x27;</span>)</span><br><span class="line">指定扩展名=<span class="string">&quot;mp4&quot;</span></span><br><span class="line"><span class="built_in">echo</span> `list[1].indexOf(指定扩展名)`</span><br><span class="line"><span class="built_in">echo</span> `字符位置`</span><br></pre></td></tr></table></figure></div>

<h3 id="判断chrome是否下载完成"><a href="#判断chrome是否下载完成" class="headerlink" title="判断chrome是否下载完成"></a>判断chrome是否下载完成</h3><p>判断chrome是否下载完成</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">// 判断chrome是否下载完成</span><br><span class="line">https://www.videvo.net/video/8//</span><br><span class="line"><span class="built_in">wait</span> 3</span><br><span class="line">click download-button</span><br><span class="line"><span class="built_in">wait</span> 3</span><br><span class="line"><span class="keyword">for</span> n from 1 to 100</span><br><span class="line">  <span class="built_in">echo</span> `present(<span class="string">&#x27;mb.png&#x27;</span>)`</span><br><span class="line">  <span class="keyword">if</span> present(<span class="string">&#x27;mb.png&#x27;</span>)</span><br><span class="line">    <span class="built_in">wait</span> 3</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="built_in">echo</span> 下载完成</span><br><span class="line">    <span class="built_in">break</span></span><br></pre></td></tr></table></figure></div>

<h3 id="读取excel，写入txt"><a href="#读取excel，写入txt" class="headerlink" title="读取excel，写入txt"></a>读取excel，写入txt</h3><p>读取excel，写入txt</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">//读excel</span><br><span class="line">data_array = [1.xlsx]sheet1!A1:B3</span><br><span class="line"><span class="built_in">echo</span> `data_array`</span><br><span class="line">dump `data_array` to 0.txt</span><br><span class="line"><span class="built_in">wait</span> 5</span><br></pre></td></tr></table></figure></div>

<h3 id="打开变量里的URL"><a href="#打开变量里的URL" class="headerlink" title="打开变量里的URL"></a>打开变量里的URL</h3><p>下面2种方法都可以，推荐用第二种</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">//打开变量里的URL</span><br><span class="line">url = <span class="string">&#x27;https://baidu.com&#x27;</span></span><br><span class="line">https://`url.split(<span class="string">&#x27;//&#x27;</span>)[1]`</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">//打开变量里的URL，推荐用这种方式，简单点</span><br><span class="line">url = <span class="string">&#x27;baidu.com&#x27;</span></span><br><span class="line">https://`url`</span><br></pre></td></tr></table></figure></div>

<h3 id="环境初始化"><a href="#环境初始化" class="headerlink" title="环境初始化"></a>环境初始化</h3><p>杀死TagUI相关进程，包括chrome，避免上一个tag没完成或卡主，影响当前tag运行</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// 环境初始化，杀死TagUI相关进程，包括chrome</span><br><span class="line">run cmd /c  d:/tagui/src/end_processes.cmd</span><br></pre></td></tr></table></figure></div>

<h3 id="获得本机名"><a href="#获得本机名" class="headerlink" title="获得本机名"></a>获得本机名</h3><p>获得本地Windows计算机名</p>
<div class="highlight-container" data-rel="Bash"><figure class="iseeu highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">//获得本机名</span><br><span class="line">run cmd /c hostname</span><br><span class="line">pcname=run_result</span><br><span class="line"><span class="built_in">echo</span> `pcname`</span><br></pre></td></tr></table></figure></div>
        </div>

        
            <div class="post-copyright-info w-full my-8 px-2 sm:px-6 md:px-8">
                <div class="article-copyright-info-container">
    <ul>
        <li><strong>标题:</strong> TagUI教程</li>
        <li><strong>作者:</strong> Yiuhang Chan</li>
        <li><strong>创建于
                :</strong> 2024-04-18 11:39:15</li>
        
            <li>
                <strong>更新于
                    :</strong> 2024-04-19 10:52:06
            </li>
        
        <li>
            <strong>链接:</strong> https://www.yiuhangblog.com/2024/04/18/20240418TagUI教程/
        </li>
        <li>
            <strong>
                版权声明:
            </strong>
            

            
                本文章采用 <a class="license" target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0">CC BY-NC-SA 4.0</a> 进行许可。
            
        </li>
    </ul>
</div>

            </div>
        

        
            <ul class="post-tags-box text-lg mt-1.5 flex-wrap justify-center flex md:hidden">
                
                    <li class="tag-item mx-0.5">
                        <a href="/tags/%E5%9F%BA%E7%A1%80/">#基础</a>&nbsp;
                    </li>
                
                    <li class="tag-item mx-0.5">
                        <a href="/tags/%E7%90%86%E8%AE%BA/">#理论</a>&nbsp;
                    </li>
                
            </ul>
        

        

        
            <div class="article-nav my-8 flex justify-between items-center px-2 sm:px-6 md:px-8">
                
                    <div class="article-prev border-border-color shadow-redefine-flat shadow-shadow-color-2 rounded-medium px-4 py-2 hover:shadow-redefine-flat-hover hover:shadow-shadow-color-2">
                        <a class="prev"
                        rel="prev"
                        href="/2024/04/19/20240419RobotFramework%E6%95%99%E7%A8%8B/"
                        >
                            <span class="left arrow-icon flex justify-center items-center">
                                <i class="fa-solid fa-chevron-left"></i>
                            </span>
                            <span class="title flex justify-center items-center">
                                <span class="post-nav-title-item">Robot Framework教程</span>
                                <span class="post-nav-item">上一篇</span>
                            </span>
                        </a>
                    </div>
                
                
                    <div class="article-next border-border-color shadow-redefine-flat shadow-shadow-color-2 rounded-medium px-4 py-2 hover:shadow-redefine-flat-hover hover:shadow-shadow-color-2">
                        <a class="next"
                        rel="next"
                        href="/2024/04/02/20240402CUDA%E5%AE%89%E8%A3%85%E6%95%99%E7%A8%8B/"
                        >
                            <span class="title flex justify-center items-center">
                                <span class="post-nav-title-item">CUDA安装</span>
                                <span class="post-nav-item">下一篇</span>
                            </span>
                            <span class="right arrow-icon flex justify-center items-center">
                                <i class="fa-solid fa-chevron-right"></i>
                            </span>
                        </a>
                    </div>
                
            </div>
        


        
            <div class="comment-container px-2 sm:px-6 md:px-8 pb-8">
                <div class="comments-container mt-10 w-full ">
    <div id="comment-anchor" class="w-full h-2.5"></div>
    <div class="comment-area-title w-full my-1.5 md:my-2.5 text-xl md:text-3xl font-bold">
        评论
    </div>
    

        
            
    <div id="waline"></div>
    <script type="module" data-swup-reload-script>
      import { init } from '/js/libs/waline.mjs';

      function loadWaline() {
        init({
          el: '#waline',
          serverURL: 'https://comment.yiuhangblog.com',
          lang: 'zh-CN',
          dark: 'body[class~="dark-mode"]',
          requiredMeta: ['nick', 'mail'],
          emoji: [],
          recaptchaV3Key: "wasd",
          
        });
      }

      if (typeof swup !== 'undefined') {
        loadWaline();
      } else {
        window.addEventListener('DOMContentLoaded', loadWaline);
      }
    </script>



        
    
</div>

            </div>
        
    </div>

    
        <div class="toc-content-container">
            <div class="post-toc-wrap">
    <div class="post-toc">
        <div class="toc-title">此页目录</div>
        <div class="page-title">TagUI教程</div>
        <ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%B5%84%E6%BA%90%E7%BD%91%E5%9D%80"><span class="nav-text">资源网址</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%8E%AF%E5%A2%83%E5%AE%89%E8%A3%85"><span class="nav-text">环境安装</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Windows"><span class="nav-text">Windows</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%B5%84%E6%BA%90%E4%B8%8B%E8%BD%BD"><span class="nav-text">资源下载</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%AE%80%E6%98%93%E8%87%AA%E5%8A%A8%E5%AE%89%E8%A3%85%E6%96%B9%E5%BC%8F-%E4%B8%8D%E5%BB%BA%E8%AE%AE"><span class="nav-text">简易自动安装方式 (不建议)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%89%8B%E5%8A%A8%E9%85%8D%E7%BD%AE%E5%AE%89%E8%A3%85%E6%96%B9%E5%BC%8F"><span class="nav-text">手动配置安装方式</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%B3%BB%E7%BB%9F%E7%BC%96%E7%A0%81%E8%AE%BE%E7%BD%AE"><span class="nav-text">系统编码设置</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%9F%BA%E7%A1%80%E5%8A%9F%E8%83%BD"><span class="nav-text">基础功能</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%89%A7%E8%A1%8C%E6%B5%81%E7%A8%8B"><span class="nav-text">执行流程</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BF%AB%E6%8D%B7%E6%89%A7%E8%A1%8C"><span class="nav-text">快捷执行</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BF%90%E8%A1%8C%E4%BA%91%E7%AB%AF-tag"><span class="nav-text">运行云端.tag</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%9A%90%E8%97%8F%E6%B5%8F%E8%A7%88%E5%99%A8%E8%BF%90%E8%A1%8C"><span class="nav-text">隐藏浏览器运行</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%9F%BA%E7%A1%80%E5%91%BD%E4%BB%A4"><span class="nav-text">基础命令</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#click-%E9%BC%A0%E6%A0%87%E5%B7%A6%E9%94%AE%E5%8D%95%E5%87%BB"><span class="nav-text">click 鼠标左键单击</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#WEB%E8%AE%BF%E9%97%AE"><span class="nav-text">WEB访问</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#type-%E6%96%87%E6%9C%AC%E8%BE%93%E5%85%A5"><span class="nav-text">type 文本输入</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#read-%E8%AF%BB%E5%8F%96%E5%85%83%E7%B4%A0%EF%BC%8C%E5%8F%AF%E8%AF%BB%E5%8F%96%E6%96%87%E6%9C%AC-%E6%88%96%E6%9F%90%E4%BA%9B%E5%B1%9E%E6%80%A7%E5%80%BC"><span class="nav-text">read 读取元素，可读取文本 或某些属性值</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#assign-%E8%B5%8B%E5%80%BC"><span class="nav-text">assign 赋值</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%85%83%E7%B4%A0%E5%AE%9A%E4%BD%8D"><span class="nav-text">元素定位</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#DOM-%E5%85%83%E7%B4%A0%E5%B1%9E%E6%80%A7%E5%AE%9A%E4%BD%8D"><span class="nav-text">DOM 元素属性定位</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#XPath-%E9%A1%B5%E9%9D%A2%E8%B7%AF%E5%BE%84%E5%AE%9A%E4%BD%8D"><span class="nav-text">XPath 页面路径定位</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Point-%E5%9D%90%E6%A0%87%E7%82%B9%E5%AE%9A%E4%BD%8D"><span class="nav-text">Point 坐标点定位</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Region-%E5%B1%8F%E5%B9%95%E5%8C%BA%E5%9F%9F%E5%AE%9A%E4%BD%8D"><span class="nav-text">Region 屏幕区域定位</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Image-%E5%9B%BE%E5%83%8F%E5%AE%9A%E4%BD%8D"><span class="nav-text">Image 图像定位</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Live-mode-%E7%94%A8%E4%BA%8E%E8%B0%83%E8%AF%95%E7%9A%84Live%E6%A8%A1%E5%BC%8F"><span class="nav-text">Live mode 用于调试的Live模式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#If-%E6%9D%A1%E4%BB%B6%E8%AF%AD%E5%8F%A5"><span class="nav-text">If 条件语句</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#For-%E5%BE%AA%E7%8E%AF"><span class="nav-text">For 循环</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#functions-%E5%87%BD%E6%95%B0"><span class="nav-text">functions 函数</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#csv-row"><span class="nav-text">csv_row()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#clipboard-%E5%89%AA%E8%B4%B4%E6%9D%BF"><span class="nav-text">clipboard() 剪贴板</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#mouse-x-mouse-y-%E8%8E%B7%E5%BE%97%E5%9D%90%E6%A0%87%E7%82%B9%E5%BD%93%E5%89%8D%E4%BD%8D%E7%BD%AE"><span class="nav-text">mouse_x(), mouse_y() 获得坐标点当前位置</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#mouse-xy"><span class="nav-text">mouse_xy()</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%AB%98%E7%BA%A7%E5%91%BD%E4%BB%A4"><span class="nav-text">高级命令</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BF%9D%E5%AD%98%E6%B5%81%E7%A8%8B%E8%BF%90%E8%A1%8C%E7%BB%93%E6%9E%9C"><span class="nav-text">保存流程运行结果</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%84%E7%90%86%E5%BC%82%E5%B8%B8%E5%92%8C%E9%94%99%E8%AF%AF"><span class="nav-text">处理异常和错误</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#DataTables%E6%95%B0%E6%8D%AE%E8%A1%A8%E6%A0%BC%E6%89%B9%E9%87%8F%E8%87%AA%E5%8A%A8%E5%8C%96"><span class="nav-text">DataTables数据表格批量自动化</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8F%AF%E9%87%8D%E7%94%A8%E6%80%A7%E7%9A%84%E5%AF%B9%E8%B1%A1%E5%AD%98%E5%82%A8%E5%BA%93"><span class="nav-text">可重用性的对象存储库</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%B0%83%E7%94%A8%E6%B5%81%E7%A8%8B"><span class="nav-text">调用流程</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Turbo-mode-%E6%9E%81%E9%80%9F%E6%A8%A1%E5%BC%8F%EF%BC%8C10%E5%80%8D%E9%80%9F%E8%BF%90%E8%A1%8C"><span class="nav-text">Turbo mode 极速模式，10倍速运行</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%A7%86%E8%A7%89%E8%87%AA%E5%8A%A8%E5%8C%96-OCR"><span class="nav-text">视觉自动化 OCR</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9C%A8%E6%B5%81%E7%A8%8B%E4%B8%AD%E7%BC%96%E5%86%99Python"><span class="nav-text">在流程中编写Python</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E8%BF%90%E8%A1%8CLog%E6%97%A5%E5%BF%97%E4%BE%BF%E4%BA%8E%E8%B0%83%E8%AF%95"><span class="nav-text">创建运行Log日志便于调试</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BF%90%E8%A1%8C%E4%BA%91%E7%AB%AF-TagUI"><span class="nav-text">运行云端 TagUI</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%91%BD%E4%BB%A4%E6%89%8B%E5%86%8C"><span class="nav-text">命令手册</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B5%81%E7%A8%8B%E5%91%BD%E4%BB%A4"><span class="nav-text">流程命令</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%BC%A0%E6%A0%87%E5%92%8C%E9%94%AE%E7%9B%98%E5%91%BD%E4%BB%A4"><span class="nav-text">鼠标和键盘命令</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#click-%E5%8D%95%E5%87%BB"><span class="nav-text">click 单击</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#rclick-%E5%8F%B3%E9%94%AE%E5%8D%95%E5%87%BB"><span class="nav-text">rclick 右键单击</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#dclick-%E5%8F%8C%E5%87%BB"><span class="nav-text">dclick 双击</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#hover-%E9%BC%A0%E6%A0%87%E7%A7%BB%E5%8A%A8"><span class="nav-text">hover 鼠标移动</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#type-%E8%BE%93%E5%85%A5"><span class="nav-text">type 输入</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#keyboard-%E6%8C%89%E9%94%AE-%E6%8C%89%E7%BB%84%E5%90%88%E9%94%AE"><span class="nav-text">keyboard 按键&#x2F;按组合键</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#mouse-%E9%BC%A0%E6%A0%87"><span class="nav-text">mouse 鼠标</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Web-%E7%BD%91%E9%A1%B5%E7%AB%AF%E5%91%BD%E4%BB%A4"><span class="nav-text">Web 网页端命令</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#visit-%E6%89%93%E5%BC%80%E7%BD%91%E7%AB%99-url"><span class="nav-text">visit 打开网站&#x2F;url</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#select-%E4%B8%8B%E6%8B%89%E9%80%89%E6%8B%A9"><span class="nav-text">select 下拉选择</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#table-%E4%BF%9D%E5%AD%98%E8%A1%A8%E6%A0%BC%E6%95%B0%E6%8D%AE"><span class="nav-text">table 保存表格数据</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#popup-%E6%8A%8A%E4%B8%8B%E4%B8%80%E6%AD%A5%E6%93%8D%E4%BD%9C%E6%94%BE%E5%88%B0%E6%96%B0%E6%A0%87%E7%AD%BE%E9%A1%B5"><span class="nav-text">popup 把下一步操作放到新标签页</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#frame-%E9%92%88%E5%AF%B9%E6%9F%90%E4%BA%9B%E6%A1%86%E6%9E%B6%E6%93%8D%E4%BD%9C"><span class="nav-text">frame 针对某些框架操作</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#download-to"><span class="nav-text">download to</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#upload"><span class="nav-text">upload</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#api"><span class="nav-text">api</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Excel"><span class="nav-text">Excel</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%AF%BB%E5%8F%96%E4%B8%AD%E6%96%87%E9%85%8D%E7%BD%AE"><span class="nav-text">读取中文配置</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#variables-%E5%8F%98%E9%87%8F"><span class="nav-text">variables 变量</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#visibility-%E6%98%AF%E5%90%A6%E8%AE%A9Excel%E6%93%8D%E4%BD%9C%E5%8F%AF%E8%A7%81"><span class="nav-text">visibility 是否让Excel操作可见</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%AF%BB%E5%8F%96Excel"><span class="nav-text">读取Excel</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%86%99%E5%85%A5Excel"><span class="nav-text">写入Excel</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#copy-%E5%A4%8D%E5%88%B6"><span class="nav-text">copy 复制</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#delete-%E5%88%A0%E9%99%A4"><span class="nav-text">delete 删除</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Word"><span class="nav-text">Word</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#PDF"><span class="nav-text">PDF</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Using-variables-%E4%BD%BF%E7%94%A8%E5%8F%98%E9%87%8F"><span class="nav-text">Using variables 使用变量</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#read-%E8%AF%BB%E5%8F%96%E7%9B%AE%E6%A0%87%E5%86%85%E5%AE%B9%E6%94%BE%E5%85%A5%E5%8F%98%E9%87%8F"><span class="nav-text">read 读取目标内容放入变量</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%8F%98%E9%87%8F%E8%B5%8B%E5%80%BC"><span class="nav-text">变量赋值</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#File-saving-loading-%E6%96%87%E4%BB%B6%E4%BF%9D%E5%AD%98%E5%92%8C%E8%AF%BB%E5%8F%96"><span class="nav-text">File saving&#x2F;loading 文件保存和读取</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#dump-%E6%96%87%E6%9C%AC%E4%BF%9D%E5%AD%98%E5%88%B0%E6%96%87%E4%BB%B6"><span class="nav-text">dump 文本保存到文件</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#write-%E8%BF%BD%E5%8A%A0%E5%86%99%E5%85%A5"><span class="nav-text">write 追加写入</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#load-%E8%AF%BB%E5%8F%96"><span class="nav-text">load 读取</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#snap-%E6%88%AA%E5%B1%8F"><span class="nav-text">snap 截屏</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%98%BE%E7%A4%BA%E8%BE%93%E5%87%BA"><span class="nav-text">显示输出</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#echo-%E4%BF%A1%E6%81%AF%E8%BE%93%E5%87%BA"><span class="nav-text">echo 信息输出</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#show-%E6%98%BE%E7%A4%BA%E5%85%83%E7%B4%A0%E6%96%87%E6%9C%AC"><span class="nav-text">show 显示元素文本</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#check-%E6%A0%B9%E6%8D%AE%E6%9D%A1%E4%BB%B6%E6%98%BE%E7%A4%BA%E6%96%87%E6%9C%AC"><span class="nav-text">check 根据条件显示文本</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Custom-code-%E8%87%AA%E5%AE%9A%E4%B9%89%E4%BB%A3%E7%A0%81"><span class="nav-text">Custom code 自定义代码</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#JavaScript"><span class="nav-text">JavaScript</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Python"><span class="nav-text">Python</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#RUN"><span class="nav-text">RUN</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Sikuli"><span class="nav-text">Sikuli</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#DOM"><span class="nav-text">DOM</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#R"><span class="nav-text">R</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9B%B4%E5%A4%9A%E5%91%BD%E4%BB%A4"><span class="nav-text">更多命令</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#wait-%E7%AD%89%E5%BE%85"><span class="nav-text">wait 等待</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#timeout-%E8%AE%BE%E7%BD%AE%E7%AD%89%E5%BE%85%E8%B6%85%E6%97%B6"><span class="nav-text">timeout 设置等待超时</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#ask"><span class="nav-text">ask</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#live"><span class="nav-text">live</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#tagui-%E8%B0%83%E7%94%A8%E6%B5%81%E7%A8%8B"><span class="nav-text">tagui 调用流程</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%B7%BB%E5%8A%A0%E6%B3%A8%E9%87%8A"><span class="nav-text">&#x2F;&#x2F; 添加注释</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Telegram"><span class="nav-text">Telegram</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Run-options-%E8%BF%90%E8%A1%8C%E6%B5%81%E7%A8%8B%E9%80%89%E9%A1%B9"><span class="nav-text">Run options 运行流程选项</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#deploy-or-d-%E7%94%9F%E4%BA%A7CMD%E5%BF%AB%E6%8D%B7%E6%96%B9%E5%BC%8F"><span class="nav-text">-deploy or -d 生产CMD快捷方式</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#headless-or-h-%E9%9A%90%E8%97%8F%E6%B5%8F%E8%A7%88%E5%99%A8"><span class="nav-text">-headless or -h 隐藏浏览器</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#nobrowser-or-n-%E4%B8%8D%E4%BD%BF%E7%94%A8Web%E6%B5%8F%E8%A7%88%E5%99%A8"><span class="nav-text">-nobrowser or -n 不使用Web浏览器</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#report-or-r-%E4%BF%9D%E5%AD%98HTML%E6%97%A5%E5%BF%97"><span class="nav-text">-report or -r 保存HTML日志</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#turbo-or-t-%E5%8D%81%E5%80%8D%E9%80%9F%E8%BF%90%E8%A1%8C"><span class="nav-text">-turbo or -t 十倍速运行</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#quiet-or-q-%E5%87%8F%E5%B0%91%E9%9D%9E%E4%B8%BB%E5%8A%A8%E4%BF%A1%E6%81%AF%E8%BE%93%E5%87%BA"><span class="nav-text">-quiet or -q 减少非主动信息输出</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#edge-or-e-%E4%BD%BF%E7%94%A8Edge%E6%B5%8F%E8%A7%88%E5%99%A8"><span class="nav-text">-edge or -e 使用Edge浏览器</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#my-datatable-csv"><span class="nav-text">my_datatable.csv</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#input-s-%E6%B5%81%E7%A8%8B%E5%8F%82%E6%95%B0"><span class="nav-text">input(s) 流程参数</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BE%85%E5%8A%A9%E5%87%BD%E6%95%B0"><span class="nav-text">辅助函数</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#csv-row-1"><span class="nav-text">csv_row()</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#count-%E6%95%B0%E9%87%8F%E8%AE%A1%E7%AE%97"><span class="nav-text">count() 数量计算</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#clipboard-%E5%89%AA%E8%B4%B4%E6%9D%BF-1"><span class="nav-text">clipboard() 剪贴板</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#url-%E8%8E%B7%E5%8F%96%E5%BD%93%E5%89%8DURL"><span class="nav-text">url() 获取当前URL</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#title-%E8%8E%B7%E5%8F%96%E5%BD%93%E5%89%8D%E7%BD%91%E9%A1%B5%E6%A0%87%E9%A2%98%E3%80%82"><span class="nav-text">title() 获取当前网页标题。</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#text"><span class="nav-text">text()</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#timer"><span class="nav-text">timer()</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#exist-%E7%AD%89%E5%BE%85%E5%85%83%E7%B4%A0%E5%87%BA%E7%8E%B0"><span class="nav-text">exist() 等待元素出现</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#present-%E5%88%A4%E6%96%AD%E5%85%83%E7%B4%A0%E6%98%AF%E5%90%A6%E5%AD%98%E5%9C%A8"><span class="nav-text">present() 判断元素是否存在</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#mouse-xy-1"><span class="nav-text">mouse_xy()</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#mouse-x"><span class="nav-text">mouse_x()</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#mouse-y"><span class="nav-text">mouse_y()</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#get-files"><span class="nav-text">get_files()</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#get-text-%E6%88%AA%E5%8F%96%E6%96%87%E6%9C%AC"><span class="nav-text">get_text() 截取文本</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#del-chars-%E5%88%A0%E9%99%A4%E6%96%87%E6%9C%AC"><span class="nav-text">del_chars() 删除文本</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#get-env-%E8%8E%B7%E5%BE%97%E5%BD%93%E5%89%8D%E7%94%A8%E6%88%B7%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F"><span class="nav-text">get_env() 获得当前用户环境变量</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#RPA-for-Python-TagUI-%E5%9C%A8-Python-%E9%87%8C%E4%BD%BF%E7%94%A8"><span class="nav-text">RPA for Python (TagUI 在 Python 里使用)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#TagUI-%E6%BA%90%E4%BB%A3%E7%A0%81%E7%9A%84%E5%92%8C%E4%BE%9D%E8%B5%96%E5%BA%93"><span class="nav-text">TagUI 源代码的和依赖库</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%A4%BA%E4%BE%8B%E4%BB%A3%E7%A0%81%E5%9D%97"><span class="nav-text">示例代码块</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AC%AC%E4%B8%80%E4%B8%AA%E4%BE%8B%E5%AD%90"><span class="nav-text">第一个例子</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8A%8Acmd%E8%AE%BE%E7%BD%AE%E6%88%90UTF-8"><span class="nav-text">把cmd设置成UTF-8</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%9F%A5%E6%89%BE%E6%9B%BF%E6%8D%A2"><span class="nav-text">字符串查找替换</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9F%A5%E6%89%BE%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%9B%AE%E6%A0%87%E6%96%87%E5%AD%97%E4%BD%8D%E7%BD%AE"><span class="nav-text">查找字符串目标文字位置</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%8B%E8%BD%BD%E5%9B%BE%E7%89%87"><span class="nav-text">下载图片</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#download-%E5%91%BD%E4%BB%A4%E7%9A%84%E4%BD%BF%E7%94%A8%E4%BE%8B%E5%AD%90"><span class="nav-text">download 命令的使用例子</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#API-%E4%BE%8B%E5%AD%90"><span class="nav-text">API 例子</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8A%93%E5%8F%96%E7%99%BE%E5%BA%A6%E9%A6%96%E9%A1%B5%E6%96%B0%E9%97%BB%E6%A0%87%E9%A2%98"><span class="nav-text">抓取百度首页新闻标题</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%A4%E6%96%AD%E7%9B%AE%E5%BD%95%E5%86%85%E6%98%AF%E5%90%A6%E5%8C%85%E5%90%AB%E6%8C%87%E5%AE%9A%E6%89%A9%E5%B1%95%E5%90%8D%E6%96%87%E4%BB%B6"><span class="nav-text">判断目录内是否包含指定扩展名文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%A4%E6%96%ADchrome%E6%98%AF%E5%90%A6%E4%B8%8B%E8%BD%BD%E5%AE%8C%E6%88%90"><span class="nav-text">判断chrome是否下载完成</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%AF%BB%E5%8F%96excel%EF%BC%8C%E5%86%99%E5%85%A5txt"><span class="nav-text">读取excel，写入txt</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%89%93%E5%BC%80%E5%8F%98%E9%87%8F%E9%87%8C%E7%9A%84URL"><span class="nav-text">打开变量里的URL</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%8E%AF%E5%A2%83%E5%88%9D%E5%A7%8B%E5%8C%96"><span class="nav-text">环境初始化</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%8E%B7%E5%BE%97%E6%9C%AC%E6%9C%BA%E5%90%8D"><span class="nav-text">获得本机名</span></a></li></ol></li></ol>

    </div>
</div>
        </div>
    
</div>



                

            </div>

            

        </div>

        <div class="main-content-footer">
            <footer class="footer mt-5 py-5 h-auto text-base text-third-text-color relative border-t-2 border-t-border-color">
    <div class="info-container py-3 text-center">
        
        <div class="text-center">
            &copy;
            
              <span>2018</span>
              -
            
            2024&nbsp;&nbsp;<i class="fa-solid fa-cog fa-spin" style="--fa-animation-duration: 5s"></i>&nbsp;&nbsp;<a href="/">Yiuhang Chan</a>
            
                
                <p class="post-count space-x-0.5">
                    <span>
                        共 41 篇文章
                    </span>
                    
                        <span>
                            共 453.8k 字
                        </span>
                    
                </p>
            
        </div>
        
            <script data-swup-reload-script src="https://cn.vercount.one/js"></script>
            <div class="relative text-center lg:absolute lg:right-[20px] lg:top-1/2 lg:-translate-y-1/2 lg:text-right">
                
                    <span id="busuanzi_container_site_uv" class="lg:!block">
                        <span class="text-sm">访问人数</span>
                        <span id="busuanzi_value_site_uv"></span>
                    </span>
                
                
                    <span id="busuanzi_container_site_pv" class="lg:!block">
                        <span class="text-sm">总访问量</span>
                        <span id="busuanzi_value_site_pv"></span>
                    </span>
                
            </div>
        
        <div class="relative text-center lg:absolute lg:left-[20px] lg:top-1/2 lg:-translate-y-1/2 lg:text-left">
            <span class="lg:block text-sm">由 <?xml version="1.0" encoding="utf-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg class="relative top-[2px] inline-block align-baseline" version="1.1" id="圖層_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="1rem" height="1rem" viewBox="0 0 512 512" enable-background="new 0 0 512 512" xml:space="preserve"><path fill="#0E83CD" d="M256.4,25.8l-200,115.5L56,371.5l199.6,114.7l200-115.5l0.4-230.2L256.4,25.8z M349,354.6l-18.4,10.7l-18.6-11V275H200v79.6l-18.4,10.7l-18.6-11v-197l18.5-10.6l18.5,10.8V237h112v-79.6l18.5-10.6l18.5,10.8V354.6z"/></svg><a target="_blank" class="text-base" href="https://hexo.io">Hexo</a> 驱动</span>
            <span class="text-sm lg:block">主题&nbsp;<a class="text-base" target="_blank" href="https://github.com/EvanNotFound/hexo-theme-redefine">Redefine v2.6.1</a></span>
        </div>
        
        
            <div>
                博客已运行 <span class="odometer" id="runtime_days" ></span> 天 <span class="odometer" id="runtime_hours"></span> 小时 <span class="odometer" id="runtime_minutes"></span> 分钟 <span class="odometer" id="runtime_seconds"></span> 秒
            </div>
        
        
            <script data-swup-reload-script>
                try {
                    function odometer_init() {
                    const elements = document.querySelectorAll('.odometer');
                    elements.forEach(el => {
                        new Odometer({
                            el,
                            format: '( ddd).dd',
                            duration: 200
                        });
                    });
                    }
                    odometer_init();
                } catch (error) {}
            </script>
        
        
        
    </div>  
</footer>
        </div>
    </div>

    
        <div class="post-tools">
            <div class="post-tools-container">
    <ul class="article-tools-list">
        <!-- TOC aside toggle -->
        
            <li class="right-bottom-tools page-aside-toggle">
                <i class="fa-regular fa-outdent"></i>
            </li>
        

        <!-- go comment -->
        
            <li class="go-comment">
                <i class="fa-regular fa-comments"></i>
            </li>
        
    </ul>
</div>

        </div>
    

    <div class="right-side-tools-container">
        <div class="side-tools-container">
    <ul class="hidden-tools-list">
        <li class="right-bottom-tools tool-font-adjust-plus flex justify-center items-center">
            <i class="fa-regular fa-magnifying-glass-plus"></i>
        </li>

        <li class="right-bottom-tools tool-font-adjust-minus flex justify-center items-center">
            <i class="fa-regular fa-magnifying-glass-minus"></i>
        </li>

        <li class="right-bottom-tools tool-dark-light-toggle flex justify-center items-center">
            <i class="fa-regular fa-moon"></i>
        </li>

        <!-- rss -->
        
            <li class="right-bottom-tools rss flex justify-center items-center">
                <a class="flex justify-center items-center"
                   href="/atom.xml"
                   target="_blank"
                >
                <i class="fa-regular fa-rss"></i>
                </a>
            </li>
        

        

        <li class="right-bottom-tools tool-scroll-to-bottom flex justify-center items-center">
            <i class="fa-regular fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="visible-tools-list">
        <li class="right-bottom-tools toggle-tools-list flex justify-center items-center">
            <i class="fa-regular fa-cog fa-spin"></i>
        </li>
        
            <li class="right-bottom-tools tool-scroll-to-top flex justify-center items-center">
                <i class="arrow-up fas fa-arrow-up"></i>
                <span class="percent"></span>
            </li>
        
        
    </ul>
</div>

    </div>

    <div class="image-viewer-container">
    <img src="">
</div>


    
        <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
          <span class="search-input-field-pre">
            <i class="fa-solid fa-keyboard"></i>
          </span>
            <div class="search-input-container">
                <input autocomplete="off"
                       autocorrect="off"
                       autocapitalize="off"
                       placeholder="搜索..."
                       spellcheck="false"
                       type="search"
                       class="search-input"
                >
            </div>
            <span class="popup-btn-close">
                <i class="fa-solid fa-times"></i>
            </span>
        </div>
        <div id="search-result">
            <div id="no-result">
                <i class="fa-solid fa-spinner fa-spin-pulse fa-5x fa-fw"></i>
            </div>
        </div>
    </div>
</div>

    

</main>


    
<script src="/js/libs/Swup.min.js"></script>

<script src="/js/libs/SwupSlideTheme.min.js"></script>

<script src="/js/libs/SwupScriptsPlugin.min.js"></script>

<script src="/js/libs/SwupProgressPlugin.min.js"></script>

<script src="/js/libs/SwupScrollPlugin.min.js"></script>

<script src="/js/libs/SwupPreloadPlugin.min.js"></script>

<script>
    const swup = new Swup({
        plugins: [
            new SwupScriptsPlugin({
                optin: true,
            }),
            new SwupProgressPlugin(),
            new SwupScrollPlugin({
                offset: 80,
            }),
            new SwupSlideTheme({
                mainElement: ".main-content-body",
            }),
            new SwupPreloadPlugin(),
        ],
        containers: ["#swup"],
    });
</script>







<script src="/js/tools/imageViewer.js" type="module"></script>

<script src="/js/utils.js" type="module"></script>

<script src="/js/main.js" type="module"></script>

<script src="/js/layouts/navbarShrink.js" type="module"></script>

<script src="/js/tools/scrollTopBottom.js" type="module"></script>

<script src="/js/tools/lightDarkSwitch.js" type="module"></script>

<script src="/js/layouts/categoryList.js" type="module"></script>



    
<script src="/js/tools/localSearch.js" type="module"></script>




    
<script src="/js/tools/codeBlock.js" type="module"></script>




    
<script src="/js/layouts/lazyload.js" type="module"></script>




    
<script src="/js/tools/runtime.js"></script>

    
<script src="/js/libs/odometer.min.js"></script>

    
<link rel="stylesheet" href="/assets/odometer-theme-minimal.css">




  
<script src="/js/libs/Typed.min.js"></script>

  
<script src="/js/plugins/typed.js" type="module"></script>




    
<script src="/js/libs/mermaid.min.js"></script>

    
<script src="/js/plugins/mermaid.js"></script>







<div class="post-scripts" data-swup-reload-script>
    
        
<script src="/js/tools/tocToggle.js" type="module"></script>

<script src="/js/layouts/toc.js" type="module"></script>

<script src="/js/plugins/tabs.js" type="module"></script>

    
</div>


</body>
</html>
