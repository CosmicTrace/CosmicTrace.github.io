<!DOCTYPE html>
<html lang="zh-CN,en,zh-TW,default">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="keywords" content="Hexo Theme Redefine">
    
    <meta name="author" content="Yiuhang Chan">
    <!-- preconnect -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

    
    <!--- Seo Part-->
    
    <link rel="canonical" href="https://www.yiuhangblog.com/2018/11/12/20181112pandas/"/>
    <meta name="robots" content="index,follow">
    <meta name="googlebot" content="index,follow">
    <meta name="revisit-after" content="1 days">
    
        <meta name="description" content="Python Pandas包">
<meta property="og:type" content="article">
<meta property="og:title" content="Pandas">
<meta property="og:url" content="https://www.yiuhangblog.com/2018/11/12/20181112Pandas/index.html">
<meta property="og:site_name" content="角灯随笔">
<meta property="og:description" content="Python Pandas包">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://imagedelivery.net/sodhLvOXTBoeXxRe03g_RA/83d8b41c-07d4-46c2-2877-c9aa0d0cd900/public">
<meta property="og:image" content="https://imagedelivery.net/sodhLvOXTBoeXxRe03g_RA/7d5c4497-e90c-4da1-278e-f54017a56e00/public">
<meta property="og:image" content="https://imagedelivery.net/sodhLvOXTBoeXxRe03g_RA/ae4b4a6a-7f4f-43d1-e3cf-dce673bb6b00/public">
<meta property="og:image" content="https://imagedelivery.net/sodhLvOXTBoeXxRe03g_RA/a2a0b9b7-41e3-46d5-c053-28aedaf97700/public">
<meta property="og:image" content="https://imagedelivery.net/sodhLvOXTBoeXxRe03g_RA/caa0bb9f-5fdd-40af-1d11-5e3504552400/public">
<meta property="og:image" content="https://imagedelivery.net/sodhLvOXTBoeXxRe03g_RA/ff43ed8b-8cda-46d5-ff98-a024e0ab2f00/public">
<meta property="og:image" content="https://imagedelivery.net/sodhLvOXTBoeXxRe03g_RA/d49d14b3-820f-4017-8cc2-4e6bd2386900/public">
<meta property="og:image" content="https://imagedelivery.net/sodhLvOXTBoeXxRe03g_RA/28770c41-d7cb-41a0-58ca-2021fd057f00/public">
<meta property="og:image" content="https://imagedelivery.net/sodhLvOXTBoeXxRe03g_RA/b50c5bd9-d858-46e2-7719-ff6243beea00/public">
<meta property="og:image" content="https://imagedelivery.net/sodhLvOXTBoeXxRe03g_RA/98784bcb-e940-4dd4-446e-357c71cbf700/public">
<meta property="og:image" content="https://imagedelivery.net/sodhLvOXTBoeXxRe03g_RA/a54d21ce-1686-4feb-7e8b-b8b1f0d85000/public">
<meta property="og:image" content="https://imagedelivery.net/sodhLvOXTBoeXxRe03g_RA/3619a44d-5c76-4152-24be-518f9b4eb400/public">
<meta property="og:image" content="https://imagedelivery.net/sodhLvOXTBoeXxRe03g_RA/3f978462-5366-4c4e-0c9a-5b8eed105000/public">
<meta property="og:image" content="https://imagedelivery.net/sodhLvOXTBoeXxRe03g_RA/6e9032a0-eac0-4cb0-22f1-aade19634000/public">
<meta property="og:image" content="https://imagedelivery.net/sodhLvOXTBoeXxRe03g_RA/288019bf-0614-443b-af05-cadf7e3ba800/public">
<meta property="article:published_time" content="2018-11-12T02:23:47.000Z">
<meta property="article:modified_time" content="2024-03-19T09:53:53.000Z">
<meta property="article:author" content="Yiuhang Chan">
<meta property="article:tag" content="基础">
<meta property="article:tag" content="理论">
<meta property="article:tag" content="数据分析">
<meta property="article:tag" content="Pandas">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://imagedelivery.net/sodhLvOXTBoeXxRe03g_RA/83d8b41c-07d4-46c2-2877-c9aa0d0cd900/public">
    
    
        <!-- Google tag (gtag.js) -->
        <script src="https://www.googletagmanager.com/gtag/js?id=G-MQ43G0NKCT"></script>
        <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-MQ43G0NKCT');
        </script>
    
    <!--- Icon Part-->
    <link rel="icon" type="image/png" href="https://imagedelivery.net/sodhLvOXTBoeXxRe03g_RA/e75f26bb-7787-428d-ec58-214a6faf9800/public" sizes="192x192">
    <link rel="apple-touch-icon" sizes="180x180" href="https://imagedelivery.net/sodhLvOXTBoeXxRe03g_RA/e75f26bb-7787-428d-ec58-214a6faf9800/public">
    <meta name="theme-color" content="#A1AFC9">
    <link rel="shortcut icon" href="https://imagedelivery.net/sodhLvOXTBoeXxRe03g_RA/e75f26bb-7787-428d-ec58-214a6faf9800/public">
    <!--- Page Info-->
    
    <title>
        
            Pandas -
        
        角灯随笔
    </title>

    
<link rel="stylesheet" href="/fonts/Chillax/chillax.css">


    <!--- Inject Part-->
    

    
        <style>
    :root {
        --preloader-background-color: #fff;
        --preloader-text-color: #000;
    }

    @media (prefers-color-scheme: dark) {
        :root {
            --preloader-background-color: #202124;
            --preloader-text-color: #fff;
        }
    }

    @media (prefers-color-scheme: light) {
        :root {
            --preloader-background-color: #fff;
            --preloader-text-color: #000;
        }
    }

    @media (max-width: 600px) {
        .ml13 {
            font-size: 2.6rem !important; /* Adjust this value as needed */
        }
    }

    .preloader {
        display: flex;
        flex-direction: column;
        gap: 1rem; /* Tailwind 'gap-4' is 1rem */
        align-items: center;
        justify-content: center;
        position: fixed;
        padding: 12px;
        top: 0;
        right: 0;
        bottom: 0;
        left: 0;
        width: 100vw;
        height: 100vh; /* 'h-screen' is 100% of the viewport height */
        background-color: var(--preloader-background-color);
        z-index: 1100; /* 'z-[1100]' sets the z-index */
        transition: opacity 0.2s ease-in-out;
    }

    .ml13 {
        font-size: 3.2rem;
        /* text-transform: uppercase; */
        color: var(--preloader-text-color);
        letter-spacing: -1px;
        font-weight: 500;
        font-family: 'Chillax-Variable', sans-serif;
        text-align: center;
    }

    .ml13 .word {
        display: inline-flex;
        flex-wrap: wrap;
        white-space: nowrap;
    }

    .ml13 .letter {
        display: inline-block;
        line-height: 1em;
    }
</style>

<div class="preloader">
    
<script src="/js/libs/anime.min.js"></script>

    <h1 class="ml13">
        角灯随笔
    </h1>
    <script>
        var textWrapper = document.querySelector('.ml13');
        // Split text into words
        var words = textWrapper.textContent.trim().split(' ');

        // Clear the existing content
        textWrapper.innerHTML = '';

        // Wrap each word and its letters in spans
        words.forEach(function(word) {
            var wordSpan = document.createElement('span');
            wordSpan.classList.add('word');
            wordSpan.innerHTML = word.replace(/\S/g, "<span class='letter'>$&</span>");
            textWrapper.appendChild(wordSpan);
            textWrapper.appendChild(document.createTextNode(' ')); // Add space between words
        });


        anime.timeline({loop: true})
            .add({
                targets: '.ml13 .letter',
                translateY: [100,0],
                translateZ: 0,
                opacity: [0,1],
                easing: "easeOutExpo",
                duration: 1400,
                delay: (el, i) => 300 + 30 * i
            }).add({
            targets: '.ml13 .letter',
            translateY: [0,-100],
            opacity: [1,0],
            easing: "easeInExpo",
            duration: 1200,
            delay: (el, i) => 100 + 30 * i
        });

        let themeStatus = JSON.parse(localStorage.getItem('REDEFINE-THEME-STATUS'))?.isDark;

        // If the theme status is not found in local storage, check the preferred color scheme
        if (themeStatus === undefined || themeStatus === null) {
            if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                themeStatus = 'dark';
            } else {
                themeStatus = 'light';
            }
        }

        // Now you can use the themeStatus variable in your code
        if (themeStatus) {
            document.documentElement.style.setProperty('--preloader-background-color', '#202124');
            document.documentElement.style.setProperty('--preloader-text-color', '#fff');
        } else {
            document.documentElement.style.setProperty('--preloader-background-color', '#fff');
            document.documentElement.style.setProperty('--preloader-text-color', '#000');
        }

        window.addEventListener('load', function () {
            hidePreloaderAfterTimeout(1000); // Hide after 1000 milliseconds once the window has loaded
        });

        // Backup failsafe: Hide preloader after a maximum of 5000 milliseconds, regardless of the window load event
        hidePreloaderAfterTimeout(5000);

        function hidePreloaderAfterTimeout(delay) {
            setTimeout(function () {
                var preloader = document.querySelector('.preloader');
                preloader.style.opacity = '0';
                setTimeout(function () {
                    preloader.style.display = 'none';
                }, 200);
            }, delay);
        }
    </script>
</div>
    

    
<link rel="stylesheet" href="/css/style.css">


    
        
<link rel="stylesheet" href="/assets/build/styles.css">

    

    
<link rel="stylesheet" href="/fonts/fonts.css">

    
<link rel="stylesheet" href="/fonts/Satoshi/satoshi.css">

    <!--- Font Part-->
    
    
    
    


    <script id="hexo-configurations">
    window.config = {"hostname":"www.yiuhangblog.com","root":"/","language":["zh-CN","en","zh-TW","default"]};
    window.theme = {"articles":{"style":{"font_size":"16px","line_height":1.5,"image_border_radius":"14px","image_alignment":"center","image_caption":false,"link_icon":true,"title_alignment":"left","headings_top_spacing":{"h1":"5rem","h2":"4rem","h3":"2.8rem","h4":"2.5rem","h5":"2.2rem","h6":"2rem"}},"word_count":{"enable":true,"count":true,"min2read":true},"author_label":{"enable":false,"auto":false,"list":[]},"code_block":{"copy":true,"style":"mac","font":{"enable":false,"family":null,"url":null}},"toc":{"enable":true,"max_depth":6,"number":false,"expand":true,"init_open":true},"copyright":{"enable":true,"default":"cc_by_nc_sa"},"lazyload":true,"recommendation":{"enable":false,"title":"推荐阅读","limit":5,"mobile_limit":2,"placeholder":"/images/wallhaven-wqery6-light.webp","skip_dirs":[]}},"colors":{"primary":"#A1AFC9","secondary":null,"default_mode":"light"},"global":{"fonts":{"chinese":{"enable":false,"family":null,"url":null},"english":{"enable":false,"family":null,"url":null}},"content_max_width":"1000px","sidebar_width":"210px","hover":{"shadow":true,"scale":true},"scroll_progress":{"bar":true,"percentage":true},"website_counter":{"url":"https://cn.vercount.one/js","enable":true,"site_pv":true,"site_uv":true,"post_pv":true},"single_page":true,"preloader":true,"open_graph":true,"google_analytics":{"enable":true,"id":"G-MQ43G0NKCT"}},"home_banner":{"enable":true,"style":"fixed","image":{"light":"https://imagedelivery.net/sodhLvOXTBoeXxRe03g_RA/e63fc400-dd0e-4395-bd1b-9ee1ac3bfb00/public","dark":"https://imagedelivery.net/sodhLvOXTBoeXxRe03g_RA/a34140d6-7960-45dd-b8b5-c3ddd14d1f00/public"},"title":"角灯随笔","subtitle":{"text":["全栈也不是不行"],"hitokoto":{"enable":false,"api":"https://v1.hitokoto.cn"},"typing_speed":100,"backing_speed":80,"starting_delay":500,"backing_delay":1500,"loop":false,"smart_backspace":true},"text_color":{"light":"#fff","dark":"#d1d1b6"},"text_style":{"title_size":"2.8rem","subtitle_size":"1.5rem","line_height":1.2},"custom_font":{"enable":false,"family":null,"url":null},"social_links":{"enable":true,"style":"default","links":{"github":"https://github.com/CosmicTrace","instagram":null,"zhihu":null,"twitter":null,"email":"kenchansk0@gmail.com"},"qrs":null}},"plugins":{"feed":{"enable":true},"aplayer":{"enable":false,"type":"fixed","audios":[{"name":null,"artist":null,"url":null,"cover":null}]},"mermaid":{"enable":true,"version":"9.3.0"}},"version":"2.6.1","navbar":{"auto_hide":false,"color":{"left":"#f78736","right":"#367df7","transparency":35},"width":{"home":"1200px","pages":"1000px"},"links":{"Home":{"path":"/","icon":"fa-regular fa-house"},"Tags":{"icon":"fa-solid fa-tags","path":"/tags/"},"Categories":{"icon":"fa-solid fa-folder","path":"/categories/"},"Archives":{"path":"/archives","icon":"fa-regular fa-archive"},"娱乐":{"icon":"fa-solid fa-gamepad","submenus":{"王者荣耀":"/hok","守望先锋":"/ow","使命召唤":"/cod"}},"About":{"icon":"fa-regular fa-user","submenus":{"Me":"/about","Github":"https://github.com/CosmicTrace"}}},"search":{"enable":true,"preload":true}},"page_templates":{"friends_column":2,"tags_style":"blur"},"home":{"sidebar":{"enable":true,"position":"left","first_item":"menu","announcement":"谦逊","show_on_mobile":true,"links":null},"article_date_format":"auto","categories":{"enable":true,"limit":3},"tags":{"enable":true,"limit":8}},"footerStart":"2018/07/15 10:15:24"};
    window.lang_ago = {"second":"%s seconds ago","minute":"%s minutes ago","hour":"%s hours ago","day":"%s days ago","week":"%s weeks ago","month":"%s months ago","year":"%s years ago"};
    window.data = {"masonry":false};
  </script>
    
    <!--- Fontawesome Part-->
    
<link rel="stylesheet" href="/fontawesome/fontawesome.min.css">

    
<link rel="stylesheet" href="/fontawesome/brands.min.css">

    
<link rel="stylesheet" href="/fontawesome/solid.min.css">

    
<link rel="stylesheet" href="/fontawesome/regular.min.css">

    
    
    
    
<meta name="generator" content="Hexo 7.1.1"><link rel="alternate" href="/atom.xml" title="角灯随笔" type="application/atom+xml">
</head>


<body>
<div class="progress-bar-container">
    
        <span class="scroll-progress-bar"></span>
    

    
        <span class="pjax-progress-bar"></span>
<!--        <span class="swup-progress-icon">-->
<!--            <i class="fa-solid fa-circle-notch fa-spin"></i>-->
<!--        </span>-->
    
</div>


<main class="page-container" id="swup">

    

    <div class="main-content-container">


        <div class="main-content-header">
            <header class="navbar-container px-6 md:px-12">

    <div class="navbar-content ">
        <div class="left">
            
                <a class="logo-image" href="/">
                    <img src="https://imagedelivery.net/sodhLvOXTBoeXxRe03g_RA/e75f26bb-7787-428d-ec58-214a6faf9800/public">
                </a>
            
            <a class="logo-title" href="/">
                
                角灯随笔
                
            </a>
        </div>

        <div class="right">
            <!-- PC -->
            <div class="desktop">
                <ul class="navbar-list">
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class=""
                                   href="/"
                                        >
                                    <i class="fa-regular fa-house fa-fw"></i>
                                    首页
                                    
                                </a>

                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class=""
                                   href="/tags/"
                                        >
                                    <i class="fa-solid fa-tags fa-fw"></i>
                                    标签
                                    
                                </a>

                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class=""
                                   href="/categories/"
                                        >
                                    <i class="fa-solid fa-folder fa-fw"></i>
                                    分类
                                    
                                </a>

                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class=""
                                   href="/archives"
                                        >
                                    <i class="fa-regular fa-archive fa-fw"></i>
                                    归档
                                    
                                </a>

                                <!-- Submenu -->
                                
                            </li>
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class="has-dropdown"
                                   href="#"
                                        onClick=&#34;return false;&#34;>
                                    <i class="fa-solid fa-gamepad fa-fw"></i>
                                    娱乐
                                    <i class="fa-solid fa-chevron-down fa-fw"></i>
                                </a>

                                <!-- Submenu -->
                                
                                    <ul class="sub-menu">
                                        
                                            <li>
                                                <a href="/hok">
                                                    王者荣耀
                                                </a>
                                            </li>
                                        
                                            <li>
                                                <a href="/ow">
                                                    守望先锋
                                                </a>
                                            </li>
                                        
                                            <li>
                                                <a href="/cod">
                                                    使命召唤
                                                </a>
                                            </li>
                                        
                                    </ul>
                                
                            </li>
                    
                        
                            

                            <li class="navbar-item">
                                <!-- Menu -->
                                <a class="has-dropdown"
                                   href="#"
                                        onClick=&#34;return false;&#34;>
                                    <i class="fa-regular fa-user fa-fw"></i>
                                    关于
                                    <i class="fa-solid fa-chevron-down fa-fw"></i>
                                </a>

                                <!-- Submenu -->
                                
                                    <ul class="sub-menu">
                                        
                                            <li>
                                                <a href="/about">
                                                    ME
                                                </a>
                                            </li>
                                        
                                            <li>
                                                <a target="_blank" rel="noopener" href="https://github.com/CosmicTrace">
                                                    GITHUB
                                                </a>
                                            </li>
                                        
                                    </ul>
                                
                            </li>
                    
                    
                        <li class="navbar-item search search-popup-trigger">
                            <i class="fa-solid fa-magnifying-glass"></i>
                        </li>
                    
                </ul>
            </div>
            <!-- Mobile -->
            <div class="mobile">
                
                    <div class="icon-item search search-popup-trigger"><i class="fa-solid fa-magnifying-glass"></i>
                    </div>
                
                <div class="icon-item navbar-bar">
                    <div class="navbar-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Mobile sheet -->
    <div class="navbar-drawer h-screen w-full absolute top-0 left-0 bg-background-color flex flex-col justify-between">
        <ul class="drawer-navbar-list flex flex-col px-4 justify-center items-start">
            
                
                    

                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                           href="/"
                        >
                            <span>
                                首页
                            </span>
                            
                                <i class="fa-regular fa-house fa-sm fa-fw"></i>
                            
                        </a>
                        

                        
                    </li>
            
                
                    

                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                           href="/tags/"
                        >
                            <span>
                                标签
                            </span>
                            
                                <i class="fa-solid fa-tags fa-sm fa-fw"></i>
                            
                        </a>
                        

                        
                    </li>
            
                
                    

                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                           href="/categories/"
                        >
                            <span>
                                分类
                            </span>
                            
                                <i class="fa-solid fa-folder fa-sm fa-fw"></i>
                            
                        </a>
                        

                        
                    </li>
            
                
                    

                    <li class="drawer-navbar-item text-base my-1.5 flex flex-col w-full">
                        
                        <a class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                           href="/archives"
                        >
                            <span>
                                归档
                            </span>
                            
                                <i class="fa-regular fa-archive fa-sm fa-fw"></i>
                            
                        </a>
                        

                        
                    </li>
            
                
                    

                    <li class="drawer-navbar-item-sub text-base my-1.5 flex flex-col w-full">
                        
                        <div class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary cursor-pointer text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                             navbar-data-toggle="submenu-娱乐"
                        >
                            <span>
                                娱乐
                            </span>
                            
                                <i class="fa-solid fa-chevron-right fa-sm fa-fw transition-all"></i>
                            
                        </div>
                        

                        
                            <div class="flex-col items-start px-2 py-2 hidden" data-target="submenu-娱乐">
                                
                                    <div class="drawer-navbar-item text-base flex flex-col justify-center items-start hover:underline active:underline hover:underline-offset-1 rounded-3xl">
                                        <a class=" text-third-text-color text-xl"
                                           href="/hok">王者荣耀</a>
                                    </div>
                                
                                    <div class="drawer-navbar-item text-base flex flex-col justify-center items-start hover:underline active:underline hover:underline-offset-1 rounded-3xl">
                                        <a class=" text-third-text-color text-xl"
                                           href="/ow">守望先锋</a>
                                    </div>
                                
                                    <div class="drawer-navbar-item text-base flex flex-col justify-center items-start hover:underline active:underline hover:underline-offset-1 rounded-3xl">
                                        <a class=" text-third-text-color text-xl"
                                           href="/cod">使命召唤</a>
                                    </div>
                                
                            </div>
                        
                    </li>
            
                
                    

                    <li class="drawer-navbar-item-sub text-base my-1.5 flex flex-col w-full">
                        
                        <div class="py-1.5 px-2 flex flex-row items-center justify-between gap-1 hover:!text-primary active:!text-primary cursor-pointer text-2xl font-semibold group border-b border-border-color hover:border-primary w-full "
                             navbar-data-toggle="submenu-About"
                        >
                            <span>
                                关于
                            </span>
                            
                                <i class="fa-solid fa-chevron-right fa-sm fa-fw transition-all"></i>
                            
                        </div>
                        

                        
                            <div class="flex-col items-start px-2 py-2 hidden" data-target="submenu-About">
                                
                                    <div class="drawer-navbar-item text-base flex flex-col justify-center items-start hover:underline active:underline hover:underline-offset-1 rounded-3xl">
                                        <a class=" text-third-text-color text-xl"
                                           href="/about">ME</a>
                                    </div>
                                
                                    <div class="drawer-navbar-item text-base flex flex-col justify-center items-start hover:underline active:underline hover:underline-offset-1 rounded-3xl">
                                        <a class=" text-third-text-color text-xl"
                                           target="_blank" rel="noopener" href="https://github.com/CosmicTrace">GITHUB</a>
                                    </div>
                                
                            </div>
                        
                    </li>
            

            
            
        </ul>

        <div class="statistics flex justify-around my-2.5">
    <a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/tags">
        <div class="number text-2xl sm:text-xl text-second-text-color font-semibold">96</div>
        <div class="label text-third-text-color text-sm">标签</div>
    </a>
    <a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/categories">
        <div class="number text-2xl sm:text-xl text-second-text-color font-semibold">7</div>
        <div class="label text-third-text-color text-sm">分类</div>
    </a>
    <a class="item tag-count-item flex flex-col justify-center items-center w-20" href="/archives">
        <div class="number text-2xl sm:text-xl text-second-text-color font-semibold">41</div>
        <div class="label text-third-text-color text-sm">文章</div>
    </a>
</div>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="main-content-body">

            

            <div class="main-content">

                
                    <div class="post-page-container flex relative justify-between box-border w-full h-full">
    <div class="article-content-container">

        <div class="article-title relative w-full">
            
                
                
                <img src="https://imagedelivery.net/sodhLvOXTBoeXxRe03g_RA/bed72753-840e-4a8d-a169-6adb9c2ea300/public" alt="Pandas" class="w-full h-60 sm:h-72 md:h-80 object-cover sm:rounded-t-large dark:brightness-75"/>
                
                <div class="w-full flex items-center absolute bottom-0 justify-start">
                    <h1 class="article-title-cover text-center mx-6 my-6 text-second-text-color bg-background-color-transparent px-4 py-3 text-3xl sm:text-4xl md:text-5xl font-bold backdrop-blur-lg rounded-xl border border-border-color ">Pandas</h1>
                </div>
            
            </div>

        
            <div class="article-header flex flex-row gap-2 items-center px-2 sm:px-6 md:px-8">
                <div class="avatar w-[46px] h-[46px] flex-shrink-0 rounded-medium border border-border-color p-[1px]">
                    <img src="https://imagedelivery.net/sodhLvOXTBoeXxRe03g_RA/26329e9f-d1fb-4280-a0a5-754547bf8500/public">
                </div>
                <div class="info flex flex-col justify-between">
                    <div class="author flex items-center">
                        <span class="name text-default-text-color text-lg font-semibold">Yiuhang Chan</span>
                        
                    </div>
                    <div class="meta-info">
                        <div class="article-meta-info">
    <span class="article-date article-meta-item">
        <i class="fa-regular fa-pen-fancy"></i>&nbsp;
        <span class="desktop">2018-11-12 10:23:47</span>
        <span class="mobile">2018-11-12 10:23:47</span>
        <span class="hover-info">创建</span>
    </span>
    
        <span class="article-date article-meta-item">
            <i class="fa-regular fa-wrench"></i>&nbsp;
            <span class="desktop">2024-03-19 17:53:53</span>
            <span class="mobile">2024-03-19 17:53:53</span>
            <span class="hover-info">更新</span>
        </span>
    

    
        <span class="article-categories article-meta-item">
            <i class="fa-regular fa-folders"></i>&nbsp;
            <ul>
                
                
                    
                        
                        <li>
                            <a href="/categories/Python/">Python</a>&nbsp;
                        </li>
                    
                    
                
            </ul>
        </span>
    
    
        <span class="article-tags article-meta-item">
            <i class="fa-regular fa-tags"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/tags/%E5%9F%BA%E7%A1%80/">基础</a>&nbsp;
                    </li>
                
                    <li>
                        | <a href="/tags/%E7%90%86%E8%AE%BA/">理论</a>&nbsp;
                    </li>
                
                    <li>
                        | <a href="/tags/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/">数据分析</a>&nbsp;
                    </li>
                
                    <li>
                        | <a href="/tags/Pandas/">Pandas</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    

    
    
        <span class="article-wordcount article-meta-item">
            <i class="fa-regular fa-typewriter"></i>&nbsp;<span>26k 字</span>
        </span>
    
    
        <span class="article-min2read article-meta-item">
            <i class="fa-regular fa-clock"></i>&nbsp;<span>117 分钟</span>
        </span>
    
    
        <span class="article-pv article-meta-item">
            <i class="fa-regular fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span>
        </span>
    
</div>

                    </div>
                </div>
            </div>
        

        


        <div class="article-content markdown-body px-2 sm:px-6 md:px-8 pb-8">
            <h2 id="Pandas简介"><a href="#Pandas简介" class="headerlink" title="Pandas简介"></a>Pandas简介</h2><h3 id="文件的读取与数据创建"><a href="#文件的读取与数据创建" class="headerlink" title="文件的读取与数据创建"></a>文件的读取与数据创建</h3><h4 id="读取CSV文件"><a href="#读取CSV文件" class="headerlink" title="读取CSV文件"></a>读取CSV文件</h4><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="comment"># 读取CSV文件（基本）</span></span><br><span class="line">df = pd.read_csv(</span><br><span class="line">    <span class="string">&quot;./路径/文件.csv&quot;</span>,</span><br><span class="line">    encoding=<span class="string">&#x27;utf-8&#x27;</span>,  <span class="comment"># 指定文件编码</span></span><br><span class="line">    index_col=<span class="literal">None</span>,    <span class="comment"># 指定索引列，None表示不将任何列用作索引</span></span><br><span class="line">    sep=<span class="string">&#x27;,&#x27;</span>,           <span class="comment"># 指定字段分隔符，逗号(,)是默认值</span></span><br><span class="line">    usecols=<span class="literal">None</span>,      <span class="comment"># 指定要读取的列，None表示读取所有列</span></span><br><span class="line">    names=<span class="literal">None</span>         <span class="comment"># 指定列名，None表示使用文件第一行作为列名</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 读取TSV文件（制表符分隔的文件）</span></span><br><span class="line">df_tsv = pd.read_csv(</span><br><span class="line">    <span class="string">&quot;./路径/文件.tsv&quot;</span>,</span><br><span class="line">    sep=<span class="string">&#x27;\t&#x27;</span>  <span class="comment"># 制表符作为字段分隔符</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 读取文本文件，指定分隔符，列名和没有标题行</span></span><br><span class="line">df_txt = pd.read_csv(</span><br><span class="line">    <span class="string">&#x27;./路径/文件.txt&#x27;</span>,</span><br><span class="line">    sep=<span class="string">&#x27;\t&#x27;</span>,          <span class="comment"># 制表符作为字段分隔符</span></span><br><span class="line">    header=<span class="number">0</span>,          <span class="comment"># 指定标题所在行的索引，0表示第一行</span></span><br><span class="line">    names=[<span class="string">&#x27;字段1&#x27;</span>, <span class="string">&#x27;字段2&#x27;</span>]  <span class="comment"># 指定列名</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure></div>

<h4 id="存储CSV文件"><a href="#存储CSV文件" class="headerlink" title="存储CSV文件"></a>存储CSV文件</h4><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 存储为CSV文件（基本）</span></span><br><span class="line">df.to_csv(<span class="string">&quot;./路径/文件.csv&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 存储为TSV文件（制表符分隔的文件）</span></span><br><span class="line">df.to_csv(</span><br><span class="line">    <span class="string">&quot;./路径/文件.tsv&quot;</span>,</span><br><span class="line">    sep=<span class="string">&#x27;\t&#x27;</span>,  <span class="comment"># 指定制表符作为字段分隔符</span></span><br><span class="line">    index=<span class="literal">False</span>  <span class="comment"># 不保存索引列到文件</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 存储为文本文件，使用制表符作为分隔符，不保存索引</span></span><br><span class="line">df.to_csv(</span><br><span class="line">    <span class="string">&quot;./路径/文件.txt&quot;</span>,</span><br><span class="line">    sep=<span class="string">&#x27;\t&#x27;</span>,   <span class="comment"># 指定制表符作为字段分隔符</span></span><br><span class="line">    index=<span class="literal">False</span>  <span class="comment"># 不保存索引列到文件</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure></div>

<p>对于处理Excel文件、JSON数据、以及与MySQL数据库交互的操作，我们可以整理和规范化代码示例，以提供清晰的指导。</p>
<h3 id="处理Excel文件"><a href="#处理Excel文件" class="headerlink" title="处理Excel文件"></a>处理Excel文件</h3><h4 id="读取Excel文件"><a href="#读取Excel文件" class="headerlink" title="读取Excel文件"></a>读取Excel文件</h4><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="comment"># 读取Excel文件</span></span><br><span class="line">df = pd.read_excel(</span><br><span class="line">    <span class="string">&quot;./路径/文件.xlsx&quot;</span>,</span><br><span class="line">    engine=<span class="string">&quot;openpyxl&quot;</span>,    <span class="comment"># 指定读取引擎，对于.xlsx文件推荐使用&#x27;openpyxl&#x27;</span></span><br><span class="line">    sheet_name=<span class="string">&#x27;Sheet1&#x27;</span>,  <span class="comment"># 指定工作表名称</span></span><br><span class="line">    header=<span class="number">0</span>              <span class="comment"># 指定标题所在行的索引，0表示第一行，None时不将任何行用作列名</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure></div>

<h4 id="存储为Excel文件"><a href="#存储为Excel文件" class="headerlink" title="存储为Excel文件"></a>存储为Excel文件</h4><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 存储DataFrame为Excel文件</span></span><br><span class="line">df.to_excel(</span><br><span class="line">    <span class="string">&#x27;./路径/文件.xlsx&#x27;</span>,</span><br><span class="line">    sheet_name=<span class="string">&#x27;Sheet1&#x27;</span>,  <span class="comment"># 指定工作表名称</span></span><br><span class="line">    index=<span class="literal">False</span>           <span class="comment"># 不保存索引列到文件</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure></div>

<h3 id="处理JSON数据"><a href="#处理JSON数据" class="headerlink" title="处理JSON数据"></a>处理JSON数据</h3><h4 id="读取JSON数据"><a href="#读取JSON数据" class="headerlink" title="读取JSON数据"></a>读取JSON数据</h4><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 从文件读取JSON数据</span></span><br><span class="line">df_from_file = pd.read_json(<span class="string">&#x27;./路径/文件.json&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 从URL直接读取JSON数据</span></span><br><span class="line">URL = <span class="string">&#x27;https://example.com/data.json&#x27;</span></span><br><span class="line">df_from_url = pd.read_json(URL)</span><br></pre></td></tr></table></figure></div>

<h4 id="存储为JSON文件"><a href="#存储为JSON文件" class="headerlink" title="存储为JSON文件"></a>存储为JSON文件</h4><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 存储DataFrame为JSON文件</span></span><br><span class="line">df.to_json(<span class="string">&#x27;./路径/文件.json&#x27;</span>)</span><br></pre></td></tr></table></figure></div>

<h3 id="与MySQL数据库交互"><a href="#与MySQL数据库交互" class="headerlink" title="与MySQL数据库交互"></a>与MySQL数据库交互</h3><h4 id="读取MySQL数据库数据"><a href="#读取MySQL数据库数据" class="headerlink" title="读取MySQL数据库数据"></a>读取MySQL数据库数据</h4><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> mysql.connector</span><br><span class="line"></span><br><span class="line"><span class="comment"># 连接MySQL数据库</span></span><br><span class="line">cnx = mysql.connector.connect(</span><br><span class="line">    user=<span class="string">&#x27;用户名&#x27;</span>, </span><br><span class="line">    password=<span class="string">&#x27;密码&#x27;</span>, </span><br><span class="line">    host=<span class="string">&#x27;主机地址&#x27;</span>, </span><br><span class="line">    database=<span class="string">&#x27;数据库名&#x27;</span>,</span><br><span class="line">    charset=<span class="string">&#x27;utf8&#x27;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用SQL查询读取数据</span></span><br><span class="line">query = <span class="string">&quot;SELECT * FROM 表名&quot;</span></span><br><span class="line">df = pd.read_sql(query, cnx)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 关闭数据库连接</span></span><br><span class="line">cnx.close()</span><br></pre></td></tr></table></figure></div>

<h4 id="存储数据到MySQL数据库"><a href="#存储数据到MySQL数据库" class="headerlink" title="存储数据到MySQL数据库"></a>存储数据到MySQL数据库</h4><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sqlalchemy <span class="keyword">import</span> create_engine</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建数据库连接引擎</span></span><br><span class="line">engine = create_engine(<span class="string">&#x27;mysql+mysqlconnector://用户名:密码@主机地址/数据库名&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 存储DataFrame到MySQL表中</span></span><br><span class="line">df.to_sql(</span><br><span class="line">    <span class="string">&#x27;tablename&#x27;</span>,         <span class="comment"># 指定数据库表名</span></span><br><span class="line">    con=engine,          <span class="comment"># 指定数据库连接</span></span><br><span class="line">    if_exists=<span class="string">&#x27;replace&#x27;</span>, <span class="comment"># 如果表存在，替换原数据</span></span><br><span class="line">    index=<span class="literal">False</span>          <span class="comment"># 不将DataFrame的索引列存入数据库</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure></div>

<p>对于创建Pandas Series的基础知识和示例代码，我们可以进行以下整理以提供清晰、规范的说明和操作步骤。</p>
<h2 id="创建Pandas-Series"><a href="#创建Pandas-Series" class="headerlink" title="创建Pandas Series"></a>创建Pandas Series</h2><h3 id="Series的特点"><a href="#Series的特点" class="headerlink" title="Series的特点"></a>Series的特点</h3><ul>
<li><strong>索引(Index)</strong>: 每个Series对象都有一个索引，用于标识每个数据点。索引的类型可以是整数、字符串、日期等。如果创建Series时未显式指定索引，Pandas会自动生成一个从0开始的整数索引。</li>
<li><strong>数据类型(Datatype)</strong>: Series可以包含各种类型的数据（整数、浮点数、字符串等）。Pandas允许Series内的数据类型不同，但通常情况下，为了效率，Series中的数据类型会保持一致。</li>
<li><strong>灵活性</strong>: Series支持多种操作，包括数学运算、索引&#x2F;选择、数据对齐等。</li>
</ul>
<h3 id="基础语法"><a href="#基础语法" class="headerlink" title="基础语法"></a>基础语法</h3><p>创建Series的基础语法如下：</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pandas.Series(data=<span class="literal">None</span>, index=<span class="literal">None</span>, dtype=<span class="literal">None</span>, name=<span class="literal">None</span>, copy=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure></div>

<h3 id="参数说明"><a href="#参数说明" class="headerlink" title="参数说明"></a>参数说明</h3><ul>
<li><strong>data</strong>: 可以是列表、数组等形式的数据集合。这是Series中存储的主要数据。</li>
<li><strong>index</strong>: 与数据同长度的索引标签列表。如果未指定，将自动生成从0开始的整数索引。</li>
<li><strong>dtype</strong>: 数据的类型（如<code>int</code>, <code>float</code>, <code>str</code>等）。如果未指定，dtype将自动推断。</li>
<li><strong>name</strong>: 为Series指定一个名称，便于理解和输出显示。</li>
<li><strong>copy</strong>: 是否复制输入数据，默认为<code>False</code>。设置为<code>True</code>可以避免修改原始数据。</li>
</ul>
<h3 id="创建Series示例"><a href="#创建Series示例" class="headerlink" title="创建Series示例"></a>创建Series示例</h3><h4 id="示例1-使用列表创建Series"><a href="#示例1-使用列表创建Series" class="headerlink" title="示例1: 使用列表创建Series"></a>示例1: 使用列表创建Series</h4><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">data = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line">series = pd.Series(data)</span><br><span class="line"><span class="built_in">print</span>(series)</span><br></pre></td></tr></table></figure></div>

<h4 id="示例2-使用NumPy数组创建Series"><a href="#示例2-使用NumPy数组创建Series" class="headerlink" title="示例2: 使用NumPy数组创建Series"></a>示例2: 使用NumPy数组创建Series</h4><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">data = np.array([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>])</span><br><span class="line">series = pd.Series(data)</span><br><span class="line"><span class="built_in">print</span>(series)</span><br></pre></td></tr></table></figure></div>

<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://imagedelivery.net/sodhLvOXTBoeXxRe03g_RA/83d8b41c-07d4-46c2-2877-c9aa0d0cd900/public"
                      width = "300"
                >

<p>在这两个示例中，我们创建了包含三个整数的Series对象。由于未指定索引，Pandas自动生成了从0开始的整数索引。这些示例展示了如何从基本的数据结构（列表或NumPy数组）创建Series，并展示了Series的基础属性，如自动索引和数据类型推断。</p>
<p>使用Pandas Series时，索引是一个强大的特性，允许快速访问、修改数据。以下是如何使用索引获取数据和指定索引的整理和示例。</p>
<h3 id="使用索引获取数据"><a href="#使用索引获取数据" class="headerlink" title="使用索引获取数据"></a>使用索引获取数据</h3><p>当创建一个Pandas Series对象时，每个元素都会自动分配一个索引。这个索引可以是默认的整数索引，也可以是自定义的索引。</p>
<h4 id="示例1-使用默认整数索引获取数据"><a href="#示例1-使用默认整数索引获取数据" class="headerlink" title="示例1: 使用默认整数索引获取数据"></a>示例1: 使用默认整数索引获取数据</h4><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建Series</span></span><br><span class="line">data = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line">series = pd.Series(data)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用索引获取数据</span></span><br><span class="line"><span class="built_in">print</span>(series[<span class="number">1</span>])</span><br></pre></td></tr></table></figure></div>

<p>此代码会输出Series中索引为1的元素，即<code>2</code>。</p>
<h4 id="指定索引"><a href="#指定索引" class="headerlink" title="指定索引"></a>指定索引</h4><p>可以在创建Series时通过<code>index</code>参数自定义索引。</p>
<h5 id="示例2-使用自定义索引"><a href="#示例2-使用自定义索引" class="headerlink" title="示例2: 使用自定义索引"></a>示例2: 使用自定义索引</h5><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建Series，指定索引</span></span><br><span class="line">data = [<span class="string">&quot;Google&quot;</span>, <span class="string">&quot;Runoob&quot;</span>, <span class="string">&quot;Wiki&quot;</span>]</span><br><span class="line">series = pd.Series(data, index=[<span class="string">&quot;x&quot;</span>, <span class="string">&quot;y&quot;</span>, <span class="string">&quot;z&quot;</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出整个Series</span></span><br><span class="line"><span class="built_in">print</span>(series)</span><br></pre></td></tr></table></figure></div>

<p>输出结果将展示一个Series，其中每个元素都由指定的索引标记：</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">x    Google</span><br><span class="line">y    Runoob</span><br><span class="line">z     Wiki</span><br><span class="line">dtype: object</span><br></pre></td></tr></table></figure></div>

<p>在这个例子中，字符串<code>&quot;Google&quot;</code>, <code>&quot;Runoob&quot;</code>, <code>&quot;Wiki&quot;</code>分别被赋予了自定义索引<code>&quot;x&quot;</code>, <code>&quot;y&quot;</code>, <code>&quot;z&quot;</code>。通过指定索引，可以提高数据检索的可读性和灵活性。</p>
<p>当创建Pandas Series时，指定索引和使用键值对（类似于字典）作为数据源是两种常见的方法。这提供了灵活的数据结构创建和数据访问方式。下面是对这些概念的整理和示例说明。</p>
<h5 id="示例3-使用自定义索引访问数据"><a href="#示例3-使用自定义索引访问数据" class="headerlink" title="示例3: 使用自定义索引访问数据"></a>示例3: 使用自定义索引访问数据</h5><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建Series并指定索引</span></span><br><span class="line">data = [<span class="string">&quot;Google&quot;</span>, <span class="string">&quot;Runoob&quot;</span>, <span class="string">&quot;Wiki&quot;</span>]</span><br><span class="line">series = pd.Series(data, index=[<span class="string">&quot;x&quot;</span>, <span class="string">&quot;y&quot;</span>, <span class="string">&quot;z&quot;</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用指定的索引访问数据</span></span><br><span class="line"><span class="built_in">print</span>(series[<span class="string">&quot;y&quot;</span>])</span><br></pre></td></tr></table></figure></div>

<p>此代码段会输出索引为<code>&quot;y&quot;</code>的元素，即<code>&quot;Runoob&quot;</code>。</p>
<h3 id="使用字典创建Series"><a href="#使用字典创建Series" class="headerlink" title="使用字典创建Series"></a>使用字典创建Series</h3><p>当使用字典创建Series时，字典的键自动成为Series的索引，而字典的值成为Series的数据。</p>
<h4 id="示例1-从字典创建Series"><a href="#示例1-从字典创建Series" class="headerlink" title="示例1: 从字典创建Series"></a>示例1: 从字典创建Series</h4><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用字典创建Series</span></span><br><span class="line">sites = &#123;<span class="number">1</span>: <span class="string">&quot;Google&quot;</span>, <span class="number">2</span>: <span class="string">&quot;Runoob&quot;</span>, <span class="number">3</span>: <span class="string">&quot;Wiki&quot;</span>&#125;</span><br><span class="line">series = pd.Series(sites)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出Series</span></span><br><span class="line"><span class="built_in">print</span>(series)</span><br></pre></td></tr></table></figure></div>

<p>这段代码创建了一个Series，其中字典的键（1, 2, 3）自动成为了Series的索引。</p>
<h4 id="示例2-指定索引过滤数据"><a href="#示例2-指定索引过滤数据" class="headerlink" title="示例2: 指定索引过滤数据"></a>示例2: 指定索引过滤数据</h4><p>如果在使用字典创建Series时还指定了<code>index</code>参数，那么只有在<code>index</code>参数中指定的键会被包含在Series中。</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用字典创建Series，并指定索引</span></span><br><span class="line">sites = &#123;<span class="number">1</span>: <span class="string">&quot;Google&quot;</span>, <span class="number">2</span>: <span class="string">&quot;Runoob&quot;</span>, <span class="number">3</span>: <span class="string">&quot;Wiki&quot;</span>&#125;</span><br><span class="line">series = pd.Series(sites, index=[<span class="number">1</span>, <span class="number">2</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出Series</span></span><br><span class="line"><span class="built_in">print</span>(series)</span><br></pre></td></tr></table></figure></div>

<p>这段代码将只输出键为1和2的数据项，即<code>&quot;Google&quot;</code>和<code>&quot;Runoob&quot;</code>，因为在创建Series时我们通过<code>index</code>参数指定了只包含这些键。</p>
<p>在处理Pandas Series时，了解如何设置名称、执行基本操作、进行基本运算、以及使用属性和方法是非常重要的。以下是对这些概念的整理和示例说明。</p>
<h2 id="设置Series名称参数"><a href="#设置Series名称参数" class="headerlink" title="设置Series名称参数"></a>设置Series名称参数</h2><p>可以在创建Series时通过<code>name</code>参数为Series设置一个名称，这有助于标识Series代表的数据集。</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建Series并设置名称</span></span><br><span class="line">sites = &#123;<span class="number">1</span>: <span class="string">&quot;Google&quot;</span>, <span class="number">2</span>: <span class="string">&quot;Runoob&quot;</span>, <span class="number">3</span>: <span class="string">&quot;Wiki&quot;</span>&#125;</span><br><span class="line">myvar = pd.Series(sites, index=[<span class="number">1</span>, <span class="number">2</span>], name=<span class="string">&quot;RUNOOB-Series-TEST&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(myvar)</span><br></pre></td></tr></table></figure></div>

<h3 id="基本操作"><a href="#基本操作" class="headerlink" title="基本操作"></a>基本操作</h3><h4 id="获取值"><a href="#获取值" class="headerlink" title="获取值"></a>获取值</h4><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用索引获取单个值</span></span><br><span class="line">value = myvar[<span class="number">2</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用切片获取多个值</span></span><br><span class="line">subset = myvar[<span class="number">1</span>:<span class="number">3</span>]  <span class="comment"># 注意: 切片操作在使用显式索引时是包含结束索引的</span></span><br></pre></td></tr></table></figure></div>

<h4 id="遍历Series"><a href="#遍历Series" class="headerlink" title="遍历Series"></a>遍历Series</h4><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 索引和值的遍历</span></span><br><span class="line"><span class="keyword">for</span> index, value <span class="keyword">in</span> myvar.items():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;Index: <span class="subst">&#123;index&#125;</span>, Value: <span class="subst">&#123;value&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure></div>

<h3 id="基本运算"><a href="#基本运算" class="headerlink" title="基本运算"></a>基本运算</h3><h4 id="算术运算"><a href="#算术运算" class="headerlink" title="算术运算"></a>算术运算</h4><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 对Series中的每个元素进行乘法运算</span></span><br><span class="line">result = myvar * <span class="number">2</span></span><br></pre></td></tr></table></figure></div>

<h4 id="过滤"><a href="#过滤" class="headerlink" title="过滤"></a>过滤</h4><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用条件过滤Series中的元素</span></span><br><span class="line">filtered_series = myvar[myvar &gt; <span class="number">2</span>]</span><br></pre></td></tr></table></figure></div>

<h4 id="应用数学函数"><a href="#应用数学函数" class="headerlink" title="应用数学函数"></a>应用数学函数</h4><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="comment"># 对Series中的每个元素应用平方根函数</span></span><br><span class="line">result = np.sqrt(myvar)</span><br></pre></td></tr></table></figure></div>

<h3 id="属性和方法"><a href="#属性和方法" class="headerlink" title="属性和方法"></a>属性和方法</h3><h4 id="获取索引和值"><a href="#获取索引和值" class="headerlink" title="获取索引和值"></a>获取索引和值</h4><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 获取Series的索引</span></span><br><span class="line">index = myvar.index</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取Series的值</span></span><br><span class="line">values = myvar.values</span><br></pre></td></tr></table></figure></div>

<h4 id="描述统计"><a href="#描述统计" class="headerlink" title="描述统计"></a>描述统计</h4><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 对DataFrame中的数值列进行描述性统计</span></span><br><span class="line">data = &#123;<span class="string">&#x27;name&#x27;</span>: [<span class="string">&#x27;Alice&#x27;</span>, <span class="string">&#x27;Bob&#x27;</span>, <span class="string">&#x27;Charlie&#x27;</span>, <span class="string">&#x27;David&#x27;</span>, <span class="string">&#x27;Emily&#x27;</span>],</span><br><span class="line">        <span class="string">&#x27;score&#x27;</span>: [<span class="number">90</span>, <span class="number">85</span>, <span class="number">75</span>, <span class="number">80</span>, <span class="number">95</span>],</span><br><span class="line">        <span class="string">&#x27;age&#x27;</span>: [<span class="number">20</span>, <span class="number">25</span>, <span class="number">30</span>, <span class="number">35</span>, <span class="number">40</span>]&#125;</span><br><span class="line">df = pd.DataFrame(data)</span><br><span class="line">stats = df.describe()</span><br><span class="line"><span class="built_in">print</span>(stats)</span><br></pre></td></tr></table></figure></div>

<h4 id="获取最大值和最小值的索引"><a href="#获取最大值和最小值的索引" class="headerlink" title="获取最大值和最小值的索引"></a>获取最大值和最小值的索引</h4><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 获取Series中最大值和最小值的索引</span></span><br><span class="line">max_index = myvar.idxmax()</span><br><span class="line">min_index = myvar.idxmin()</span><br></pre></td></tr></table></figure></div>

<h2 id="DataFrame"><a href="#DataFrame" class="headerlink" title="DataFrame"></a>DataFrame</h2><p>Pandas的<code>DataFrame</code>是一个二维的、大小可变的、潜在的异构表格数据结构，带有标记的轴（行和列）。理解<code>DataFrame</code>的基础语法和创建方法是使用Pandas进行数据分析和数据处理的基础。</p>
<h3 id="基础语法-1"><a href="#基础语法-1" class="headerlink" title="基础语法"></a>基础语法</h3><p>创建<code>DataFrame</code>的基础语法如下：</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pandas.DataFrame(data=<span class="literal">None</span>, index=<span class="literal">None</span>, columns=<span class="literal">None</span>, dtype=<span class="literal">None</span>, copy=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure></div>

<h3 id="参数说明-1"><a href="#参数说明-1" class="headerlink" title="参数说明"></a>参数说明</h3><ul>
<li><strong>data</strong>: 接受多种类型的输入，包括但不限于<code>ndarray</code>、<code>Series</code>、<code>map</code>、<code>lists</code>、<code>dict</code>等。这是<code>DataFrame</code>中存储的主要数据。</li>
<li><strong>index</strong>: 行标签。如果没有指定，就像在<code>Series</code>中一样，Pandas会默认创建从0开始的整数索引。</li>
<li><strong>columns</strong>: 列标签，默认为<code>RangeIndex (0, 1, 2, …, n)</code>。如果数据输入是字典，则默认列标签是字典键排序后的顺序。</li>
<li><strong>dtype</strong>: 数据类型。可以为整个<code>DataFrame</code>指定一个统一的数据类型。如果不指定，则会自动推断。</li>
<li><strong>copy</strong>: 是否复制输入数据，默认为<code>False</code>。如果为<code>True</code>，则复制，这可以避免修改到原始数据。</li>
</ul>
<h3 id="创建DataFrame示例"><a href="#创建DataFrame示例" class="headerlink" title="创建DataFrame示例"></a>创建DataFrame示例</h3><h4 id="通过列表创建DataFrame"><a href="#通过列表创建DataFrame" class="headerlink" title="通过列表创建DataFrame"></a>通过列表创建<code>DataFrame</code></h4><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建数据列表</span></span><br><span class="line">data = [[<span class="string">&#x27;Google&#x27;</span>, <span class="number">10</span>], [<span class="string">&#x27;Runoob&#x27;</span>, <span class="number">12</span>], [<span class="string">&#x27;Wiki&#x27;</span>, <span class="number">13</span>]]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建DataFrame</span></span><br><span class="line">df = pd.DataFrame(data, columns=[<span class="string">&#x27;Site&#x27;</span>, <span class="string">&#x27;Age&#x27;</span>], dtype=<span class="built_in">float</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打印DataFrame</span></span><br><span class="line"><span class="built_in">print</span>(df)</span><br></pre></td></tr></table></figure></div>

<p>输出结果将是一个<code>DataFrame</code>，包含两列<code>Site</code>和<code>Age</code>，数据类型被设置为浮点数：</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">     Site   Age</span><br><span class="line">0  Google  10.0</span><br><span class="line">1  Runoob  12.0</span><br><span class="line">2    Wiki  13.0</span><br></pre></td></tr></table></figure></div>

<p>在这个例子中，<code>data</code>是一个列表，其中包含三个子列表，每个子列表代表一行数据。通过<code>columns</code>参数指定了列名为<code>Site</code>和<code>Age</code>，通过<code>dtype</code>参数将所有数值数据类型指定为浮点数。</p>
<p>在Pandas中，<code>DataFrame</code>是用于存储和操作结构化数据的主要数据结构。以下内容整理了<code>DataFrame</code>的创建、基本操作、属性和方法，以及如何从外部数据源创建<code>DataFrame</code>的相关信息。</p>
<h4 id="通过ndarrays或列表的字典创建"><a href="#通过ndarrays或列表的字典创建" class="headerlink" title="通过ndarrays或列表的字典创建"></a>通过ndarrays或列表的字典创建</h4><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用字典创建DataFrame</span></span><br><span class="line">data = &#123;<span class="string">&#x27;Site&#x27;</span>: [<span class="string">&#x27;Google&#x27;</span>, <span class="string">&#x27;Runoob&#x27;</span>, <span class="string">&#x27;Wiki&#x27;</span>], <span class="string">&#x27;Age&#x27;</span>: [<span class="number">10</span>, <span class="number">12</span>, <span class="number">13</span>]&#125;</span><br><span class="line">df = pd.DataFrame(data)</span><br><span class="line"><span class="built_in">print</span>(df)</span><br></pre></td></tr></table></figure></div>

<p>输出结果：</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">     Site  Age</span><br><span class="line">0  Google   10</span><br><span class="line">1  Runoob   12</span><br><span class="line">2    Wiki   13</span><br></pre></td></tr></table></figure></div>

<h4 id="通过字典列表创建"><a href="#通过字典列表创建" class="headerlink" title="通过字典列表创建"></a>通过字典列表创建</h4><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用字典列表创建DataFrame</span></span><br><span class="line">data = [&#123;<span class="string">&#x27;a&#x27;</span>: <span class="number">1</span>, <span class="string">&#x27;b&#x27;</span>: <span class="number">2</span>&#125;, &#123;<span class="string">&#x27;a&#x27;</span>: <span class="number">5</span>, <span class="string">&#x27;b&#x27;</span>: <span class="number">10</span>, <span class="string">&#x27;c&#x27;</span>: <span class="number">20</span>&#125;]</span><br><span class="line">df = pd.DataFrame(data)</span><br><span class="line"><span class="built_in">print</span>(df)</span><br></pre></td></tr></table></figure></div>

<p>输出结果：</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">   a   b     c</span><br><span class="line">0  1   2   NaN</span><br><span class="line">1  5  10  20.0</span><br></pre></td></tr></table></figure></div>

<p>注意：缺失的数据部分为<code>NaN</code>，而非<code>NULL</code>。</p>
<h3 id="loc-属性返回指定行的数据"><a href="#loc-属性返回指定行的数据" class="headerlink" title="loc 属性返回指定行的数据"></a><strong>loc</strong> 属性返回指定行的数据</h3><p>首先，导入Pandas库，并创建一个包含数据的字典，然后将其载入到<code>DataFrame</code>对象中。默认情况下，如果没有指定索引，Pandas会自动创建一个从0开始的整数索引。</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">data = &#123;</span><br><span class="line">  <span class="string">&quot;calories&quot;</span>: [<span class="number">420</span>, <span class="number">380</span>, <span class="number">390</span>],</span><br><span class="line">  <span class="string">&quot;duration&quot;</span>: [<span class="number">50</span>, <span class="number">40</span>, <span class="number">45</span>]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">df = pd.DataFrame(data)</span><br></pre></td></tr></table></figure></div>

<h4 id="返回单行数据"><a href="#返回单行数据" class="headerlink" title="返回单行数据"></a>返回单行数据</h4><p>使用<code>loc</code>属性，可以通过指定行索引来返回对应的数据行。此时，返回的结果是一个Pandas <code>Series</code>数据类型。</p>
<ul>
<li>返回第一行数据：</li>
</ul>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(df.loc[<span class="number">0</span>])</span><br></pre></td></tr></table></figure></div>

<ul>
<li>返回第二行数据：</li>
</ul>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(df.loc[<span class="number">1</span>])</span><br></pre></td></tr></table></figure></div>

<h4 id="返回多行数据"><a href="#返回多行数据" class="headerlink" title="返回多行数据"></a>返回多行数据</h4><p><code>loc</code>同样可以用于返回多行数据，通过传递一个包含多个索引的列表作为参数。</p>
<ul>
<li>返回第一行和第二行数据：</li>
</ul>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(df.loc[[<span class="number">0</span>, <span class="number">1</span>]])</span><br></pre></td></tr></table></figure></div>

<h4 id="使用自定义索引"><a href="#使用自定义索引" class="headerlink" title="使用自定义索引"></a>使用自定义索引</h4><p>Pandas允许为<code>DataFrame</code>对象的行设置自定义索引。</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df = pd.DataFrame(data, index = [<span class="string">&quot;day1&quot;</span>, <span class="string">&quot;day2&quot;</span>, <span class="string">&quot;day3&quot;</span>])</span><br><span class="line"><span class="built_in">print</span>(df)</span><br></pre></td></tr></table></figure></div>

<p>使用自定义索引后，可以使用这些索引值来检索数据行。</p>
<ul>
<li>使用<code>loc</code>属性返回自定义索引对应的某一行：</li>
</ul>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(df.loc[<span class="string">&quot;day2&quot;</span>])</span><br></pre></td></tr></table></figure></div>

<p>在这个例子中，我们首先设置了自定义索引（”day1”, “day2”, “day3”），然后通过这些索引来检索数据。当使用<code>loc</code>与自定义索引时，指定的索引值必须存在于<code>DataFrame</code>的索引中，否则会引发<code>KeyError</code>。</p>
<p>在使用Pandas处理数据时，<code>DataFrame</code>是一个非常核心的数据结构，它允许以表格的形式存储和操作结构化数据。以下是对提供的代码和概念的整理和解释，帮助更好地理解如何使用<code>DataFrame</code>进行基本操作、属性和方法的调用、数据操作技巧，以及如何从外部数据源创建<code>DataFrame</code>。</p>
<h3 id="基本操作-1"><a href="#基本操作-1" class="headerlink" title="基本操作"></a>基本操作</h3><h4 id="获取列"><a href="#获取列" class="headerlink" title="获取列"></a>获取列</h4><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">name_column = df[<span class="string">&#x27;Name&#x27;</span>]</span><br></pre></td></tr></table></figure></div>

<h4 id="获取行"><a href="#获取行" class="headerlink" title="获取行"></a>获取行</h4><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">first_row = df.loc[<span class="number">0</span>]</span><br></pre></td></tr></table></figure></div>

<h4 id="选择多列"><a href="#选择多列" class="headerlink" title="选择多列"></a>选择多列</h4><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">subset = df[[<span class="string">&#x27;Name&#x27;</span>, <span class="string">&#x27;Age&#x27;</span>]]</span><br></pre></td></tr></table></figure></div>

<h4 id="过滤行"><a href="#过滤行" class="headerlink" title="过滤行"></a>过滤行</h4><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">filtered_rows = df[df[<span class="string">&#x27;Age&#x27;</span>] &gt; <span class="number">30</span>]</span><br></pre></td></tr></table></figure></div>

<h3 id="属性和方法-1"><a href="#属性和方法-1" class="headerlink" title="属性和方法"></a>属性和方法</h3><h4 id="获取列名"><a href="#获取列名" class="headerlink" title="获取列名"></a>获取列名</h4><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">columns = df.columns</span><br></pre></td></tr></table></figure></div>

<h4 id="获取形状（行数和列数）"><a href="#获取形状（行数和列数）" class="headerlink" title="获取形状（行数和列数）"></a>获取形状（行数和列数）</h4><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shape = df.shape</span><br></pre></td></tr></table></figure></div>

<h4 id="获取索引"><a href="#获取索引" class="headerlink" title="获取索引"></a>获取索引</h4><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">index = df.index</span><br></pre></td></tr></table></figure></div>

<h4 id="获取描述统计信息"><a href="#获取描述统计信息" class="headerlink" title="获取描述统计信息"></a>获取描述统计信息</h4><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">stats = df.describe()</span><br></pre></td></tr></table></figure></div>

<h3 id="数据操作"><a href="#数据操作" class="headerlink" title="数据操作"></a>数据操作</h3><h4 id="添加新列"><a href="#添加新列" class="headerlink" title="添加新列"></a>添加新列</h4><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[<span class="string">&#x27;Salary&#x27;</span>] = [<span class="number">50000</span>, <span class="number">60000</span>, <span class="number">70000</span>]</span><br></pre></td></tr></table></figure></div>

<h4 id="删除列"><a href="#删除列" class="headerlink" title="删除列"></a>删除列</h4><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.drop(<span class="string">&#x27;City&#x27;</span>, axis=<span class="number">1</span>, inplace=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure></div>

<h4 id="排序"><a href="#排序" class="headerlink" title="排序"></a>排序</h4><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.sort_values(by=<span class="string">&#x27;Age&#x27;</span>, ascending=<span class="literal">False</span>, inplace=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure></div>

<h4 id="重命名列"><a href="#重命名列" class="headerlink" title="重命名列"></a>重命名列</h4><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.rename(columns=&#123;<span class="string">&#x27;Name&#x27;</span>: <span class="string">&#x27;Full Name&#x27;</span>&#125;, inplace=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure></div>

<h3 id="从外部数据源创建-DataFrame"><a href="#从外部数据源创建-DataFrame" class="headerlink" title="从外部数据源创建 DataFrame"></a>从外部数据源创建 DataFrame</h3><h4 id="从CSV文件创建"><a href="#从CSV文件创建" class="headerlink" title="从CSV文件创建"></a>从CSV文件创建</h4><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df_csv = pd.read_csv(<span class="string">&#x27;example.csv&#x27;</span>)</span><br></pre></td></tr></table></figure></div>

<h4 id="从Excel文件创建"><a href="#从Excel文件创建" class="headerlink" title="从Excel文件创建"></a>从Excel文件创建</h4><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df_excel = pd.read_excel(<span class="string">&#x27;example.xlsx&#x27;</span>)</span><br></pre></td></tr></table></figure></div>

<h4 id="从字典列表创建"><a href="#从字典列表创建" class="headerlink" title="从字典列表创建"></a>从字典列表创建</h4><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">data_list = [&#123;<span class="string">&#x27;Name&#x27;</span>: <span class="string">&#x27;Alice&#x27;</span>, <span class="string">&#x27;Age&#x27;</span>: <span class="number">25</span>&#125;, &#123;<span class="string">&#x27;Name&#x27;</span>: <span class="string">&#x27;Bob&#x27;</span>, <span class="string">&#x27;Age&#x27;</span>: <span class="number">30</span>&#125;]</span><br><span class="line">df_from_list = pd.DataFrame(data_list)</span><br></pre></td></tr></table></figure></div>


  <div class="note-large orange">
    <div class="notel-title rounded-t-lg p-3 font-bold text-lg flex flex-row gap-2 items-center">
      <i class="notel-icon fa-solid fa-circle-exclamation"></i><p>注意</p>

    </div>
    <div class="notel-content">
      <ul>
<li><strong>灵活性</strong>：<code>DataFrame</code>可以容纳不同数据类型的列（例如整数、浮点数、字符串等）。</li>
<li><strong>索引</strong>：列名和行索引可以是字符串、整数等。Pandas提供了丰富的索引功能，以便于数据选择和操作。</li>
<li><strong>数据操作</strong>：可以通过多种方式进行数据选择、过滤、修改和分析，这使得<code>DataFrame</code>非常适合数据清洗、转换、分析和可视化等工作。</li>
</ul>

    </div>
  </div>

<h2 id="案例"><a href="#案例" class="headerlink" title="案例"></a>案例</h2><h3 id="缺失率"><a href="#缺失率" class="headerlink" title="缺失率"></a>缺失率</h3><p>缺失率是指在数据集中缺失值所占的比例，通常用于数据清洗和预处理阶段，以评估数据的完整性。计算缺失率的基本公式如下：</p>
<p>$$ \text{缺失率 (%)} &#x3D; \left( \frac{\text{缺失值数量}}{\text{总值数量}} \right) \times 100 $$</p>
<p>其中，</p>
<ul>
<li>数据集中的缺失值数量是指那些空白或者NULL值的数量。</li>
<li>数据集中的总值数量是指数据集中所有可能的数据点的数量，包括有效值和缺失值。</li>
</ul>
<p>缺失率可以帮助我们了解数据缺失的严重程度，进而决定如何处理这些缺失值，比如通过删除缺失值、填补缺失值或者采用模型估计等方法。</p>
<h4 id="创建数据表"><a href="#创建数据表" class="headerlink" title="创建数据表"></a>创建数据表</h4><p>在这个<code>DataFrame</code>中，包含了几个列：<code>id</code>、<code>date</code>、<code>city</code>、<code>age</code>、<code>category</code>，以及<code>price</code>。</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">df = pd.DataFrame(&#123;</span><br><span class="line">    <span class="string">&quot;id&quot;</span>: [<span class="number">1001</span>, <span class="number">1002</span>, <span class="number">1003</span>, <span class="number">1004</span>, <span class="number">1005</span>, <span class="number">1006</span>], </span><br><span class="line">    <span class="string">&quot;date&quot;</span>: pd.date_range(<span class="string">&#x27;20130102&#x27;</span>, periods=<span class="number">6</span>),</span><br><span class="line">    <span class="string">&quot;city&quot;</span>: [<span class="string">&#x27;Beijing &#x27;</span>, <span class="string">&#x27;SH&#x27;</span>, <span class="string">&#x27; guangzhou &#x27;</span>, <span class="string">&#x27;Shenzhen&#x27;</span>, <span class="string">&#x27;shanghai&#x27;</span>, <span class="string">&#x27;BEIJING &#x27;</span>],</span><br><span class="line">    <span class="string">&quot;age&quot;</span>: [<span class="number">23</span>, <span class="number">44</span>, <span class="number">54</span>, <span class="number">32</span>, <span class="number">34</span>, <span class="number">32</span>],</span><br><span class="line">    <span class="string">&quot;category&quot;</span>: [<span class="string">&#x27;100-A&#x27;</span>, <span class="string">&#x27;100-B&#x27;</span>, <span class="string">&#x27;110-A&#x27;</span>, <span class="string">&#x27;110-C&#x27;</span>, <span class="string">&#x27;210-A&#x27;</span>, <span class="string">&#x27;130-F&#x27;</span>],</span><br><span class="line">    <span class="string">&quot;price&quot;</span>: [<span class="number">1200</span>, np.nan, <span class="number">2133</span>, <span class="number">5433</span>, np.nan, <span class="number">4432</span>]</span><br><span class="line">&#125;, columns=[<span class="string">&#x27;id&#x27;</span>, <span class="string">&#x27;date&#x27;</span>, <span class="string">&#x27;city&#x27;</span>, <span class="string">&#x27;category&#x27;</span>, <span class="string">&#x27;age&#x27;</span>, <span class="string">&#x27;price&#x27;</span>])</span><br></pre></td></tr></table></figure></div>

<p>这段代码首先导入了必要的库：<code>pandas</code>和<code>numpy</code>。<code>numpy</code>在这里的用途是提供<code>np.nan</code>来表示缺失值，这在处理真实世界的数据时非常常见。</p>
<ul>
<li><code>id</code>列包含唯一标识符。</li>
<li><code>date</code>列使用<code>pd.date_range</code>函数生成了一个日期范围。</li>
<li><code>city</code>列包含了一些城市名称，注意这些城市名称前后可能包含空格。</li>
<li><code>age</code>列包含了年龄。</li>
<li><code>category</code>列包含了分类代码。</li>
<li><code>price</code>列包含了价格，使用<code>np.nan</code>表示某些价格未知或缺失。</li>
</ul>
<p>通过指定<code>columns</code>参数，确保了<code>DataFrame</code>列的顺序按照<code>id</code>、<code>date</code>、<code>city</code>、<code>category</code>、<code>age</code>、<code>price</code>的顺序排列，即使在字典中的顺序不是这样的。</p>
<h4 id="数据概览"><a href="#数据概览" class="headerlink" title="数据概览"></a>数据概览</h4><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(df)</span><br></pre></td></tr></table></figure></div>

<pre><code>     id       date         city category  age   price
0  1001 2013-01-02     Beijing     100-A   23  1200.0
1  1002 2013-01-03           SH    100-B   44     NaN
2  1003 2013-01-04   guangzhou     110-A   54  2133.0
3  1004 2013-01-05     Shenzhen    110-C   32  5433.0
4  1005 2013-01-06     shanghai    210-A   34     NaN
5  1006 2013-01-07     BEIJING     130-F   32  4432.0
</code></pre>
<h4 id="每列缺失值的数量"><a href="#每列缺失值的数量" class="headerlink" title="每列缺失值的数量"></a>每列缺失值的数量</h4><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 计算每列缺失值的数量</span></span><br><span class="line">missing_values_count = df.isnull().<span class="built_in">sum</span>()</span><br><span class="line"><span class="built_in">print</span>(missing_values_count)</span><br></pre></td></tr></table></figure></div>

<pre><code>id          0
date        0
city        0
category    0
age         0
price       2
dtype: int64
</code></pre>

  <div class="note-large blue">
    <div class="notel-title rounded-t-lg p-3 font-bold text-lg flex flex-row gap-2 items-center">
      <i class="notel-icon fa-solid fa-circle-info"></i><p>信息</p>

    </div>
    <div class="notel-content">
      <div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">显示所有的数据</span><br><span class="line">pd.set_option(<span class="string">&#x27;display.max_rows&#x27;</span>, <span class="literal">None</span>)  <span class="comment"># 显示所有行</span></span><br><span class="line">pd.set_option(<span class="string">&#x27;display.max_columns&#x27;</span>, <span class="literal">None</span>)  <span class="comment"># 显示所有列</span></span><br><span class="line">pd.set_option(<span class="string">&#x27;expand_frame_repr&#x27;</span>, <span class="literal">False</span>)  <span class="comment"># 不自动换行</span></span><br></pre></td></tr></table></figure></div>

    </div>
  </div>

<h4 id="缺失率-1"><a href="#缺失率-1" class="headerlink" title="缺失率"></a>缺失率</h4><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 计算缺失率</span></span><br><span class="line">missing_rate = (missing_values_count / <span class="built_in">len</span>(df)) * <span class="number">100</span></span><br><span class="line"><span class="built_in">print</span>(missing_rate)</span><br></pre></td></tr></table></figure></div>

<pre><code>id           0.000000
date         0.000000
city         0.000000
category     0.000000
age          0.000000
price       33.333333
dtype: float64
</code></pre>
<h2 id="DataFrame常规操作"><a href="#DataFrame常规操作" class="headerlink" title="DataFrame常规操作"></a>DataFrame常规操作</h2><h3 id="修改index、columns"><a href="#修改index、columns" class="headerlink" title="修改index、columns"></a>修改index、columns</h3><h4 id="修改DataFrame的索引（index）"><a href="#修改DataFrame的索引（index）" class="headerlink" title="修改DataFrame的索引（index）"></a>修改DataFrame的索引（<code>index</code>）</h4><p>在Pandas中，修改DataFrame的索引是一个常见操作，可以帮助更好地定位和引用数据行。下面是如何修改DataFrame索引的步骤和示例：</p>
<ol>
<li><p><strong>设置默认显示行数</strong>：首先，我们可以通过<code>pd.set_option</code>来设置Pandas默认显示的行数。这里未展示设置方法，但可以通过<code>print(df.head())</code>来显示前几行数据，其中<code>df</code>是DataFrame变量名。</p>
</li>
<li><p><strong>直接修改索引</strong>：可以通过直接赋值给<code>df.index</code>属性来修改整个DataFrame的索引。例如，如果有一个DataFrame <code>row</code>，并且想要将索引修改为<code>[&#39;x&#39;, &#39;y&#39;, &#39;z&#39;]</code>，需要确保索引的长度与DataFrame的行数相匹配。如果不匹配，会导致错误。</p>
</li>
</ol>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">row.index = [<span class="string">&#x27;x&#x27;</span>, <span class="string">&#x27;y&#x27;</span>, <span class="string">&#x27;z&#x27;</span>]</span><br></pre></td></tr></table></figure></div>

<h4 id="读取文件时只处理部分行"><a href="#读取文件时只处理部分行" class="headerlink" title="读取文件时只处理部分行"></a>读取文件时只处理部分行</h4><p>当处理大型文件时，为了测试或其他目的，可能只想读取文件的一部分。使用<code>pd.read_csv</code>时，可以通过<code>nrows</code>参数来限制读取的行数。</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df = pd.read_csv(<span class="string">&#x27;./LCIS.csv&#x27;</span>, nrows=<span class="number">3</span>)</span><br></pre></td></tr></table></figure></div>

<h4 id="修改DataFrame的列名（columns）"><a href="#修改DataFrame的列名（columns）" class="headerlink" title="修改DataFrame的列名（columns）"></a>修改DataFrame的列名（<code>columns</code>）</h4><p>修改列名可以通过直接赋值给<code>df.columns</code>属性或使用<code>rename</code>方法。</p>
<ol>
<li><strong>直接修改所有列名</strong>：通过直接赋值给<code>df.columns</code>属性，可以为所有列设置新的列名。</li>
</ol>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">row.columns = [<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;C&#x27;</span>]</span><br></pre></td></tr></table></figure></div>

<ol start="2">
<li><strong>使用<code>rename</code>方法修改列名</strong>：如果只想修改某些列的名称，可以使用<code>rename</code>方法，并通过<code>columns</code>参数传入一个字典，字典的键是旧列名，值是新列名。使用<code>inplace=True</code>可以直接在原DataFrame上进行修改，而不是返回一个新的DataFrame。</li>
</ol>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">row.rename(columns=&#123;<span class="string">&#x27;ListingId&#x27;</span>: <span class="string">&#x27;ID&#x27;</span>&#125;, inplace=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure></div>

<h4 id="单独修改一个索引或列名"><a href="#单独修改一个索引或列名" class="headerlink" title="单独修改一个索引或列名"></a>单独修改一个索引或列名</h4><p>同样，使用<code>rename</code>方法也可以修改单个索引或列名，方法与修改列名类似。</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">row.rename(index=&#123;<span class="number">0</span>: <span class="string">&#x27;A&#x27;</span>&#125;, inplace=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure></div>

<h4 id="综合示例"><a href="#综合示例" class="headerlink" title="综合示例"></a>综合示例</h4><p>现在，让我们通过一个综合示例来展示如何实际应用上述操作，并提供预期的输出结果。</p>
<h5 id="数据导入"><a href="#数据导入" class="headerlink" title="数据导入"></a>数据导入</h5><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">df = pd.read_csv(<span class="string">&#x27;LCIS.csv&#x27;</span>,nrows=<span class="number">5</span>, usecols=<span class="built_in">range</span>(<span class="number">10</span>))</span><br><span class="line">row = pd.DataFrame(df)</span><br></pre></td></tr></table></figure></div>

<h5 id="修改索引前的输出"><a href="#修改索引前的输出" class="headerlink" title="修改索引前的输出"></a>修改索引前的输出</h5><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&quot;修改索引前:&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(row.head())</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">修改索引前:</span><br><span class="line">   ListingId   借款金额  借款期限  借款利率     借款成功日期 初始评级 借款类型 是否首标  年龄 性别</span><br><span class="line">0    1693100   3629     6    12  2015/1/28   AA   普通    否  31  男</span><br><span class="line">1    1713229   3000    12    12  2015/1/30   AA   普通    是  24  男</span><br><span class="line">2    1904026   3629    12    12   2015/3/7   AA   普通    否  27  男</span><br><span class="line">3    2158281   3919    12    18  2015/4/14    C   普通    否  28  男</span><br><span class="line">4    2257194  14000    12    18  2015/4/23    C   普通    否  46  男</span><br></pre></td></tr></table></figure></div>

<h5 id="修改索引后的输出"><a href="#修改索引后的输出" class="headerlink" title="修改索引后的输出"></a>修改索引后的输出</h5><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 修改索引</span></span><br><span class="line">row.index = [<span class="string">&#x27;x&#x27;</span>, <span class="string">&#x27;y&#x27;</span>, <span class="string">&#x27;z&#x27;</span>, <span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\n修改索引后:&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(row.head())</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">修改索引后:</span><br><span class="line">   ListingId   借款金额  借款期限  借款利率     借款成功日期 初始评级 借款类型 是否首标  年龄 性别</span><br><span class="line">x    1693100   3629     6    12  2015/1/28   AA   普通    否  31  男</span><br><span class="line">y    1713229   3000    12    12  2015/1/30   AA   普通    是  24  男</span><br><span class="line">z    1904026   3629    12    12   2015/3/7   AA   普通    否  27  男</span><br><span class="line">a    2158281   3919    12    18  2015/4/14    C   普通    否  28  男</span><br><span class="line">b    2257194  14000    12    18  2015/4/23    C   普通    否  46  男</span><br></pre></td></tr></table></figure></div>

<h5 id="修改列名"><a href="#修改列名" class="headerlink" title="修改列名"></a>修改列名</h5><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 修改列名</span></span><br><span class="line">row.columns = [<span class="string">&#x27;A&#x27;</span>, <span class="string">&#x27;B&#x27;</span>, <span class="string">&#x27;C&#x27;</span>, <span class="string">&#x27;D&#x27;</span>, <span class="string">&#x27;E&#x27;</span>, <span class="string">&#x27;F&#x27;</span>, <span class="string">&#x27;G&#x27;</span>, <span class="string">&#x27;H&#x27;</span>, <span class="string">&#x27;I&#x27;</span>, <span class="string">&#x27;J&#x27;</span>]</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\n修改列名后:&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(row.head())</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">修改列名后:</span><br><span class="line">         A      B   C   D          E   F   G  H   I  J</span><br><span class="line">x  1693100   3629   6  12  2015/1/28  AA  普通  否  31  男</span><br><span class="line">y  1713229   3000  12  12  2015/1/30  AA  普通  是  24  男</span><br><span class="line">z  1904026   3629  12  12   2015/3/7  AA  普通  否  27  男</span><br><span class="line">a  2158281   3919  12  18  2015/4/14   C  普通  否  28  男</span><br><span class="line">b  2257194  14000  12  18  2015/4/23   C  普通  否  46  男</span><br></pre></td></tr></table></figure></div>

<h5 id="使用rename方法重命名列"><a href="#使用rename方法重命名列" class="headerlink" title="使用rename方法重命名列"></a>使用rename方法重命名列</h5><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用rename方法重命名列</span></span><br><span class="line">row.rename(columns=&#123;<span class="string">&#x27;A&#x27;</span>: <span class="string">&#x27;ID&#x27;</span>&#125;, inplace=<span class="literal">True</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\n使用rename方法修改列名后:&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(row)</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">使用rename方法修改列名后:</span><br><span class="line">        ID      B   C   D          E   F   G  H   I  J</span><br><span class="line">x  1693100   3629   6  12  2015/1/28  AA  普通  否  31  男</span><br><span class="line">y  1713229   3000  12  12  2015/1/30  AA  普通  是  24  男</span><br><span class="line">z  1904026   3629  12  12   2015/3/7  AA  普通  否  27  男</span><br><span class="line">a  2158281   3919  12  18  2015/4/14   C  普通  否  28  男</span><br><span class="line">b  2257194  14000  12  18  2015/4/23   C  普通  否  46  男</span><br></pre></td></tr></table></figure></div>

<h5 id="单独修改一个索引"><a href="#单独修改一个索引" class="headerlink" title="单独修改一个索引"></a>单独修改一个索引</h5><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 单独修改一个索引</span></span><br><span class="line">row.rename(index=&#123;<span class="string">&#x27;x&#x27;</span>: <span class="string">&#x27;A&#x27;</span>&#125;, inplace=<span class="literal">True</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\n单独修改一个索引后:&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(row)</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">单独修改一个索引后:</span><br><span class="line">        ID      B   C   D          E   F   G  H   I  J</span><br><span class="line">A  1693100   3629   6  12  2015/1/28  AA  普通  否  31  男</span><br><span class="line">y  1713229   3000  12  12  2015/1/30  AA  普通  是  24  男</span><br><span class="line">z  1904026   3629  12  12   2015/3/7  AA  普通  否  27  男</span><br><span class="line">a  2158281   3919  12  18  2015/4/14   C  普通  否  28  男</span><br><span class="line">b  2257194  14000  12  18  2015/4/23   C  普通  否  46  男</span><br></pre></td></tr></table></figure></div>

<h3 id="数据合并"><a href="#数据合并" class="headerlink" title="数据合并"></a>数据合并</h3><h4 id="concat-函数概览"><a href="#concat-函数概览" class="headerlink" title="concat()函数概览"></a><code>concat()</code>函数概览</h4><p><code>pd.concat()</code>可以沿着一条轴将多个对象堆叠到一起。主要参数包括：</p>
<ul>
<li><code>objs</code>：一个序列或映射，表示要合并的pandas对象。</li>
<li><code>axis</code>：默认为0，表示沿着行合并；设置为1表示沿着列合并。</li>
<li><code>ignore_index</code>：如果为True，不使用索引标签进行连接；这将对结果DataFrame使用默认整数索引。</li>
</ul>
<p>在Pandas中，<code>pd.concat()</code>函数是合并数据的一个非常有用的工具，它允许沿着特定的轴将多个DataFrame合并在一起。下面，我们将通过具体的示例来展示如何使用<code>pd.concat()</code>进行数据合并，包括沿着列(axis&#x3D;1)和沿着行(axis&#x3D;0)的合并。每个案例都将提供代码示例和预期的输出结果。</p>
<h5 id="示例数据"><a href="#示例数据" class="headerlink" title="示例数据"></a>示例数据</h5><h6 id="选择性读取行"><a href="#选择性读取行" class="headerlink" title="选择性读取行"></a>选择性读取行</h6><p>有时候，在读取文件创建DataFrame时，可能想要跳过某些行或只读取特定的行。可以通过<code>skiprows</code>和<code>nrows</code>参数来实现这一点：</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">df = pd.read_csv(<span class="string">&#x27;./LCIS.csv&#x27;</span>, skiprows=<span class="built_in">range</span>(<span class="number">1</span>, <span class="number">4</span>), nrows=<span class="number">3</span>, usecols=<span class="built_in">range</span>(<span class="number">2</span>, <span class="number">6</span>))</span><br><span class="line">res = pd.DataFrame(df)</span><br><span class="line"><span class="built_in">print</span>(res)</span><br></pre></td></tr></table></figure></div>

<p>这里，<code>skiprows=range(1, 4)</code>跳过了文件的第1到第3行（注意行数是从0开始计数的），而<code>nrows=3</code>指定了之后只读取3行。</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">借款期限  借款利率     借款成功日期 初始评级</span><br><span class="line">0    12    18  2015/4/14    C</span><br><span class="line">1    12    18  2015/4/23    C</span><br><span class="line">2     6    15  2015/4/29    B</span><br></pre></td></tr></table></figure></div>

<p>首先，让我们定义两个DataFrame，<code>row</code>和<code>res</code>，以便进行合并操作。假设这些DataFrame已经根据上文中的说明进行了加载和修改：</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="comment"># 假设这是从文件中读取的DataFrame</span></span><br><span class="line">row = pd.read_csv(<span class="string">&#x27;LCIS.csv&#x27;</span>, skiprows=<span class="built_in">range</span>(<span class="number">1</span>, <span class="number">11</span>), header=<span class="number">0</span>, nrows=<span class="number">10</span>, usecols=<span class="built_in">range</span>(<span class="number">10</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 假设res是另一个文件中读取DataFrame</span></span><br><span class="line">res = pd.read_csv(<span class="string">&#x27;LCIS.csv&#x27;</span>,skiprows=<span class="built_in">range</span>(<span class="number">12</span>, <span class="number">20</span>), header=<span class="number">0</span>, nrows=<span class="number">10</span>, usecols=<span class="built_in">range</span>(<span class="number">10</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;row DataFrame&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(row)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;=============================================&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;res DataFrame&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(res)</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">row DataFrame</span><br><span class="line">   ListingId   借款金额  借款期限  借款利率     借款成功日期 初始评级 借款类型 是否首标  年龄 性别</span><br><span class="line">0    2526671   5115    12  12.0  2015/5/23   AA   普通    否  34  男</span><br><span class="line">1    2707322   5000     3  10.0   2015/6/5   AA   普通    否  35  男</span><br><span class="line">2    2722356   3132    12  20.0  2015/6/13    D   普通    否  30  男</span><br><span class="line">3    2828736   3000    12  12.0  2015/6/19   AA   普通    是  24  男</span><br><span class="line">4    2850335  17640    18  16.0  2015/6/18    B   其他    是  28  男</span><br><span class="line">5    3155520   7008    10  11.0  2015/7/12   AA   普通    否  34  男</span><br><span class="line">6    3207478  19928    12  16.0  2015/7/14    B   其他    是  22  男</span><br><span class="line">7    3617672   7000    12  11.5  2015/8/12   AA   普通    是  43  男</span><br><span class="line">8    3637812   4000     6  10.5  2015/8/17   AA   其他    是  24  男</span><br><span class="line">9    3705094   1000    12  11.5  2015/8/21   AA   普通    是  26  男</span><br><span class="line">=============================================</span><br><span class="line">res DataFrame</span><br><span class="line">   ListingId   借款金额  借款期限  借款利率     借款成功日期 初始评级 借款类型 是否首标  年龄 性别</span><br><span class="line">0    1693100   3629     6    12  2015/1/28   AA   普通    否  31  男</span><br><span class="line">1    1713229   3000    12    12  2015/1/30   AA   普通    是  24  男</span><br><span class="line">2    1904026   3629    12    12   2015/3/7   AA   普通    否  27  男</span><br><span class="line">3    2158281   3919    12    18  2015/4/14    C   普通    否  28  男</span><br><span class="line">4    2257194  14000    12    18  2015/4/23    C   普通    否  46  男</span><br><span class="line">5    2272036  40000     6    15  2015/4/29    B   电商    是  32  男</span><br><span class="line">6    2315058   3200     3    10  2015/4/29   AA   普通    否  25  男</span><br><span class="line">7    2332817   3000     6    12   2015/5/6   AA   普通    是  38  男</span><br><span class="line">8    2365175   4260     7    12   2015/5/6   AA   普通    否  25  男</span><br><span class="line">9    2370723  11987    12    16   2015/5/7    B   其他    否  33  女</span><br></pre></td></tr></table></figure></div>

<h5 id="沿着列合并DataFrame"><a href="#沿着列合并DataFrame" class="headerlink" title="沿着列合并DataFrame"></a>沿着列合并DataFrame</h5><p>当想要将两个DataFrame按列拼接（即并排放置），可以设置<code>axis=1</code>。这通常用于合并具有相同索引的DataFrame，但列不同的情况。</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">num = pd.concat([row, res], axis=<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(num)</span><br></pre></td></tr></table></figure></div>

<p>预期输出是<code>row</code>和<code>res</code>DataFrame并排放置的结果，这里由于<code>row</code>和<code>res</code>的行数相同，因此可以直接并排合并。</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">   ListingId   借款金额  借款期限  借款利率     借款成功日期 初始评级 借款类型 是否首标  年龄 性别  ListingId  \</span><br><span class="line">0    2526671   5115    12  12.0  2015/5/23   AA   普通    否  34  男    1693100   </span><br><span class="line">1    2707322   5000     3  10.0   2015/6/5   AA   普通    否  35  男    1713229   </span><br><span class="line">2    2722356   3132    12  20.0  2015/6/13    D   普通    否  30  男    1904026   </span><br><span class="line">3    2828736   3000    12  12.0  2015/6/19   AA   普通    是  24  男    2158281   </span><br><span class="line">4    2850335  17640    18  16.0  2015/6/18    B   其他    是  28  男    2257194   </span><br><span class="line">5    3155520   7008    10  11.0  2015/7/12   AA   普通    否  34  男    2272036   </span><br><span class="line">6    3207478  19928    12  16.0  2015/7/14    B   其他    是  22  男    2315058   </span><br><span class="line">7    3617672   7000    12  11.5  2015/8/12   AA   普通    是  43  男    2332817   </span><br><span class="line">8    3637812   4000     6  10.5  2015/8/17   AA   其他    是  24  男    2365175   </span><br><span class="line">9    3705094   1000    12  11.5  2015/8/21   AA   普通    是  26  男    2370723   </span><br><span class="line"></span><br><span class="line">    借款金额  借款期限  借款利率     借款成功日期 初始评级 借款类型 是否首标  年龄 性别  </span><br><span class="line">0   3629     6    12  2015/1/28   AA   普通    否  31  男  </span><br><span class="line">1   3000    12    12  2015/1/30   AA   普通    是  24  男  </span><br><span class="line">2   3629    12    12   2015/3/7   AA   普通    否  27  男  </span><br><span class="line">3   3919    12    18  2015/4/14    C   普通    否  28  男  </span><br><span class="line">4  14000    12    18  2015/4/23    C   普通    否  46  男  </span><br><span class="line">5  40000     6    15  2015/4/29    B   电商    是  32  男  </span><br><span class="line">6   3200     3    10  2015/4/29   AA   普通    否  25  男  </span><br><span class="line">7   3000     6    12   2015/5/6   AA   普通    是  38  男  </span><br><span class="line">8   4260     7    12   2015/5/6   AA   普通    否  25  男  </span><br><span class="line">9  11987    12    16   2015/5/7    B   其他    否  33  女  </span><br></pre></td></tr></table></figure></div>

<h5 id="沿着行合并DataFrame"><a href="#沿着行合并DataFrame" class="headerlink" title="沿着行合并DataFrame"></a>沿着行合并DataFrame</h5><p>如果想将两个DataFrame上下拼接，可以设置<code>axis=0</code>。这通常用于合并具有相同列的DataFrame，或者即使列不完全相同也可以合并，Pandas会自动处理不匹配的列。</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">num = pd.concat([row, res], axis=<span class="number">0</span>)</span><br><span class="line"><span class="built_in">print</span>(num)</span><br></pre></td></tr></table></figure></div>

<p>在这个例子中，由于<code>res</code>仅包含<code>row</code>的部分列，合并结果会展示所有列，不在<code>res</code>中的列对应的行会显示为NaN。</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">   ListingId   借款金额  借款期限  借款利率     借款成功日期 初始评级 借款类型 是否首标  年龄 性别</span><br><span class="line">0    2526671   5115    12  12.0  2015/5/23   AA   普通    否  34  男</span><br><span class="line">1    2707322   5000     3  10.0   2015/6/5   AA   普通    否  35  男</span><br><span class="line">2    2722356   3132    12  20.0  2015/6/13    D   普通    否  30  男</span><br><span class="line">3    2828736   3000    12  12.0  2015/6/19   AA   普通    是  24  男</span><br><span class="line">4    2850335  17640    18  16.0  2015/6/18    B   其他    是  28  男</span><br><span class="line">5    3155520   7008    10  11.0  2015/7/12   AA   普通    否  34  男</span><br><span class="line">6    3207478  19928    12  16.0  2015/7/14    B   其他    是  22  男</span><br><span class="line">7    3617672   7000    12  11.5  2015/8/12   AA   普通    是  43  男</span><br><span class="line">8    3637812   4000     6  10.5  2015/8/17   AA   其他    是  24  男</span><br><span class="line">9    3705094   1000    12  11.5  2015/8/21   AA   普通    是  26  男</span><br><span class="line">0    1693100   3629     6  12.0  2015/1/28   AA   普通    否  31  男</span><br><span class="line">1    1713229   3000    12  12.0  2015/1/30   AA   普通    是  24  男</span><br><span class="line">2    1904026   3629    12  12.0   2015/3/7   AA   普通    否  27  男</span><br><span class="line">3    2158281   3919    12  18.0  2015/4/14    C   普通    否  28  男</span><br><span class="line">4    2257194  14000    12  18.0  2015/4/23    C   普通    否  46  男</span><br><span class="line">5    2272036  40000     6  15.0  2015/4/29    B   电商    是  32  男</span><br><span class="line">6    2315058   3200     3  10.0  2015/4/29   AA   普通    否  25  男</span><br><span class="line">7    2332817   3000     6  12.0   2015/5/6   AA   普通    是  38  男</span><br><span class="line">8    2365175   4260     7  12.0   2015/5/6   AA   普通    否  25  男</span><br><span class="line">9    2370723  11987    12  16.0   2015/5/7    B   其他    否  33  女</span><br></pre></td></tr></table></figure></div>

<h5 id="重置索引以避免索引重复"><a href="#重置索引以避免索引重复" class="headerlink" title="重置索引以避免索引重复"></a>重置索引以避免索引重复</h5><p>在进行行合并时，如果不希望保留原始的索引，可以设置<code>ignore_index=True</code>，以避免索引重复的问题。</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">num = pd.concat([row, res], axis=<span class="number">0</span>, ignore_index=<span class="literal">True</span>)</span><br><span class="line"><span class="built_in">print</span>(num)</span><br></pre></td></tr></table></figure></div>

<p>这会创建一个新的DataFrame，其中索引是重新生成的，从0开始，避免了任何索引重复的问题。</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">    ListingId   借款金额  借款期限  借款利率     借款成功日期 初始评级 借款类型 是否首标  年龄 性别</span><br><span class="line">0     2526671   5115    12  12.0  2015/5/23   AA   普通    否  34  男</span><br><span class="line">1     2707322   5000     3  10.0   2015/6/5   AA   普通    否  35  男</span><br><span class="line">2     2722356   3132    12  20.0  2015/6/13    D   普通    否  30  男</span><br><span class="line">3     2828736   3000    12  12.0  2015/6/19   AA   普通    是  24  男</span><br><span class="line">4     2850335  17640    18  16.0  2015/6/18    B   其他    是  28  男</span><br><span class="line">5     3155520   7008    10  11.0  2015/7/12   AA   普通    否  34  男</span><br><span class="line">6     3207478  19928    12  16.0  2015/7/14    B   其他    是  22  男</span><br><span class="line">7     3617672   7000    12  11.5  2015/8/12   AA   普通    是  43  男</span><br><span class="line">8     3637812   4000     6  10.5  2015/8/17   AA   其他    是  24  男</span><br><span class="line">9     3705094   1000    12  11.5  2015/8/21   AA   普通    是  26  男</span><br><span class="line">10    1693100   3629     6  12.0  2015/1/28   AA   普通    否  31  男</span><br><span class="line">11    1713229   3000    12  12.0  2015/1/30   AA   普通    是  24  男</span><br><span class="line">12    1904026   3629    12  12.0   2015/3/7   AA   普通    否  27  男</span><br><span class="line">13    2158281   3919    12  18.0  2015/4/14    C   普通    否  28  男</span><br><span class="line">14    2257194  14000    12  18.0  2015/4/23    C   普通    否  46  男</span><br><span class="line">15    2272036  40000     6  15.0  2015/4/29    B   电商    是  32  男</span><br><span class="line">16    2315058   3200     3  10.0  2015/4/29   AA   普通    否  25  男</span><br><span class="line">17    2332817   3000     6  12.0   2015/5/6   AA   普通    是  38  男</span><br><span class="line">18    2365175   4260     7  12.0   2015/5/6   AA   普通    否  25  男</span><br><span class="line">19    2370723  11987    12  16.0   2015/5/7    B   其他    否  33  女</span><br></pre></td></tr></table></figure></div>

<h4 id="merge"><a href="#merge" class="headerlink" title="merge()"></a><code>merge()</code></h4><p>在Pandas中，<code>pd.merge()</code>函数提供了一个强大的方式来合并两个DataFrame，基于一个或多个共同的键。下面，将详细介绍如何使用<code>pd.merge()</code>进行数据合并，包括基于相同列的简单合并、处理行的选择性读取、以及基于不同列名进行合并。每个案例都会提供代码示例和预期的输出。</p>
<h5 id="示例数据-1"><a href="#示例数据-1" class="headerlink" title="示例数据"></a>示例数据</h5><p>使用concat()示例中同样的数据</p>
<h5 id="基于共同列合并DataFrame"><a href="#基于共同列合并DataFrame" class="headerlink" title="基于共同列合并DataFrame"></a>基于共同列合并DataFrame</h5><p>当两个DataFrame具有至少一个共同的列时，可以使用这个共同列作为合并的基础。以下是如何根据共同列<code>&#39;借款期限&#39;</code>合并两个DataFrame的示例：</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="comment"># 假设row和res是concat()示例中已经加载的DataFrame，且它们有一个共同列&#x27;借款期限&#x27;</span></span><br><span class="line">num = pd.merge(row, res, on=<span class="string">&#x27;借款期限&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(num)</span><br></pre></td></tr></table></figure></div>

<p>在这个示例中，<code>pd.merge()</code>通过<code>on=&#39;借款期限&#39;</code>参数指定了合并的基础列。这将只保留那些在两个DataFrame中都存在的<code>&#39;借款期限&#39;</code>值的行。</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line">    ListingId_x  借款金额_x  借款期限  借款利率_x   借款成功日期_x 初始评级_x 借款类型_x 是否首标_x  年龄_x  \</span><br><span class="line">0       2526671    5115    12    12.0  2015/5/23     AA     普通      否    34   </span><br><span class="line">1       2526671    5115    12    12.0  2015/5/23     AA     普通      否    34   </span><br><span class="line">2       2526671    5115    12    12.0  2015/5/23     AA     普通      否    34   </span><br><span class="line">3       2526671    5115    12    12.0  2015/5/23     AA     普通      否    34   </span><br><span class="line">4       2526671    5115    12    12.0  2015/5/23     AA     普通      否    34   </span><br><span class="line">5       2722356    3132    12    20.0  2015/6/13      D     普通      否    30   </span><br><span class="line">6       2722356    3132    12    20.0  2015/6/13      D     普通      否    30   </span><br><span class="line">7       2722356    3132    12    20.0  2015/6/13      D     普通      否    30   </span><br><span class="line">8       2722356    3132    12    20.0  2015/6/13      D     普通      否    30   </span><br><span class="line">9       2722356    3132    12    20.0  2015/6/13      D     普通      否    30   </span><br><span class="line">10      2828736    3000    12    12.0  2015/6/19     AA     普通      是    24   </span><br><span class="line">11      2828736    3000    12    12.0  2015/6/19     AA     普通      是    24   </span><br><span class="line">12      2828736    3000    12    12.0  2015/6/19     AA     普通      是    24   </span><br><span class="line">13      2828736    3000    12    12.0  2015/6/19     AA     普通      是    24   </span><br><span class="line">14      2828736    3000    12    12.0  2015/6/19     AA     普通      是    24   </span><br><span class="line">15      3207478   19928    12    16.0  2015/7/14      B     其他      是    22   </span><br><span class="line">16      3207478   19928    12    16.0  2015/7/14      B     其他      是    22   </span><br><span class="line">17      3207478   19928    12    16.0  2015/7/14      B     其他      是    22   </span><br><span class="line">18      3207478   19928    12    16.0  2015/7/14      B     其他      是    22   </span><br><span class="line">19      3207478   19928    12    16.0  2015/7/14      B     其他      是    22   </span><br><span class="line">20      3617672    7000    12    11.5  2015/8/12     AA     普通      是    43   </span><br><span class="line">21      3617672    7000    12    11.5  2015/8/12     AA     普通      是    43   </span><br><span class="line">22      3617672    7000    12    11.5  2015/8/12     AA     普通      是    43   </span><br><span class="line">23      3617672    7000    12    11.5  2015/8/12     AA     普通      是    43   </span><br><span class="line">24      3617672    7000    12    11.5  2015/8/12     AA     普通      是    43   </span><br><span class="line">25      3705094    1000    12    11.5  2015/8/21     AA     普通      是    26   </span><br><span class="line">26      3705094    1000    12    11.5  2015/8/21     AA     普通      是    26   </span><br><span class="line">27      3705094    1000    12    11.5  2015/8/21     AA     普通      是    26   </span><br><span class="line">28      3705094    1000    12    11.5  2015/8/21     AA     普通      是    26   </span><br><span class="line">29      3705094    1000    12    11.5  2015/8/21     AA     普通      是    26   </span><br><span class="line">30      2707322    5000     3    10.0   2015/6/5     AA     普通      否    35   </span><br><span class="line">31      3637812    4000     6    10.5  2015/8/17     AA     其他      是    24   </span><br><span class="line">32      3637812    4000     6    10.5  2015/8/17     AA     其他      是    24   </span><br><span class="line">33      3637812    4000     6    10.5  2015/8/17     AA     其他      是    24   </span><br><span class="line"></span><br><span class="line">   性别_x  ListingId_y  借款金额_y  借款利率_y   借款成功日期_y 初始评级_y 借款类型_y 是否首标_y  年龄_y  \</span><br><span class="line">0     男      1713229    3000      12  2015/1/30     AA     普通      是    24   </span><br><span class="line">1     男      1904026    3629      12   2015/3/7     AA     普通      否    27   </span><br><span class="line">2     男      2158281    3919      18  2015/4/14      C     普通      否    28   </span><br><span class="line">3     男      2257194   14000      18  2015/4/23      C     普通      否    46   </span><br><span class="line">4     男      2370723   11987      16   2015/5/7      B     其他      否    33   </span><br><span class="line">5     男      1713229    3000      12  2015/1/30     AA     普通      是    24   </span><br><span class="line">6     男      1904026    3629      12   2015/3/7     AA     普通      否    27   </span><br><span class="line">7     男      2158281    3919      18  2015/4/14      C     普通      否    28   </span><br><span class="line">8     男      2257194   14000      18  2015/4/23      C     普通      否    46   </span><br><span class="line">9     男      2370723   11987      16   2015/5/7      B     其他      否    33   </span><br><span class="line">10    男      1713229    3000      12  2015/1/30     AA     普通      是    24   </span><br><span class="line">11    男      1904026    3629      12   2015/3/7     AA     普通      否    27   </span><br><span class="line">12    男      2158281    3919      18  2015/4/14      C     普通      否    28   </span><br><span class="line">13    男      2257194   14000      18  2015/4/23      C     普通      否    46   </span><br><span class="line">14    男      2370723   11987      16   2015/5/7      B     其他      否    33   </span><br><span class="line">15    男      1713229    3000      12  2015/1/30     AA     普通      是    24   </span><br><span class="line">16    男      1904026    3629      12   2015/3/7     AA     普通      否    27   </span><br><span class="line">17    男      2158281    3919      18  2015/4/14      C     普通      否    28   </span><br><span class="line">18    男      2257194   14000      18  2015/4/23      C     普通      否    46   </span><br><span class="line">19    男      2370723   11987      16   2015/5/7      B     其他      否    33   </span><br><span class="line">20    男      1713229    3000      12  2015/1/30     AA     普通      是    24   </span><br><span class="line">21    男      1904026    3629      12   2015/3/7     AA     普通      否    27   </span><br><span class="line">22    男      2158281    3919      18  2015/4/14      C     普通      否    28   </span><br><span class="line">23    男      2257194   14000      18  2015/4/23      C     普通      否    46   </span><br><span class="line">24    男      2370723   11987      16   2015/5/7      B     其他      否    33   </span><br><span class="line">25    男      1713229    3000      12  2015/1/30     AA     普通      是    24   </span><br><span class="line">26    男      1904026    3629      12   2015/3/7     AA     普通      否    27   </span><br><span class="line">27    男      2158281    3919      18  2015/4/14      C     普通      否    28   </span><br><span class="line">28    男      2257194   14000      18  2015/4/23      C     普通      否    46   </span><br><span class="line">29    男      2370723   11987      16   2015/5/7      B     其他      否    33   </span><br><span class="line">30    男      2315058    3200      10  2015/4/29     AA     普通      否    25   </span><br><span class="line">31    男      1693100    3629      12  2015/1/28     AA     普通      否    31   </span><br><span class="line">32    男      2272036   40000      15  2015/4/29      B     电商      是    32   </span><br><span class="line">33    男      2332817    3000      12   2015/5/6     AA     普通      是    38   </span><br><span class="line"></span><br><span class="line">   性别_y  </span><br><span class="line">0     男  </span><br><span class="line">1     男  </span><br><span class="line">2     男  </span><br><span class="line">3     男  </span><br><span class="line">4     女  </span><br><span class="line">5     男  </span><br><span class="line">6     男  </span><br><span class="line">7     男  </span><br><span class="line">8     男  </span><br><span class="line">9     女  </span><br><span class="line">10    男  </span><br><span class="line">11    男  </span><br><span class="line">12    男  </span><br><span class="line">13    男  </span><br><span class="line">14    女  </span><br><span class="line">15    男  </span><br><span class="line">16    男  </span><br><span class="line">17    男  </span><br><span class="line">18    男  </span><br><span class="line">19    女  </span><br><span class="line">20    男  </span><br><span class="line">21    男  </span><br><span class="line">22    男  </span><br><span class="line">23    男  </span><br><span class="line">24    女  </span><br><span class="line">25    男  </span><br><span class="line">26    男  </span><br><span class="line">27    男  </span><br><span class="line">28    男  </span><br><span class="line">29    女  </span><br><span class="line">30    男  </span><br><span class="line">31    男  </span><br><span class="line">32    男  </span><br><span class="line">33    男  </span><br></pre></td></tr></table></figure></div>

<h5 id="基于不同列名的合并"><a href="#基于不同列名的合并" class="headerlink" title="基于不同列名的合并"></a>基于不同列名的合并</h5><p>如果两个DataFrame要合并的列名不同，可以分别使用<code>left_on</code>和<code>right_on</code>参数来指定各自的列名：</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">num = pd.merge(row, res, left_on=<span class="string">&#x27;借款期限&#x27;</span>, right_on=<span class="string">&#x27;借款利率&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(num)</span><br></pre></td></tr></table></figure></div>

<p>在这个例子中，尽管<code>row</code>和<code>res</code>中要合并的列名不同，但通过<code>left_on</code>和<code>right_on</code>参数，我们能够指定如何将两个DataFrame基于对应列的值进行合并。</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line">    ListingId_x  借款金额_x  借款期限_x  借款利率_x   借款成功日期_x 初始评级_x 借款类型_x 是否首标_x  年龄_x  \</span><br><span class="line">0       2526671    5115      12    12.0  2015/5/23     AA     普通      否    34   </span><br><span class="line">1       2526671    5115      12    12.0  2015/5/23     AA     普通      否    34   </span><br><span class="line">2       2526671    5115      12    12.0  2015/5/23     AA     普通      否    34   </span><br><span class="line">3       2526671    5115      12    12.0  2015/5/23     AA     普通      否    34   </span><br><span class="line">4       2526671    5115      12    12.0  2015/5/23     AA     普通      否    34   </span><br><span class="line">5       2722356    3132      12    20.0  2015/6/13      D     普通      否    30   </span><br><span class="line">6       2722356    3132      12    20.0  2015/6/13      D     普通      否    30   </span><br><span class="line">7       2722356    3132      12    20.0  2015/6/13      D     普通      否    30   </span><br><span class="line">8       2722356    3132      12    20.0  2015/6/13      D     普通      否    30   </span><br><span class="line">9       2722356    3132      12    20.0  2015/6/13      D     普通      否    30   </span><br><span class="line">10      2828736    3000      12    12.0  2015/6/19     AA     普通      是    24   </span><br><span class="line">11      2828736    3000      12    12.0  2015/6/19     AA     普通      是    24   </span><br><span class="line">12      2828736    3000      12    12.0  2015/6/19     AA     普通      是    24   </span><br><span class="line">13      2828736    3000      12    12.0  2015/6/19     AA     普通      是    24   </span><br><span class="line">14      2828736    3000      12    12.0  2015/6/19     AA     普通      是    24   </span><br><span class="line">15      3207478   19928      12    16.0  2015/7/14      B     其他      是    22   </span><br><span class="line">16      3207478   19928      12    16.0  2015/7/14      B     其他      是    22   </span><br><span class="line">17      3207478   19928      12    16.0  2015/7/14      B     其他      是    22   </span><br><span class="line">18      3207478   19928      12    16.0  2015/7/14      B     其他      是    22   </span><br><span class="line">19      3207478   19928      12    16.0  2015/7/14      B     其他      是    22   </span><br><span class="line">20      3617672    7000      12    11.5  2015/8/12     AA     普通      是    43   </span><br><span class="line">21      3617672    7000      12    11.5  2015/8/12     AA     普通      是    43   </span><br><span class="line">22      3617672    7000      12    11.5  2015/8/12     AA     普通      是    43   </span><br><span class="line">23      3617672    7000      12    11.5  2015/8/12     AA     普通      是    43   </span><br><span class="line">24      3617672    7000      12    11.5  2015/8/12     AA     普通      是    43   </span><br><span class="line">25      3705094    1000      12    11.5  2015/8/21     AA     普通      是    26   </span><br><span class="line">26      3705094    1000      12    11.5  2015/8/21     AA     普通      是    26   </span><br><span class="line">27      3705094    1000      12    11.5  2015/8/21     AA     普通      是    26   </span><br><span class="line">28      3705094    1000      12    11.5  2015/8/21     AA     普通      是    26   </span><br><span class="line">29      3705094    1000      12    11.5  2015/8/21     AA     普通      是    26   </span><br><span class="line">30      2850335   17640      18    16.0  2015/6/18      B     其他      是    28   </span><br><span class="line">31      2850335   17640      18    16.0  2015/6/18      B     其他      是    28   </span><br><span class="line">32      3155520    7008      10    11.0  2015/7/12     AA     普通      否    34   </span><br><span class="line"></span><br><span class="line">   性别_x  ListingId_y  借款金额_y  借款期限_y  借款利率_y   借款成功日期_y 初始评级_y 借款类型_y 是否首标_y  \</span><br><span class="line">0     男      1693100    3629       6      12  2015/1/28     AA     普通      否   </span><br><span class="line">1     男      1713229    3000      12      12  2015/1/30     AA     普通      是   </span><br><span class="line">2     男      1904026    3629      12      12   2015/3/7     AA     普通      否   </span><br><span class="line">3     男      2332817    3000       6      12   2015/5/6     AA     普通      是   </span><br><span class="line">4     男      2365175    4260       7      12   2015/5/6     AA     普通      否   </span><br><span class="line">5     男      1693100    3629       6      12  2015/1/28     AA     普通      否   </span><br><span class="line">6     男      1713229    3000      12      12  2015/1/30     AA     普通      是   </span><br><span class="line">7     男      1904026    3629      12      12   2015/3/7     AA     普通      否   </span><br><span class="line">8     男      2332817    3000       6      12   2015/5/6     AA     普通      是   </span><br><span class="line">9     男      2365175    4260       7      12   2015/5/6     AA     普通      否   </span><br><span class="line">10    男      1693100    3629       6      12  2015/1/28     AA     普通      否   </span><br><span class="line">11    男      1713229    3000      12      12  2015/1/30     AA     普通      是   </span><br><span class="line">12    男      1904026    3629      12      12   2015/3/7     AA     普通      否   </span><br><span class="line">13    男      2332817    3000       6      12   2015/5/6     AA     普通      是   </span><br><span class="line">14    男      2365175    4260       7      12   2015/5/6     AA     普通      否   </span><br><span class="line">15    男      1693100    3629       6      12  2015/1/28     AA     普通      否   </span><br><span class="line">16    男      1713229    3000      12      12  2015/1/30     AA     普通      是   </span><br><span class="line">17    男      1904026    3629      12      12   2015/3/7     AA     普通      否   </span><br><span class="line">18    男      2332817    3000       6      12   2015/5/6     AA     普通      是   </span><br><span class="line">19    男      2365175    4260       7      12   2015/5/6     AA     普通      否   </span><br><span class="line">20    男      1693100    3629       6      12  2015/1/28     AA     普通      否   </span><br><span class="line">21    男      1713229    3000      12      12  2015/1/30     AA     普通      是   </span><br><span class="line">22    男      1904026    3629      12      12   2015/3/7     AA     普通      否   </span><br><span class="line">23    男      2332817    3000       6      12   2015/5/6     AA     普通      是   </span><br><span class="line">24    男      2365175    4260       7      12   2015/5/6     AA     普通      否   </span><br><span class="line">25    男      1693100    3629       6      12  2015/1/28     AA     普通      否   </span><br><span class="line">26    男      1713229    3000      12      12  2015/1/30     AA     普通      是   </span><br><span class="line">27    男      1904026    3629      12      12   2015/3/7     AA     普通      否   </span><br><span class="line">28    男      2332817    3000       6      12   2015/5/6     AA     普通      是   </span><br><span class="line">29    男      2365175    4260       7      12   2015/5/6     AA     普通      否   </span><br><span class="line">30    男      2158281    3919      12      18  2015/4/14      C     普通      否   </span><br><span class="line">31    男      2257194   14000      12      18  2015/4/23      C     普通      否   </span><br><span class="line">32    男      2315058    3200       3      10  2015/4/29     AA     普通      否   </span><br><span class="line"></span><br><span class="line">    年龄_y 性别_y  </span><br><span class="line">0     31    男  </span><br><span class="line">1     24    男  </span><br><span class="line">2     27    男  </span><br><span class="line">3     38    男  </span><br><span class="line">4     25    男  </span><br><span class="line">5     31    男  </span><br><span class="line">6     24    男  </span><br><span class="line">7     27    男  </span><br><span class="line">8     38    男  </span><br><span class="line">9     25    男  </span><br><span class="line">10    31    男  </span><br><span class="line">11    24    男  </span><br><span class="line">12    27    男  </span><br><span class="line">13    38    男  </span><br><span class="line">14    25    男  </span><br><span class="line">15    31    男  </span><br><span class="line">16    24    男  </span><br><span class="line">17    27    男  </span><br><span class="line">18    38    男  </span><br><span class="line">19    25    男  </span><br><span class="line">20    31    男  </span><br><span class="line">21    24    男  </span><br><span class="line">22    27    男  </span><br><span class="line">23    38    男  </span><br><span class="line">24    25    男  </span><br><span class="line">25    31    男  </span><br><span class="line">26    24    男  </span><br><span class="line">27    27    男  </span><br><span class="line">28    38    男  </span><br><span class="line">29    25    男  </span><br><span class="line">30    28    男  </span><br><span class="line">31    46    男  </span><br><span class="line">32    25    男  </span><br></pre></td></tr></table></figure></div>

<h5 id="指定合并方式"><a href="#指定合并方式" class="headerlink" title="指定合并方式"></a>指定合并方式</h5><p><code>pd.merge()</code>允许通过<code>how</code>参数来指定合并方式，包括<code>&#39;inner&#39;</code>（内连接）、<code>&#39;outer&#39;</code>（外连接）、<code>&#39;left&#39;</code>（左连接）和<code>&#39;right&#39;</code>（右连接）：</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">num = pd.merge(row, res, left_on=<span class="string">&#x27;借款期限&#x27;</span>, right_on=<span class="string">&#x27;借款利率&#x27;</span>, how=<span class="string">&#x27;inner&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(num)</span><br></pre></td></tr></table></figure></div>

<p>这里，<code>how=&#39;inner&#39;</code>意味着结果中只包含那些两个DataFrame在指定列上都有匹配值的行。不同的<code>how</code>值可以根据需要选择，以实现不同的合并逻辑。</p>
<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line">    ListingId_x  借款金额_x  借款期限_x  借款利率_x   借款成功日期_x 初始评级_x 借款类型_x 是否首标_x  年龄_x  \</span><br><span class="line">0       2526671    5115      12    12.0  2015/5/23     AA     普通      否    34   </span><br><span class="line">1       2526671    5115      12    12.0  2015/5/23     AA     普通      否    34   </span><br><span class="line">2       2526671    5115      12    12.0  2015/5/23     AA     普通      否    34   </span><br><span class="line">3       2526671    5115      12    12.0  2015/5/23     AA     普通      否    34   </span><br><span class="line">4       2526671    5115      12    12.0  2015/5/23     AA     普通      否    34   </span><br><span class="line">5       2722356    3132      12    20.0  2015/6/13      D     普通      否    30   </span><br><span class="line">6       2722356    3132      12    20.0  2015/6/13      D     普通      否    30   </span><br><span class="line">7       2722356    3132      12    20.0  2015/6/13      D     普通      否    30   </span><br><span class="line">8       2722356    3132      12    20.0  2015/6/13      D     普通      否    30   </span><br><span class="line">9       2722356    3132      12    20.0  2015/6/13      D     普通      否    30   </span><br><span class="line">10      2828736    3000      12    12.0  2015/6/19     AA     普通      是    24   </span><br><span class="line">11      2828736    3000      12    12.0  2015/6/19     AA     普通      是    24   </span><br><span class="line">12      2828736    3000      12    12.0  2015/6/19     AA     普通      是    24   </span><br><span class="line">13      2828736    3000      12    12.0  2015/6/19     AA     普通      是    24   </span><br><span class="line">14      2828736    3000      12    12.0  2015/6/19     AA     普通      是    24   </span><br><span class="line">15      3207478   19928      12    16.0  2015/7/14      B     其他      是    22   </span><br><span class="line">16      3207478   19928      12    16.0  2015/7/14      B     其他      是    22   </span><br><span class="line">17      3207478   19928      12    16.0  2015/7/14      B     其他      是    22   </span><br><span class="line">18      3207478   19928      12    16.0  2015/7/14      B     其他      是    22   </span><br><span class="line">19      3207478   19928      12    16.0  2015/7/14      B     其他      是    22   </span><br><span class="line">20      3617672    7000      12    11.5  2015/8/12     AA     普通      是    43   </span><br><span class="line">21      3617672    7000      12    11.5  2015/8/12     AA     普通      是    43   </span><br><span class="line">22      3617672    7000      12    11.5  2015/8/12     AA     普通      是    43   </span><br><span class="line">23      3617672    7000      12    11.5  2015/8/12     AA     普通      是    43   </span><br><span class="line">24      3617672    7000      12    11.5  2015/8/12     AA     普通      是    43   </span><br><span class="line">25      3705094    1000      12    11.5  2015/8/21     AA     普通      是    26   </span><br><span class="line">26      3705094    1000      12    11.5  2015/8/21     AA     普通      是    26   </span><br><span class="line">27      3705094    1000      12    11.5  2015/8/21     AA     普通      是    26   </span><br><span class="line">28      3705094    1000      12    11.5  2015/8/21     AA     普通      是    26   </span><br><span class="line">29      3705094    1000      12    11.5  2015/8/21     AA     普通      是    26   </span><br><span class="line">30      2850335   17640      18    16.0  2015/6/18      B     其他      是    28   </span><br><span class="line">31      2850335   17640      18    16.0  2015/6/18      B     其他      是    28   </span><br><span class="line">32      3155520    7008      10    11.0  2015/7/12     AA     普通      否    34   </span><br><span class="line"></span><br><span class="line">   性别_x  ListingId_y  借款金额_y  借款期限_y  借款利率_y   借款成功日期_y 初始评级_y 借款类型_y 是否首标_y  \</span><br><span class="line">0     男      1693100    3629       6      12  2015/1/28     AA     普通      否   </span><br><span class="line">1     男      1713229    3000      12      12  2015/1/30     AA     普通      是   </span><br><span class="line">2     男      1904026    3629      12      12   2015/3/7     AA     普通      否   </span><br><span class="line">3     男      2332817    3000       6      12   2015/5/6     AA     普通      是   </span><br><span class="line">4     男      2365175    4260       7      12   2015/5/6     AA     普通      否   </span><br><span class="line">5     男      1693100    3629       6      12  2015/1/28     AA     普通      否   </span><br><span class="line">6     男      1713229    3000      12      12  2015/1/30     AA     普通      是   </span><br><span class="line">7     男      1904026    3629      12      12   2015/3/7     AA     普通      否   </span><br><span class="line">8     男      2332817    3000       6      12   2015/5/6     AA     普通      是   </span><br><span class="line">9     男      2365175    4260       7      12   2015/5/6     AA     普通      否   </span><br><span class="line">10    男      1693100    3629       6      12  2015/1/28     AA     普通      否   </span><br><span class="line">11    男      1713229    3000      12      12  2015/1/30     AA     普通      是   </span><br><span class="line">12    男      1904026    3629      12      12   2015/3/7     AA     普通      否   </span><br><span class="line">13    男      2332817    3000       6      12   2015/5/6     AA     普通      是   </span><br><span class="line">14    男      2365175    4260       7      12   2015/5/6     AA     普通      否   </span><br><span class="line">15    男      1693100    3629       6      12  2015/1/28     AA     普通      否   </span><br><span class="line">16    男      1713229    3000      12      12  2015/1/30     AA     普通      是   </span><br><span class="line">17    男      1904026    3629      12      12   2015/3/7     AA     普通      否   </span><br><span class="line">18    男      2332817    3000       6      12   2015/5/6     AA     普通      是   </span><br><span class="line">19    男      2365175    4260       7      12   2015/5/6     AA     普通      否   </span><br><span class="line">20    男      1693100    3629       6      12  2015/1/28     AA     普通      否   </span><br><span class="line">21    男      1713229    3000      12      12  2015/1/30     AA     普通      是   </span><br><span class="line">22    男      1904026    3629      12      12   2015/3/7     AA     普通      否   </span><br><span class="line">23    男      2332817    3000       6      12   2015/5/6     AA     普通      是   </span><br><span class="line">24    男      2365175    4260       7      12   2015/5/6     AA     普通      否   </span><br><span class="line">25    男      1693100    3629       6      12  2015/1/28     AA     普通      否   </span><br><span class="line">26    男      1713229    3000      12      12  2015/1/30     AA     普通      是   </span><br><span class="line">27    男      1904026    3629      12      12   2015/3/7     AA     普通      否   </span><br><span class="line">28    男      2332817    3000       6      12   2015/5/6     AA     普通      是   </span><br><span class="line">29    男      2365175    4260       7      12   2015/5/6     AA     普通      否   </span><br><span class="line">30    男      2158281    3919      12      18  2015/4/14      C     普通      否   </span><br><span class="line">31    男      2257194   14000      12      18  2015/4/23      C     普通      否   </span><br><span class="line">32    男      2315058    3200       3      10  2015/4/29     AA     普通      否   </span><br><span class="line"></span><br><span class="line">    年龄_y 性别_y  </span><br><span class="line">0     31    男  </span><br><span class="line">1     24    男  </span><br><span class="line">2     27    男  </span><br><span class="line">3     38    男  </span><br><span class="line">4     25    男  </span><br><span class="line">5     31    男  </span><br><span class="line">6     24    男  </span><br><span class="line">7     27    男  </span><br><span class="line">8     38    男  </span><br><span class="line">9     25    男  </span><br><span class="line">10    31    男  </span><br><span class="line">11    24    男  </span><br><span class="line">12    27    男  </span><br><span class="line">13    38    男  </span><br><span class="line">14    25    男  </span><br><span class="line">15    31    男  </span><br><span class="line">16    24    男  </span><br><span class="line">17    27    男  </span><br><span class="line">18    38    男  </span><br><span class="line">19    25    男  </span><br><span class="line">20    31    男  </span><br><span class="line">21    24    男  </span><br><span class="line">22    27    男  </span><br><span class="line">23    38    男  </span><br><span class="line">24    25    男  </span><br><span class="line">25    31    男  </span><br><span class="line">26    24    男  </span><br><span class="line">27    27    男  </span><br><span class="line">28    38    男  </span><br><span class="line">29    25    男  </span><br><span class="line">30    28    男  </span><br><span class="line">31    46    男  </span><br><span class="line">32    25    男  </span><br></pre></td></tr></table></figure></div>

<p>通过上述示例，可以看到<code>pd.merge()</code>在Pandas中合并数据时的灵活性和强大功能。这些基础知识使得在进行数据分析和处理时，能够根据实际需求选择合适的合并策略。</p>
<h4 id="join"><a href="#join" class="headerlink" title="join()"></a><code>join()</code></h4><p>在Pandas中，<code>join()</code>函数是用于将两个或多个DataFrame按照索引合并。这个函数默认执行的是左连接操作，即以调用<code>join()</code>的DataFrame的索引为基准。不过，可以通过<code>how</code>参数来指定连接类型，包括<code>left</code>（左连接）、<code>right</code>（右连接）、<code>inner</code>（内连接）和<code>outer</code>（外连接）。</p>

  <div class="note-large red">
    <div class="notel-title rounded-t-lg p-3 font-bold text-lg flex flex-row gap-2 items-center">
      <i class="notel-icon fa-solid fa-bug"></i><p>警告</p>

    </div>
    <div class="notel-content">
      <p>在尝试使用<code>join()</code>合并两个DataFrame时，两个DataFrame中存在相同名称的列。<code>join()</code>方法默认通过索引来合并数据，如果合并的DataFrame中有重叠的列名（即非索引列），则需要指定后缀来区分这些重叠的列，否则会抛出<code>ValueError</code>。</p>
<p>为了解决这个问题，可以使用<code>lsuffix</code>和<code>rsuffix</code>参数来为左右DataFrame中重叠的列名分别添加后缀。这样，即使列名相同，添加了后缀之后也能区分开来。</p>
<p>下面的代码展示了如何使用这些参数来避免错误：</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用lsuffix和rsuffix添加后缀</span></span><br><span class="line">result_right = row.join(res, how=<span class="string">&#x27;right&#x27;</span>, lsuffix=<span class="string">&#x27;_left&#x27;</span>, rsuffix=<span class="string">&#x27;_right&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(result_right)</span><br><span class="line"></span><br><span class="line">result_outer = row.join(res, how=<span class="string">&#x27;outer&#x27;</span>, lsuffix=<span class="string">&#x27;_left&#x27;</span>, rsuffix=<span class="string">&#x27;_right&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(result_outer)</span><br></pre></td></tr></table></figure></div>

<p>在这个例子中，<code>lsuffix=&#39;_left&#39;</code>会给左侧DataFrame的重叠列名添加后缀<code>_left</code>，<code>rsuffix=&#39;_right&#39;</code>会给右侧DataFrame的重叠列名添加后缀<code>_right</code>。这样，即便原始列名相同，通过添加的后缀也能将它们区分开来，从而避免了错误。</p>
<p>如果目标是基于某些列值而不是索引来合并DataFrame，可能<code>merge()</code>方法更适合需求，因为它提供了更灵活的列合并选项。</p>

    </div>
  </div>

<h5 id="左连接（Left-Join）"><a href="#左连接（Left-Join）" class="headerlink" title="左连接（Left Join）"></a>左连接（Left Join）</h5><p>左连接会保留左侧DataFrame的所有行，即使在右侧DataFrame中没有匹配的索引。如果右侧DataFrame中存在匹配的索引，则相应的列会被添加到结果中。如果不存在，则结果中这些列的值会设置为NaN。</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 左连接</span></span><br><span class="line">result_left = row.join(res, how=<span class="string">&#x27;left&#x27;</span>, lsuffix=<span class="string">&#x27;_left&#x27;</span>, rsuffix=<span class="string">&#x27;_right&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(result_left)</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">   ListingId_left  借款金额_left  借款期限_left  借款利率_left 借款成功日期_left 初始评级_left  \</span><br><span class="line">0         2526671       5115         12       12.0   2015/5/23        AA   </span><br><span class="line">1         2707322       5000          3       10.0    2015/6/5        AA   </span><br><span class="line">2         2722356       3132         12       20.0   2015/6/13         D   </span><br><span class="line">3         2828736       3000         12       12.0   2015/6/19        AA   </span><br><span class="line">4         2850335      17640         18       16.0   2015/6/18         B   </span><br><span class="line">5         3155520       7008         10       11.0   2015/7/12        AA   </span><br><span class="line">6         3207478      19928         12       16.0   2015/7/14         B   </span><br><span class="line">7         3617672       7000         12       11.5   2015/8/12        AA   </span><br><span class="line">8         3637812       4000          6       10.5   2015/8/17        AA   </span><br><span class="line">9         3705094       1000         12       11.5   2015/8/21        AA   </span><br><span class="line"></span><br><span class="line">  借款类型_left 是否首标_left  年龄_left 性别_left  ListingId_right  借款金额_right  \</span><br><span class="line">0        普通         否       34       男          1693100        3629   </span><br><span class="line">1        普通         否       35       男          1713229        3000   </span><br><span class="line">2        普通         否       30       男          1904026        3629   </span><br><span class="line">3        普通         是       24       男          2158281        3919   </span><br><span class="line">4        其他         是       28       男          2257194       14000   </span><br><span class="line">5        普通         否       34       男          2272036       40000   </span><br><span class="line">6        其他         是       22       男          2315058        3200   </span><br><span class="line">7        普通         是       43       男          2332817        3000   </span><br><span class="line">8        其他         是       24       男          2365175        4260   </span><br><span class="line">9        普通         是       26       男          2370723       11987   </span><br><span class="line"></span><br><span class="line">   借款期限_right  借款利率_right 借款成功日期_right 初始评级_right 借款类型_right 是否首标_right  \</span><br><span class="line">0           6          12    2015/1/28         AA         普通          否   </span><br><span class="line">1          12          12    2015/1/30         AA         普通          是   </span><br><span class="line">2          12          12     2015/3/7         AA         普通          否   </span><br><span class="line">3          12          18    2015/4/14          C         普通          否   </span><br><span class="line">4          12          18    2015/4/23          C         普通          否   </span><br><span class="line">5           6          15    2015/4/29          B         电商          是   </span><br><span class="line">6           3          10    2015/4/29         AA         普通          否   </span><br><span class="line">7           6          12     2015/5/6         AA         普通          是   </span><br><span class="line">8           7          12     2015/5/6         AA         普通          否   </span><br><span class="line">9          12          16     2015/5/7          B         其他          否   </span><br><span class="line"></span><br><span class="line">   年龄_right 性别_right  </span><br><span class="line">0        31        男  </span><br><span class="line">1        24        男  </span><br><span class="line">2        27        男  </span><br><span class="line">3        28        男  </span><br><span class="line">4        46        男  </span><br><span class="line">5        32        男  </span><br><span class="line">6        25        男  </span><br><span class="line">7        38        男  </span><br><span class="line">8        25        男  </span><br><span class="line">9        33        女  </span><br></pre></td></tr></table></figure></div>

<h5 id="右连接（Right-Join）"><a href="#右连接（Right-Join）" class="headerlink" title="右连接（Right Join）"></a>右连接（Right Join）</h5><p>右连接与左连接相反，它会保留右侧DataFrame的所有行，即使在左侧DataFrame中没有匹配的索引。</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 右连接</span></span><br><span class="line">result_right = row.join(res, how=<span class="string">&#x27;right&#x27;</span>, lsuffix=<span class="string">&#x27;_left&#x27;</span>, rsuffix=<span class="string">&#x27;_right&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(result_right)</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">   ListingId_left  借款金额_left  借款期限_left  借款利率_left 借款成功日期_left 初始评级_left  \</span><br><span class="line">0         2526671       5115         12       12.0   2015/5/23        AA   </span><br><span class="line">1         2707322       5000          3       10.0    2015/6/5        AA   </span><br><span class="line">2         2722356       3132         12       20.0   2015/6/13         D   </span><br><span class="line">3         2828736       3000         12       12.0   2015/6/19        AA   </span><br><span class="line">4         2850335      17640         18       16.0   2015/6/18         B   </span><br><span class="line">5         3155520       7008         10       11.0   2015/7/12        AA   </span><br><span class="line">6         3207478      19928         12       16.0   2015/7/14         B   </span><br><span class="line">7         3617672       7000         12       11.5   2015/8/12        AA   </span><br><span class="line">8         3637812       4000          6       10.5   2015/8/17        AA   </span><br><span class="line">9         3705094       1000         12       11.5   2015/8/21        AA   </span><br><span class="line"></span><br><span class="line">  借款类型_left 是否首标_left  年龄_left 性别_left  ListingId_right  借款金额_right  \</span><br><span class="line">0        普通         否       34       男          1693100        3629   </span><br><span class="line">1        普通         否       35       男          1713229        3000   </span><br><span class="line">2        普通         否       30       男          1904026        3629   </span><br><span class="line">3        普通         是       24       男          2158281        3919   </span><br><span class="line">4        其他         是       28       男          2257194       14000   </span><br><span class="line">5        普通         否       34       男          2272036       40000   </span><br><span class="line">6        其他         是       22       男          2315058        3200   </span><br><span class="line">7        普通         是       43       男          2332817        3000   </span><br><span class="line">8        其他         是       24       男          2365175        4260   </span><br><span class="line">9        普通         是       26       男          2370723       11987   </span><br><span class="line"></span><br><span class="line">   借款期限_right  借款利率_right 借款成功日期_right 初始评级_right 借款类型_right 是否首标_right  \</span><br><span class="line">0           6          12    2015/1/28         AA         普通          否   </span><br><span class="line">1          12          12    2015/1/30         AA         普通          是   </span><br><span class="line">2          12          12     2015/3/7         AA         普通          否   </span><br><span class="line">3          12          18    2015/4/14          C         普通          否   </span><br><span class="line">4          12          18    2015/4/23          C         普通          否   </span><br><span class="line">5           6          15    2015/4/29          B         电商          是   </span><br><span class="line">6           3          10    2015/4/29         AA         普通          否   </span><br><span class="line">7           6          12     2015/5/6         AA         普通          是   </span><br><span class="line">8           7          12     2015/5/6         AA         普通          否   </span><br><span class="line">9          12          16     2015/5/7          B         其他          否   </span><br><span class="line"></span><br><span class="line">   年龄_right 性别_right  </span><br><span class="line">0        31        男  </span><br><span class="line">1        24        男  </span><br><span class="line">2        27        男  </span><br><span class="line">3        28        男  </span><br><span class="line">4        46        男  </span><br><span class="line">5        32        男  </span><br><span class="line">6        25        男  </span><br><span class="line">7        38        男  </span><br><span class="line">8        25        男  </span><br><span class="line">9        33        女  </span><br></pre></td></tr></table></figure></div>

<h5 id="外连接（Outer-Join）"><a href="#外连接（Outer-Join）" class="headerlink" title="外连接（Outer Join）"></a>外连接（Outer Join）</h5><p>外连接会保留左右两侧DataFrame中的所有行。如果某些行在另一侧没有匹配的索引，则结果DataFrame中这些行的相应列会被设置为NaN。</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 外连接</span></span><br><span class="line">result_outer = row.join(res, how=<span class="string">&#x27;outer&#x27;</span>, lsuffix=<span class="string">&#x27;_left&#x27;</span>, rsuffix=<span class="string">&#x27;_right&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(result_outer)</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">   ListingId_left  借款金额_left  借款期限_left  借款利率_left 借款成功日期_left 初始评级_left  \</span><br><span class="line">0         2526671       5115         12       12.0   2015/5/23        AA   </span><br><span class="line">1         2707322       5000          3       10.0    2015/6/5        AA   </span><br><span class="line">2         2722356       3132         12       20.0   2015/6/13         D   </span><br><span class="line">3         2828736       3000         12       12.0   2015/6/19        AA   </span><br><span class="line">4         2850335      17640         18       16.0   2015/6/18         B   </span><br><span class="line">5         3155520       7008         10       11.0   2015/7/12        AA   </span><br><span class="line">6         3207478      19928         12       16.0   2015/7/14         B   </span><br><span class="line">7         3617672       7000         12       11.5   2015/8/12        AA   </span><br><span class="line">8         3637812       4000          6       10.5   2015/8/17        AA   </span><br><span class="line">9         3705094       1000         12       11.5   2015/8/21        AA   </span><br><span class="line"></span><br><span class="line">  借款类型_left 是否首标_left  年龄_left 性别_left  ListingId_right  借款金额_right  \</span><br><span class="line">0        普通         否       34       男          1693100        3629   </span><br><span class="line">1        普通         否       35       男          1713229        3000   </span><br><span class="line">2        普通         否       30       男          1904026        3629   </span><br><span class="line">3        普通         是       24       男          2158281        3919   </span><br><span class="line">4        其他         是       28       男          2257194       14000   </span><br><span class="line">5        普通         否       34       男          2272036       40000   </span><br><span class="line">6        其他         是       22       男          2315058        3200   </span><br><span class="line">7        普通         是       43       男          2332817        3000   </span><br><span class="line">8        其他         是       24       男          2365175        4260   </span><br><span class="line">9        普通         是       26       男          2370723       11987   </span><br><span class="line"></span><br><span class="line">   借款期限_right  借款利率_right 借款成功日期_right 初始评级_right 借款类型_right 是否首标_right  \</span><br><span class="line">0           6          12    2015/1/28         AA         普通          否   </span><br><span class="line">1          12          12    2015/1/30         AA         普通          是   </span><br><span class="line">2          12          12     2015/3/7         AA         普通          否   </span><br><span class="line">3          12          18    2015/4/14          C         普通          否   </span><br><span class="line">4          12          18    2015/4/23          C         普通          否   </span><br><span class="line">5           6          15    2015/4/29          B         电商          是   </span><br><span class="line">6           3          10    2015/4/29         AA         普通          否   </span><br><span class="line">7           6          12     2015/5/6         AA         普通          是   </span><br><span class="line">8           7          12     2015/5/6         AA         普通          否   </span><br><span class="line">9          12          16     2015/5/7          B         其他          否   </span><br><span class="line"></span><br><span class="line">   年龄_right 性别_right  </span><br><span class="line">0        31        男  </span><br><span class="line">1        24        男  </span><br><span class="line">2        27        男  </span><br><span class="line">3        28        男  </span><br><span class="line">4        46        男  </span><br><span class="line">5        32        男  </span><br><span class="line">6        25        男  </span><br><span class="line">7        38        男  </span><br><span class="line">8        25        男  </span><br><span class="line">9        33        女  </span><br></pre></td></tr></table></figure></div>

<h5 id="内连接（Inner-Join）"><a href="#内连接（Inner-Join）" class="headerlink" title="内连接（Inner Join）"></a>内连接（Inner Join）</h5><p>内连接只保留两个DataFrame中都有匹配的行。如果某行在另一侧没有匹配的索引，则这行不会出现在结果DataFrame中。</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 内连接通常使用merge()而不是join(), 因为join()默认基于索引连接</span></span><br><span class="line"><span class="comment"># result_inner = row.join(res, how=&#x27;inner&#x27;) # 不适用</span></span><br></pre></td></tr></table></figure></div>

<h5 id="使用示例"><a href="#使用示例" class="headerlink" title="使用示例"></a>使用示例</h5><p>在的例子中，使用<code>join()</code>可能不会直接给出期望的结果，因为<code>join()</code>默认是按索引进行合并的。如果DataFrame没有设置索引或者两个DataFrame的索引并不完全匹配，那么合并的结果可能不会是期望的。在这种情况下，使用<code>merge()</code>函数可能更为合适，因为它允许指定合并的列。</p>
<p>不过，如果仍想使用<code>join()</code>并基于列进行合并，可能需要先将某个列设置为索引，然后再进行连接操作。这里给出的代码示例直接使用<code>join()</code>，假设已经有了适当的索引设置。</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 假设df和res是要合并的DataFrame</span></span><br><span class="line">df = pd.read_csv(<span class="string">&#x27;./LCIS.csv&#x27;</span>, nrows=<span class="number">5</span>, usecols=<span class="built_in">range</span>(<span class="number">3</span>,<span class="number">6</span>))</span><br><span class="line">res = pd.DataFrame(df)</span><br><span class="line"><span class="comment"># 尝试使用右连接和外连接，展示效果</span></span><br><span class="line"><span class="built_in">print</span>(row.join(res, how=<span class="string">&#x27;right&#x27;</span>, lsuffix=<span class="string">&#x27;_left&#x27;</span>, rsuffix=<span class="string">&#x27;_right&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(row.join(res, how=<span class="string">&#x27;outer&#x27;</span>, lsuffix=<span class="string">&#x27;_left&#x27;</span>, rsuffix=<span class="string">&#x27;_right&#x27;</span>))</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">   ListingId   借款金额  借款期限  借款利率_left 借款成功日期_left 初始评级_left 借款类型 是否首标  年龄 性别  \</span><br><span class="line">0    2526671   5115    12       12.0   2015/5/23        AA   普通    否  34  男   </span><br><span class="line">1    2707322   5000     3       10.0    2015/6/5        AA   普通    否  35  男   </span><br><span class="line">2    2722356   3132    12       20.0   2015/6/13         D   普通    否  30  男   </span><br><span class="line">3    2828736   3000    12       12.0   2015/6/19        AA   普通    是  24  男   </span><br><span class="line">4    2850335  17640    18       16.0   2015/6/18         B   其他    是  28  男   </span><br><span class="line"></span><br><span class="line">   借款利率_right 借款成功日期_right 初始评级_right  </span><br><span class="line">0          12    2015/1/28         AA  </span><br><span class="line">1          12    2015/1/30         AA  </span><br><span class="line">2          12     2015/3/7         AA  </span><br><span class="line">3          18    2015/4/14          C  </span><br><span class="line">4          18    2015/4/23          C  </span><br><span class="line">   ListingId   借款金额  借款期限  借款利率_left 借款成功日期_left 初始评级_left 借款类型 是否首标  年龄 性别  \</span><br><span class="line">0    2526671   5115    12       12.0   2015/5/23        AA   普通    否  34  男   </span><br><span class="line">1    2707322   5000     3       10.0    2015/6/5        AA   普通    否  35  男   </span><br><span class="line">2    2722356   3132    12       20.0   2015/6/13         D   普通    否  30  男   </span><br><span class="line">3    2828736   3000    12       12.0   2015/6/19        AA   普通    是  24  男   </span><br><span class="line">4    2850335  17640    18       16.0   2015/6/18         B   其他    是  28  男   </span><br><span class="line">5    3155520   7008    10       11.0   2015/7/12        AA   普通    否  34  男   </span><br><span class="line">6    3207478  19928    12       16.0   2015/7/14         B   其他    是  22  男   </span><br><span class="line">7    3617672   7000    12       11.5   2015/8/12        AA   普通    是  43  男   </span><br><span class="line">8    3637812   4000     6       10.5   2015/8/17        AA   其他    是  24  男   </span><br><span class="line">9    3705094   1000    12       11.5   2015/8/21        AA   普通    是  26  男   </span><br><span class="line"></span><br><span class="line">   借款利率_right 借款成功日期_right 初始评级_right  </span><br><span class="line">0        12.0    2015/1/28         AA  </span><br><span class="line">1        12.0    2015/1/30         AA  </span><br><span class="line">2        12.0     2015/3/7         AA  </span><br><span class="line">3        18.0    2015/4/14          C  </span><br><span class="line">4        18.0    2015/4/23          C  </span><br><span class="line">5         NaN          NaN        NaN  </span><br><span class="line">6         NaN          NaN        NaN  </span><br><span class="line">7         NaN          NaN        NaN  </span><br><span class="line">8         NaN          NaN        NaN  </span><br><span class="line">9         NaN          NaN        NaN  </span><br></pre></td></tr></table></figure></div>

<p>如果DataFrame没有公共列作为索引，可能需要先使用<code>.set_index()</code>方法来设置索引。</p>
<h4 id="数据删除"><a href="#数据删除" class="headerlink" title="数据删除"></a>数据删除</h4><p>当处理数据集时，删除不需要的列或行是常见的数据清理步骤。在Pandas中，可以通过<code>del</code>语句或<code>DataFrame.drop</code>方法来实现。下面是如何使用这两种方法来删除数据的详细说明和示例：</p>
<h5 id="使用del语句删除列"><a href="#使用del语句删除列" class="headerlink" title="使用del语句删除列"></a>使用<code>del</code>语句删除列</h5><p><code>del</code>语句是Python的一个内置功能，它可以从DataFrame中直接删除指定的列。使用<code>del</code>语句时，更改是立即生效的，并且直接在原DataFrame上进行，不返回新的DataFrame。</p>
<p>示例代码：</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">del</span> row[<span class="string">&#x27;ListingId&#x27;</span>]</span><br></pre></td></tr></table></figure></div>
<p>这行代码会从<code>row</code> DataFrame中删除名为<code>&#39;ListingId&#39;</code>的列。</p>
<h5 id="使用drop方法删除数据"><a href="#使用drop方法删除数据" class="headerlink" title="使用drop方法删除数据"></a>使用<code>drop</code>方法删除数据</h5><p><code>drop</code>方法在Pandas中更加灵活，可以用于删除行或列，且可以控制是直接在原DataFrame上进行修改还是返回一个新的DataFrame。</p>
<h6 id="删除行："><a href="#删除行：" class="headerlink" title="删除行："></a>删除行：</h6><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(row.drop(<span class="number">0</span>))  <span class="comment"># 删除索引为0的行，不修改原DataFrame，除非指定inplace=True</span></span><br><span class="line"><span class="built_in">print</span>(row.drop([<span class="number">1</span>, <span class="number">2</span>], inplace=<span class="literal">False</span>))  <span class="comment"># 删除索引为1和2的行，不修改原DataFrame</span></span><br></pre></td></tr></table></figure></div>

<h6 id="删除列："><a href="#删除列：" class="headerlink" title="删除列："></a>删除列：</h6><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(row.drop([<span class="string">&#x27;ListingId&#x27;</span>], axis=<span class="number">1</span>))  <span class="comment"># 删除名为&#x27;ListingId&#x27;的列，不修改原DataFrame，除非指定inplace=True</span></span><br></pre></td></tr></table></figure></div>

<p>在使用<code>drop</code>方法时，重要的参数包括：</p>
<ul>
<li><code>labels</code>: 指定要删除的行标签或列名称。</li>
<li><code>axis</code>: 通过设置<code>0</code>或<code>1</code>指定删除行或列。<code>0</code>代表行，<code>1</code>代表列。</li>
<li><code>inplace</code>: 通过设置<code>True</code>或<code>False</code>指定是否在原地修改DataFrame。<code>True</code>表示在原DataFrame上修改，<code>False</code>（默认值）表示返回一个新的DataFrame，原DataFrame不变。</li>
</ul>
<h2 id="Pandas数据清洗"><a href="#Pandas数据清洗" class="headerlink" title="Pandas数据清洗"></a>Pandas数据清洗</h2><p>在数据分析过程中，经常会遇到包含重复行的数据集，这可能会对分析结果产生不利影响。Pandas提供了方便的工具来帮助识别和删除这些重复的数据。下面是如何在Pandas中清洗重复数据的详细说明和示例：</p>
<h3 id="清洗重复数据"><a href="#清洗重复数据" class="headerlink" title="清洗重复数据"></a>清洗重复数据</h3><h4 id="读取数据"><a href="#读取数据" class="headerlink" title="读取数据"></a>读取数据</h4><p>首先，我们通过读取一个CSV文件来创建一个DataFrame，作为处理重复数据的示例：</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="comment"># 读取50行数据</span></span><br><span class="line">df = pd.read_csv(<span class="string">&#x27;./LCIS.csv&#x27;</span>, nrows=<span class="number">50</span>)</span><br><span class="line">row = pd.DataFrame(df)</span><br></pre></td></tr></table></figure></div>

<h4 id="检查重复行"><a href="#检查重复行" class="headerlink" title="检查重复行"></a>检查重复行</h4><p>使用<code>DataFrame.duplicated()</code>方法可以检查DataFrame中的重复行。此方法返回一个布尔系列，其中<code>True</code>表示对应的行是重复的，而<code>False</code>表示行是唯一的。</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(row.duplicated())</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">0     False</span><br><span class="line">1     False</span><br><span class="line">2     False</span><br><span class="line">3     False</span><br><span class="line">4     False</span><br><span class="line">5     False</span><br><span class="line">6     False</span><br><span class="line">7     False</span><br><span class="line">8     False</span><br><span class="line">9     False</span><br><span class="line">10    False</span><br><span class="line">11    False</span><br><span class="line">12    False</span><br><span class="line">13    False</span><br><span class="line">14    False</span><br><span class="line">15    False</span><br><span class="line">16    False</span><br><span class="line">17    False</span><br><span class="line">18    False</span><br><span class="line">19    False</span><br><span class="line">20    False</span><br><span class="line">21    False</span><br><span class="line">22    False</span><br><span class="line">23    False</span><br><span class="line">24    False</span><br><span class="line">25    False</span><br><span class="line">26    False</span><br><span class="line">27    False</span><br><span class="line">28    False</span><br><span class="line">29    False</span><br><span class="line">30    False</span><br><span class="line">31    False</span><br><span class="line">32    False</span><br><span class="line">33    False</span><br><span class="line">34    False</span><br><span class="line">35    False</span><br><span class="line">36    False</span><br><span class="line">37    False</span><br><span class="line">38    False</span><br><span class="line">39    False</span><br><span class="line">40    False</span><br><span class="line">41    False</span><br><span class="line">42    False</span><br><span class="line">43    False</span><br><span class="line">44    False</span><br><span class="line">45    False</span><br><span class="line">46    False</span><br><span class="line">47    False</span><br><span class="line">48    False</span><br><span class="line">49    False</span><br><span class="line">dtype: bool</span><br></pre></td></tr></table></figure></div>

<p>此外，还可以通过对一个简单的DataFrame进行操作来理解重复值的检查：</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">data = &#123;<span class="string">&#x27;A&#x27;</span>: [<span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">3</span>],</span><br><span class="line">        <span class="string">&#x27;B&#x27;</span>: [<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;c&#x27;</span>]&#125;</span><br><span class="line">df = pd.DataFrame(data)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 统计重复行的个数</span></span><br><span class="line">df_count = df.duplicated().<span class="built_in">sum</span>()</span><br><span class="line"><span class="built_in">print</span>(df_count)</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">2</span><br></pre></td></tr></table></figure></div>

<h4 id="删除重复行"><a href="#删除重复行" class="headerlink" title="删除重复行"></a>删除重复行</h4><p>使用<code>DataFrame.drop_duplicates()</code>方法可以删除DataFrame中的重复行。如果设置<code>inplace=True</code>，则会在原地修改DataFrame，而不是返回一个新的DataFrame。</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 删除重复行，并在原地修改DataFrame</span></span><br><span class="line">row.drop_duplicates(inplace=<span class="literal">True</span>)</span><br><span class="line"><span class="built_in">print</span>(row)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;=============================================&quot;</span>)</span><br><span class="line"><span class="comment"># 对于之前创建的简单DataFrame，也删除重复行</span></span><br><span class="line">df.drop_duplicates(inplace=<span class="literal">True</span>)</span><br><span class="line"><span class="built_in">print</span>(df)</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br></pre></td><td class="code"><pre><span class="line">    ListingId   借款金额  借款期限  借款利率     借款成功日期 初始评级   借款类型 是否首标  年龄 性别  ...  \</span><br><span class="line">0     1693100   3629     6  12.0  2015/1/28   AA     普通    否  31  男  ...   </span><br><span class="line">1     1713229   3000    12  12.0  2015/1/30   AA     普通    是  24  男  ...   </span><br><span class="line">2     1904026   3629    12  12.0   2015/3/7   AA     普通    否  27  男  ...   </span><br><span class="line">3     2158281   3919    12  18.0  2015/4/14    C     普通    否  28  男  ...   </span><br><span class="line">4     2257194  14000    12  18.0  2015/4/23    C     普通    否  46  男  ...   </span><br><span class="line">5     2272036  40000     6  15.0  2015/4/29    B     电商    是  32  男  ...   </span><br><span class="line">6     2315058   3200     3  10.0  2015/4/29   AA     普通    否  25  男  ...   </span><br><span class="line">7     2332817   3000     6  12.0   2015/5/6   AA     普通    是  38  男  ...   </span><br><span class="line">8     2365175   4260     7  12.0   2015/5/6   AA     普通    否  25  男  ...   </span><br><span class="line">9     2370723  11987    12  16.0   2015/5/7    B     其他    否  33  女  ...   </span><br><span class="line">10    2526671   5115    12  12.0  2015/5/23   AA     普通    否  34  男  ...   </span><br><span class="line">11    2707322   5000     3  10.0   2015/6/5   AA     普通    否  35  男  ...   </span><br><span class="line">12    2722356   3132    12  20.0  2015/6/13    D     普通    否  30  男  ...   </span><br><span class="line">13    2828736   3000    12  12.0  2015/6/19   AA     普通    是  24  男  ...   </span><br><span class="line">14    2850335  17640    18  16.0  2015/6/18    B     其他    是  28  男  ...   </span><br><span class="line">15    3155520   7008    10  11.0  2015/7/12   AA     普通    否  34  男  ...   </span><br><span class="line">16    3207478  19928    12  16.0  2015/7/14    B     其他    是  22  男  ...   </span><br><span class="line">17    3617672   7000    12  11.5  2015/8/12   AA     普通    是  43  男  ...   </span><br><span class="line">18    3637812   4000     6  10.5  2015/8/17   AA     其他    是  24  男  ...   </span><br><span class="line">19    3705094   1000    12  11.5  2015/8/21   AA     普通    是  26  男  ...   </span><br><span class="line">20    3846919   5719     6  18.0  2015/8/26    C     普通    否  34  男  ...   </span><br><span class="line">21    7285364   8000    12  20.0   2016/1/6    C     普通    否  26  男  ...   </span><br><span class="line">22    7447346   4650    12  22.0   2016/1/9    C     普通    否  29  男  ...   </span><br><span class="line">23    7760072   9000    12  20.0  2016/1/21    C     其他    是  37  男  ...   </span><br><span class="line">24    7777242   9000    12  20.0  2016/1/21    C     普通    是  29  女  ...   </span><br><span class="line">25    7966976   8500    12  20.0  2016/1/24    C     普通    否  43  男  ...   </span><br><span class="line">26    8148541  13500    12  20.0  2016/1/28    C     普通    否  32  女  ...   </span><br><span class="line">27    8260540   6500    12  20.0  2016/1/30    C     普通    否  26  男  ...   </span><br><span class="line">28    8297477   6500    12  22.0  2016/1/31    C     普通    否  35  男  ...   </span><br><span class="line">29    8359807   8000    12  18.0   2016/2/3    B     普通    是  27  男  ...   </span><br><span class="line">30    8377465  11500    12  20.0   2016/2/2    C     普通    否  46  男  ...   </span><br><span class="line">31    8883343  25000    12  20.0  2016/2/23    C     普通    否  27  男  ...   </span><br><span class="line">32    8978256   8000    12  18.0  2016/2/25    B  APP闪电    是  23  男  ...   </span><br><span class="line">33    8987694   5000     6  20.0  2016/2/26    C     普通    否  42  男  ...   </span><br><span class="line">34    9045950   4000     6  18.0  2016/2/28    B  APP闪电    是  21  男  ...   </span><br><span class="line">35    9182372   8000    12  18.0   2016/3/2    B  APP闪电    是  46  男  ...   </span><br><span class="line">36    9482974   3300     6  20.0  2016/3/11    C     普通    否  36  女  ...   </span><br><span class="line">37    9581580   7000    12  18.0  2016/3/12    B  APP闪电    是  23  女  ...   </span><br><span class="line">38    9597362   1000     6  10.0  2016/3/17   AA     普通    是  23  男  ...   </span><br><span class="line">39    9601032   3000    12  18.0  2016/3/13    B  APP闪电    是  25  女  ...   </span><br><span class="line">40    9602590   1200    12  12.0  2016/3/13   AA  APP闪电    是  24  男  ...   </span><br><span class="line">41    9809712   4000    12  16.0  2016/3/20    A  APP闪电    是  21  女  ...   </span><br><span class="line">42    9993691   3000    12  18.0  2016/3/26    B  APP闪电    是  26  男  ...   </span><br><span class="line">43   10240655   2725    12  18.0   2016/4/4    B     普通    否  32  男  ...   </span><br><span class="line">44   10259916   1500    12  20.0  2016/3/29    C  APP闪电    是  22  女  ...   </span><br><span class="line">45   10410378   4497     6  18.0   2016/4/1    B     其他    否  31  女  ...   </span><br><span class="line">46   10604020   2055     6  18.0   2016/4/6    B     普通    否  25  男  ...   </span><br><span class="line">47   10646264   2000    12  12.0   2016/4/7   AA  APP闪电    是  25  女  ...   </span><br><span class="line">48   10829990   5782    12  20.0  2016/4/12    C     其他    否  32  男  ...   </span><br><span class="line">49   11055233   4139    12  22.0  2016/4/17    C     普通    否  36  男  ...   </span><br><span class="line"></span><br><span class="line">    待还利息 标当前逾期天数  标当前状态      上次还款日期  上次还款本金 上次还款利息    下次计划还款日期  下次计划还款本金  \</span><br><span class="line">0   0.00       0    已还清   2015/7/28   34.20   0.30         NaN       NaN   </span><br><span class="line">1   0.00       0    已还清  2015/10/19  173.39   1.05         NaN       NaN   </span><br><span class="line">2   0.00       0    已还清    2016/3/6   44.04   0.38         NaN       NaN   </span><br><span class="line">3   0.00       0    已还清   2015/5/19   92.34   0.22         NaN       NaN   </span><br><span class="line">4   9.92     589    逾期中         NaN     NaN    NaN   2015/5/23      7.66   </span><br><span class="line">5   0.00       0    已还清  2015/10/27   35.43   0.42         NaN       NaN   </span><br><span class="line">6   0.00       0    已还清   2015/7/17  134.45   1.11         NaN       NaN   </span><br><span class="line">7   0.00       0    已还清   2015/11/6    8.74   0.05         NaN       NaN   </span><br><span class="line">8   0.00       0    已还清    2015/8/5   29.59   0.00         NaN       NaN   </span><br><span class="line">9   0.00       0    已还清   2016/1/22   35.16   0.18         NaN       NaN   </span><br><span class="line">10  0.00       0    已还清   2016/5/22    3.58   0.00         NaN       NaN   </span><br><span class="line">11  0.00       0    已还清    2015/9/5   63.20   0.51         NaN       NaN   </span><br><span class="line">12  0.00       0    已还清   2015/7/20    7.31   0.00         NaN       NaN   </span><br><span class="line">13  0.00       0    已还清   2016/4/21   52.54   0.01         NaN       NaN   </span><br><span class="line">14  0.25       0  正常还款中  2016/12/15    1.14   0.11   2017/1/18      1.16   </span><br><span class="line">15  0.00       0    已还清   2016/5/12   52.11   0.44         NaN       NaN   </span><br><span class="line">16  0.00       0    已还清  2016/12/13   26.74   0.28         NaN       NaN   </span><br><span class="line">17  0.00       0    已还清  2015/10/18   43.94   0.36         NaN       NaN   </span><br><span class="line">18  0.00       0    已还清   2015/9/14  300.00   2.45         NaN       NaN   </span><br><span class="line">19  0.00       0    已还清   2016/8/20   13.22   0.07         NaN       NaN   </span><br><span class="line">20  0.00       0    已还清  2015/11/15   33.84   0.32         NaN       NaN   </span><br><span class="line">21  2.02     179    逾期中    2016/6/6    4.05   0.58    2016/7/6      4.12   </span><br><span class="line">22  0.00       0    已还清  2016/11/25    9.14   0.05         NaN       NaN   </span><br><span class="line">23  0.02       0  正常还款中  2016/12/20    4.48   0.15   2017/1/21      4.61   </span><br><span class="line">24  0.02       0  正常还款中  2016/12/20    4.48   0.15   2017/1/21      4.61   </span><br><span class="line">25  0.02       0  正常还款中  2016/12/24    4.48   0.15   2017/1/24      4.61   </span><br><span class="line">26  0.00       0    已还清   2016/8/26   22.08   0.00         NaN       NaN   </span><br><span class="line">27  0.17       2    逾期中  2016/11/30    4.40   0.23  2016/12/30      4.48   </span><br><span class="line">28  0.04       0  正常还款中  2016/12/31    4.51   0.16   2017/1/31      4.63   </span><br><span class="line">29  0.04       0  正常还款中   2016/12/3    1.40   0.06    2017/1/3      1.42   </span><br><span class="line">30  0.02       0  正常还款中  2016/12/18    4.48   0.15    2017/2/2      4.61   </span><br><span class="line">31  0.00       0    已还清  2016/12/23    4.61   0.02         NaN       NaN   </span><br><span class="line">32  0.14       0  正常还款中  2016/12/30    4.38   0.20   2017/1/25      4.44   </span><br><span class="line">33  0.00       0    已还清   2016/6/29   17.24   0.00         NaN       NaN   </span><br><span class="line">34  0.00       0    已还清   2016/8/23    8.68   0.09         NaN       NaN   </span><br><span class="line">35  0.34       0  正常还款中   2016/12/1    4.31   0.27    2017/1/2      4.38   </span><br><span class="line">36  0.00       0    已还清    2016/9/3    8.71   0.11         NaN       NaN   </span><br><span class="line">37  0.34       0  正常还款中  2016/12/10    4.31   0.27   2017/1/12      4.38   </span><br><span class="line">38  0.00       0    已还清   2016/9/17   85.08   0.70         NaN       NaN   </span><br><span class="line">39  0.34       0  正常还款中  2016/12/11    4.31   0.27   2017/1/13      4.38   </span><br><span class="line">40  2.55       0  正常还款中  2016/12/14   42.68   1.74   2017/1/13     43.11   </span><br><span class="line">41  0.30       0  正常还款中  2016/12/23    4.30   0.23   2017/1/20      4.35   </span><br><span class="line">42  0.00       0    已还清  2016/12/23    4.58   0.00         NaN       NaN   </span><br><span class="line">43  0.14       0  正常还款中  2016/12/28    4.38   0.20    2017/3/4      4.44   </span><br><span class="line">44  0.40       0  正常还款中  2016/12/29    4.33   0.30   2017/1/29      4.40   </span><br><span class="line">45  0.00       0    已还清   2016/8/29    8.68   0.00         NaN       NaN   </span><br><span class="line">46  0.00       0    已还清   2016/8/28   17.19   0.16         NaN       NaN   </span><br><span class="line">47  1.66       0  正常还款中   2016/12/8   16.90   0.86    2017/1/7      0.00   </span><br><span class="line">48  0.81       0  正常还款中  2016/12/10    4.94   0.43   2017/1/12      5.02   </span><br><span class="line">49  0.00       0    已还清  2016/10/24   26.38   0.09         NaN       NaN   </span><br><span class="line"></span><br><span class="line">    下次计划还款利息  recorddate  </span><br><span class="line">0        NaN  2016/12/31  </span><br><span class="line">1        NaN  2016/12/31  </span><br><span class="line">2        NaN  2016/12/31  </span><br><span class="line">3        NaN  2016/12/31  </span><br><span class="line">4       1.50  2016/12/31  </span><br><span class="line">5        NaN  2016/12/31  </span><br><span class="line">6        NaN  2016/12/31  </span><br><span class="line">7        NaN  2016/12/31  </span><br><span class="line">8        NaN  2016/12/31  </span><br><span class="line">9        NaN  2016/12/31  </span><br><span class="line">10       NaN  2016/12/31  </span><br><span class="line">11       NaN  2016/12/31  </span><br><span class="line">12       NaN  2016/12/31  </span><br><span class="line">13       NaN  2016/12/31  </span><br><span class="line">14      0.09  2016/12/31  </span><br><span class="line">15       NaN  2016/12/31  </span><br><span class="line">16       NaN  2016/12/31  </span><br><span class="line">17       NaN  2016/12/31  </span><br><span class="line">18       NaN  2016/12/31  </span><br><span class="line">19       NaN  2016/12/31  </span><br><span class="line">20       NaN  2016/12/31  </span><br><span class="line">21      0.51  2016/12/31  </span><br><span class="line">22       NaN  2016/12/31  </span><br><span class="line">23      0.02  2016/12/31  </span><br><span class="line">24      0.02  2016/12/31  </span><br><span class="line">25      0.02  2016/12/31  </span><br><span class="line">26       NaN  2016/12/31  </span><br><span class="line">27      0.15  2016/12/31  </span><br><span class="line">28      0.04  2016/12/31  </span><br><span class="line">29      0.04  2016/12/31  </span><br><span class="line">30      0.02  2016/12/31  </span><br><span class="line">31       NaN  2016/12/31  </span><br><span class="line">32      0.14  2016/12/31  </span><br><span class="line">33       NaN  2016/12/31  </span><br><span class="line">34       NaN  2016/12/31  </span><br><span class="line">35      0.20  2016/12/31  </span><br><span class="line">36       NaN  2016/12/31  </span><br><span class="line">37      0.20  2016/12/31  </span><br><span class="line">38       NaN  2016/12/31  </span><br><span class="line">39      0.20  2016/12/31  </span><br><span class="line">40      1.31  2016/12/31  </span><br><span class="line">41      0.18  2016/12/31  </span><br><span class="line">42       NaN  2016/12/31  </span><br><span class="line">43      0.14  2016/12/31  </span><br><span class="line">44      0.23  2016/12/31  </span><br><span class="line">45       NaN  2016/12/31  </span><br><span class="line">46       NaN  2016/12/31  </span><br><span class="line">47      0.00  2016/12/31  </span><br><span class="line">48      0.35  2016/12/31  </span><br><span class="line">49       NaN  2016/12/31  </span><br><span class="line"></span><br><span class="line">[50 rows x 37 columns]</span><br><span class="line">=============================================</span><br><span class="line">   A  B</span><br><span class="line">0  1  a</span><br><span class="line">2  2  b</span><br><span class="line">3  3  c</span><br></pre></td></tr></table></figure></div>

<p>通过这种方式，可以有效地清理数据集中的重复项，确保进行数据分析时数据的准确性和可靠性。在实际的数据处理中，根据数据的具体情况和需求，合理地使用这些方法可以大大提高数据分析的质量和效率。</p>
<h3 id="清洗空值"><a href="#清洗空值" class="headerlink" title="清洗空值"></a>清洗空值</h3><p>在数据处理和分析中，处理缺失值是一个重要的步骤，因为缺失值可能会影响数据分析的结果。Pandas 提供了多种方法来处理 DataFrame 中的缺失值。下面我们将详细探讨如何统计空值，计算缺失率，删除含有空值的行或列，以及填充空值的不同方法。</p>
<h4 id="统计空值和计算缺失率"><a href="#统计空值和计算缺失率" class="headerlink" title="统计空值和计算缺失率"></a>统计空值和计算缺失率</h4><h5 id="统计空值数量"><a href="#统计空值数量" class="headerlink" title="统计空值数量"></a>统计空值数量</h5><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="comment"># 读取数据</span></span><br><span class="line">df = pd.read_csv(<span class="string">&#x27;./LCIS.csv&#x27;</span>, nrows=<span class="number">50</span>)</span><br><span class="line">row = pd.DataFrame(df)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 统计各列空值的数量</span></span><br><span class="line">res = row.isnull().<span class="built_in">sum</span>()</span><br><span class="line"><span class="built_in">print</span>(res)</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">ListingId      0</span><br><span class="line">借款金额           0</span><br><span class="line">借款期限           0</span><br><span class="line">借款利率           0</span><br><span class="line">借款成功日期         0</span><br><span class="line">初始评级           0</span><br><span class="line">借款类型           0</span><br><span class="line">是否首标           0</span><br><span class="line">年龄             0</span><br><span class="line">性别             0</span><br><span class="line">手机认证           0</span><br><span class="line">户口认证           0</span><br><span class="line">视频认证           0</span><br><span class="line">学历认证           0</span><br><span class="line">征信认证           0</span><br><span class="line">淘宝认证           0</span><br><span class="line">历史成功借款次数       0</span><br><span class="line">历史成功借款金额       0</span><br><span class="line">总待还本金          0</span><br><span class="line">历史正常还款期数       0</span><br><span class="line">历史逾期还款期数       0</span><br><span class="line">我的投资金额         0</span><br><span class="line">当前到期期数         0</span><br><span class="line">当前还款期数         0</span><br><span class="line">已还本金           0</span><br><span class="line">已还利息           0</span><br><span class="line">待还本金           0</span><br><span class="line">待还利息           0</span><br><span class="line">标当前逾期天数        0</span><br><span class="line">标当前状态          0</span><br><span class="line">上次还款日期         1</span><br><span class="line">上次还款本金         1</span><br><span class="line">上次还款利息         1</span><br><span class="line">下次计划还款日期      30</span><br><span class="line">下次计划还款本金      30</span><br><span class="line">下次计划还款利息      30</span><br><span class="line">recorddate     0</span><br><span class="line">dtype: int64</span><br></pre></td></tr></table></figure></div>

<h5 id="计算缺失率"><a href="#计算缺失率" class="headerlink" title="计算缺失率"></a>计算缺失率</h5><ul>
<li>计算各列的缺失率：</li>
</ul>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 计算各列的缺失率，并保留两位小数</span></span><br><span class="line">res = <span class="built_in">round</span>((row.isnull().<span class="built_in">sum</span>() / <span class="built_in">len</span>(row) * <span class="number">100</span>), <span class="number">2</span>)</span><br><span class="line">row = pd.DataFrame(&#123;<span class="string">&#x27;列名&#x27;</span>: res.index, <span class="string">&#x27;缺失值占比&#x27;</span>: res.values&#125;)</span><br><span class="line"><span class="built_in">print</span>(row)</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">            列名  缺失值占比</span><br><span class="line">0    ListingId    0.0</span><br><span class="line">1         借款金额    0.0</span><br><span class="line">2         借款期限    0.0</span><br><span class="line">3         借款利率    0.0</span><br><span class="line">4       借款成功日期    0.0</span><br><span class="line">5         初始评级    0.0</span><br><span class="line">6         借款类型    0.0</span><br><span class="line">7         是否首标    0.0</span><br><span class="line">8           年龄    0.0</span><br><span class="line">9           性别    0.0</span><br><span class="line">10        手机认证    0.0</span><br><span class="line">11        户口认证    0.0</span><br><span class="line">12        视频认证    0.0</span><br><span class="line">13        学历认证    0.0</span><br><span class="line">14        征信认证    0.0</span><br><span class="line">15        淘宝认证    0.0</span><br><span class="line">16    历史成功借款次数    0.0</span><br><span class="line">17    历史成功借款金额    0.0</span><br><span class="line">18       总待还本金    0.0</span><br><span class="line">19    历史正常还款期数    0.0</span><br><span class="line">20    历史逾期还款期数    0.0</span><br><span class="line">21      我的投资金额    0.0</span><br><span class="line">22      当前到期期数    0.0</span><br><span class="line">23      当前还款期数    0.0</span><br><span class="line">24        已还本金    0.0</span><br><span class="line">25        已还利息    0.0</span><br><span class="line">26        待还本金    0.0</span><br><span class="line">27        待还利息    0.0</span><br><span class="line">28     标当前逾期天数    0.0</span><br><span class="line">29       标当前状态    0.0</span><br><span class="line">30      上次还款日期    2.0</span><br><span class="line">31      上次还款本金    2.0</span><br><span class="line">32      上次还款利息    2.0</span><br><span class="line">33    下次计划还款日期   60.0</span><br><span class="line">34    下次计划还款本金   60.0</span><br><span class="line">35    下次计划还款利息   60.0</span><br><span class="line">36  recorddate    0.0</span><br></pre></td></tr></table></figure></div>

<ul>
<li>计算总的缺失率：</li>
</ul>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 假设df是已经加载的DataFrame</span></span><br><span class="line">df = pd.read_csv(<span class="string">&#x27;./LCIS.csv&#x27;</span>)  <span class="comment"># 示例代码，根据实际路径加载</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算至少含有一个空值的行数</span></span><br><span class="line">rows_with_na = df.isnull().<span class="built_in">any</span>(axis=<span class="number">1</span>).<span class="built_in">sum</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算总缺失率，这里的“总缺失”是指含有至少一个空值的行占总行数的比例</span></span><br><span class="line">total_missing_rate = <span class="built_in">round</span>((rows_with_na / <span class="built_in">len</span>(df) * <span class="number">100</span>), <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;总缺失率: <span class="subst">&#123;total_missing_rate&#125;</span>%&quot;</span>)</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">总缺失率: 45.15%</span><br></pre></td></tr></table></figure></div>

<h4 id="删除含有空值的行或列"><a href="#删除含有空值的行或列" class="headerlink" title="删除含有空值的行或列"></a>删除含有空值的行或列</h4><p>使用 <code>dropna()</code> 方法可以根据不同的需求删除含有空值的行或列。</p>
<h5 id="DataFrame-dropna-参数说明："><a href="#DataFrame-dropna-参数说明：" class="headerlink" title="DataFrame.dropna 参数说明："></a><code>DataFrame.dropna</code> 参数说明：</h5><ul>
<li><p><strong><code>axis</code></strong>: 控制删除含有缺失值的行或列。默认值为 <code>0</code>，意味着删除任何含有缺失值的行。如果设置为 <code>1</code>，则删除任何含有缺失值的列。</p>
</li>
<li><p><strong><code>how</code></strong>: 定义了行或列被删除的条件。默认为 <code>&#39;any&#39;</code>，表示如果行或列中存在任何缺失值，就将其删除。如果设置为 <code>&#39;all&#39;</code>，则只有当行或列中的所有值都是缺失值时，才删除该行或列。</p>
</li>
<li><p><strong><code>thresh</code></strong>: 指定一个行或列中非缺失值的最小数量，只有当非缺失值的数量达到这个阈值时，该行或列才会被保留。</p>
</li>
<li><p><strong><code>subset</code></strong>: 用于指定一个列的子集来检查缺失值。这可以是单个列名，或者是多个列名组成的列表。只有在这个子集中检查到缺失值时，相应的行或列才会根据<code>how</code>参数的设置被删除。</p>
</li>
<li><p><strong><code>inplace</code></strong>: 用于指定是否在原地修改DataFrame。如果设置为<code>True</code>，则原地修改DataFrame并返回<code>None</code>；如果设置为<code>False</code>（默认），则返回修改后的新DataFrame，原DataFrame不变。</p>
</li>
<li><p>删除含有任何空值的行：</p>
</li>
</ul>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">row.dropna(axis=<span class="number">0</span>, inplace=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure></div>

<ul>
<li>删除含有任何空值的列：</li>
</ul>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">row.dropna(axis=<span class="number">1</span>, inplace=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure></div>

<h4 id="填充空值"><a href="#填充空值" class="headerlink" title="填充空值"></a>填充空值</h4><p>在很多情况下，直接删除含有空值的数据可能会导致信息的大量丢失，特别是在数据量不是很大的情况下。此时，填充空值成为了一种更好的选择。</p>
<ul>
<li>使用固定值填充所有空值：</li>
</ul>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用0填充所有空值</span></span><br><span class="line">row.fillna(<span class="number">0</span>, inplace=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure></div>

<ul>
<li>针对特定列使用不同的填充值：</li>
</ul>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 以1234填充&#x27;下次计划还款日期&#x27;列的空值</span></span><br><span class="line">row[<span class="string">&#x27;下次计划还款日期&#x27;</span>].fillna(<span class="number">1234</span>, inplace=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure></div>

<ul>
<li>使用列的统计值（均值、中位数、众数）填充空值：</li>
</ul>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用均值填充</span></span><br><span class="line">mean_val = row[<span class="string">&#x27;下次计划还款利息&#x27;</span>].mean()</span><br><span class="line">row[<span class="string">&#x27;下次计划还款利息&#x27;</span>].fillna(mean_val, inplace=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用中位数填充</span></span><br><span class="line">median_val = row[<span class="string">&#x27;下次计划还款利息&#x27;</span>].median()</span><br><span class="line">row[<span class="string">&#x27;下次计划还款利息&#x27;</span>].fillna(median_val, inplace=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用众数填充（注意：众数可能返回多个值）</span></span><br><span class="line">mode_val = row[<span class="string">&#x27;下次计划还款利息&#x27;</span>].mode()[<span class="number">0</span>] <span class="comment"># 选取第一个众数</span></span><br><span class="line">row[<span class="string">&#x27;下次计划还款利息&#x27;</span>].fillna(mode_val, inplace=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure></div>

<h3 id="错误数据清洗"><a href="#错误数据清洗" class="headerlink" title="错误数据清洗"></a>错误数据清洗</h3><p>在数据处理和分析中，清洗数据是一项基础而重要的任务，用于修正或删除数据集中的错误或不一致的数据。Pandas 是一个强大的 Python 数据分析库，它提供了多种方法来清洗错误数据。</p>
<h4 id="替换错误数据"><a href="#替换错误数据" class="headerlink" title="替换错误数据"></a>替换错误数据</h4><h4 id="直接替换特定错误数据"><a href="#直接替换特定错误数据" class="headerlink" title="直接替换特定错误数据"></a>直接替换特定错误数据</h4><p>如果已知特定数据项错误，可以直接替换它。例如，如果我们知道某个人的年龄被错误地录入为12345，而正确的年龄应为30，可以直接修改这个值：</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建DataFrame</span></span><br><span class="line">person = &#123;</span><br><span class="line">    <span class="string">&quot;name&quot;</span>: [<span class="string">&#x27;Google&#x27;</span>, <span class="string">&#x27;Runoob&#x27;</span>, <span class="string">&#x27;Taobao&#x27;</span>],</span><br><span class="line">    <span class="string">&quot;age&quot;</span>: [<span class="number">50</span>, <span class="number">40</span>, <span class="number">12345</span>]  <span class="comment"># 12345 是错误的年龄数据</span></span><br><span class="line">&#125;</span><br><span class="line">df = pd.DataFrame(person)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 直接替换错误数据</span></span><br><span class="line">df.loc[<span class="number">2</span>, <span class="string">&#x27;age&#x27;</span>] = <span class="number">30</span>  <span class="comment"># 将年龄12345改为30</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(df)</span><br></pre></td></tr></table></figure></div>

<h4 id="基于条件的批量替换"><a href="#基于条件的批量替换" class="headerlink" title="基于条件的批量替换"></a>基于条件的批量替换</h4><p>在某些情况下，我们可能需要根据条件批量替换数据。例如，将所有大于120岁的年龄替换为120岁：</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">person = &#123;</span><br><span class="line">    <span class="string">&quot;name&quot;</span>: [<span class="string">&#x27;Google&#x27;</span>, <span class="string">&#x27;Runoob&#x27;</span>, <span class="string">&#x27;Taobao&#x27;</span>],</span><br><span class="line">    <span class="string">&quot;age&quot;</span>: [<span class="number">50</span>, <span class="number">200</span>, <span class="number">12345</span>]    </span><br><span class="line">&#125;</span><br><span class="line">df = pd.DataFrame(person)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 条件替换</span></span><br><span class="line">df.loc[df[<span class="string">&#x27;age&#x27;</span>] &gt; <span class="number">120</span>, <span class="string">&#x27;age&#x27;</span>] = <span class="number">120</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(df)</span><br></pre></td></tr></table></figure></div>

<h4 id="删除错误数据"><a href="#删除错误数据" class="headerlink" title="删除错误数据"></a>删除错误数据</h4><p>有时，与其修正错误的数据，不如直接将其删除。例如，删除年龄大于120岁的记录：</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">person = &#123;</span><br><span class="line">    <span class="string">&quot;name&quot;</span>: [<span class="string">&#x27;Google&#x27;</span>, <span class="string">&#x27;Runoob&#x27;</span>, <span class="string">&#x27;Taobao&#x27;</span>],</span><br><span class="line">    <span class="string">&quot;age&quot;</span>: [<span class="number">50</span>, <span class="number">40</span>, <span class="number">12345</span>]  <span class="comment"># 12345 是错误的年龄数据</span></span><br><span class="line">&#125;</span><br><span class="line">df = pd.DataFrame(person)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除错误数据</span></span><br><span class="line">df = df[df[<span class="string">&#x27;age&#x27;</span>] &lt;= <span class="number">120</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(df)</span><br></pre></td></tr></table></figure></div>

<h4 id="数据格式错误处理"><a href="#数据格式错误处理" class="headerlink" title="数据格式错误处理"></a>数据格式错误处理</h4><p>假设我们有一个包含日期和持续时间的数据集，但日期的格式不统一，这可能会导致分析时出现问题。以下是如何使用 Pandas 来解决这一问题的示例：</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="comment"># 假设数据集中的日期格式不统一，第三个日期格式错误</span></span><br><span class="line">data = &#123;</span><br><span class="line">    <span class="string">&quot;Date&quot;</span>: [<span class="string">&#x27;2020/12/01&#x27;</span>, <span class="string">&#x27;2020/12/02&#x27;</span>, <span class="string">&#x27;20201226&#x27;</span>],  <span class="comment"># 第三个日期格式与其他两个不同</span></span><br><span class="line">    <span class="string">&quot;Duration&quot;</span>: [<span class="number">50</span>, <span class="number">40</span>, <span class="number">45</span>]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用字典创建 DataFrame</span></span><br><span class="line">df = pd.DataFrame(data, index=[<span class="string">&quot;day1&quot;</span>, <span class="string">&quot;day2&quot;</span>, <span class="string">&quot;day3&quot;</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将日期列的格式统一转换为 datetime 格式</span></span><br><span class="line">df[<span class="string">&#x27;Date&#x27;</span>] = pd.to_datetime(df[<span class="string">&#x27;Date&#x27;</span>], errors=<span class="string">&#x27;coerce&#x27;</span>, <span class="built_in">format</span>=<span class="string">&#x27;%Y/%m/%d&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(df)</span><br></pre></td></tr></table></figure></div>

<h5 id="代码解析"><a href="#代码解析" class="headerlink" title="代码解析"></a>代码解析</h5><ol>
<li><strong>导入 Pandas 库</strong>：首先，我们需要导入 Pandas 库，这是进行数据分析和数据清洗的基础。</li>
<li><strong>创建 DataFrame</strong>：我们通过传递一个包含数据的字典（包括不一致的日期格式）来创建一个 <code>DataFrame</code>。这个 <code>DataFrame</code> 包括一个日期列和一个持续时间列。</li>
<li><strong>转换日期格式</strong>：使用 <code>pd.to_datetime()</code> 方法将日期列转换为统一的 datetime 格式。这个方法非常强大，能够自动识别和转换多种日期格式。如果存在无法识别的格式，<code>errors=&#39;coerce&#39;</code> 参数会将这些无法转换的日期替换为 <code>NaT</code> (时间戳数据的缺失值)。<code>format=&#39;%Y/%m/%d&#39;</code> 参数是尝试按照这种格式解析日期，但不一定所有日期都能完全匹配此格式，故 <code>errors=&#39;coerce&#39;</code> 在这里起着兜底的作用。</li>
</ol>
<h5 id="扩展和改进"><a href="#扩展和改进" class="headerlink" title="扩展和改进"></a>扩展和改进</h5><ul>
<li><strong>处理转换错误</strong>：在转换过程中，如果存在无法识别的日期格式，我们可以通过 <code>errors=&#39;coerce&#39;</code> 参数来处理这些错误，将它们转换为 <code>NaT</code>，然后根据需要进行进一步处理，比如填充缺失值或者删除包含缺失值的行。</li>
<li><strong>格式化输出</strong>：在完成日期格式的统一后，我们还可以根据需要对日期进行格式化，比如将所有日期转换为特定的字符串格式。</li>
<li><strong>其他数据清洗任务</strong>：除了解决日期格式问题外，数据清洗可能还包括诸如删除重复值、处理缺失值、数据类型转换等任务。Pandas 提供了丰富的函数和方法来处理这些问题，比如 <code>drop_duplicates()</code>、<code>fillna()</code> 或 <code>replace()</code> 方法。</li>
</ul>
<p>数据统计和运算是数据分析的基础，它涉及到对数据集进行概括性描述和数学计算的过程。Pandas 是一个强大的 Python 数据分析库，提供了一系列方便的数据统计和运算工具，帮助我们快速对数据进行处理和分析。以下是一些使用 Pandas 进行数据统计和运算的常用方法及其应用示例。</p>
<h2 id="数据统计和运算"><a href="#数据统计和运算" class="headerlink" title="数据统计和运算"></a>数据统计和运算</h2><p>数据统计和运算是数据分析的基础，它涉及到对数据集进行概括性描述和数学计算的过程。Pandas 是一个强大的 Python 数据分析库，提供了一系列方便的数据统计和运算工具，帮助我们快速对数据进行处理和分析。以下是一些使用 Pandas 进行数据统计和运算的常用方法及其应用示例。</p>
<h3 id="最大值和最小值：max-和-min"><a href="#最大值和最小值：max-和-min" class="headerlink" title="最大值和最小值：max() 和 min()"></a>最大值和最小值：<code>max()</code> 和 <code>min()</code></h3><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line"><span class="comment"># 读取数据</span></span><br><span class="line">df = pd.read_csv(<span class="string">&quot;./LCIS.csv&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取&#x27;借款金额&#x27;列的最大值</span></span><br><span class="line">max_value = df[<span class="string">&#x27;借款金额&#x27;</span>].<span class="built_in">max</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取&#x27;借款金额&#x27;列的最小值</span></span><br><span class="line">min_value = df[<span class="string">&#x27;借款金额&#x27;</span>].<span class="built_in">min</span>()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;最大借款金额:&quot;</span>, max_value)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;最小借款金额:&quot;</span>, min_value)</span><br></pre></td></tr></table></figure></div>

<p>这段代码展示了如何读取一个 CSV 文件，并计算某一列（例如“借款金额”）的最大值和最小值。</p>
<h3 id="非缺失值的数量：count"><a href="#非缺失值的数量：count" class="headerlink" title="非缺失值的数量：count()"></a>非缺失值的数量：<code>count()</code></h3><p><code>df.count(axis=0, level=None, numeric_only=False)</code> </p>
<ul>
<li><code>axis</code>：指定计算的方向，0 表示按列计算，1 表示按行计算，默认为 0。 </li>
<li><code>level</code>：用于 MultiIndex 的级别，在多层索引 DataFrame 中指定要计算的级别。 </li>
<li><code>numeric_only</code>：布尔值，表示是否只计算数值型列（int、float）的非缺失值，默认为 False，表示计算所有列的非缺失值数量。</li>
</ul>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">df = pd.read_csv(<span class="string">&quot;./LCIS.csv&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算每列的非缺失值数量</span></span><br><span class="line">column_non_missing_count = df.count()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算每行的非缺失值数量</span></span><br><span class="line">row_non_missing_count = df.count(axis=<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(column_non_missing_count)</span><br><span class="line"><span class="built_in">print</span>(row_non_missing_count)</span><br></pre></td></tr></table></figure></div>

<p>此代码展示了如何计算 DataFrame 中每列或每行的非缺失值（非 NaN 值）的数量。可以通过设置 <code>axis</code> 参数为 0（默认）计算每列的非缺失值数量，或设置为 1 计算每行的非缺失值数量。</p>
<h3 id="求和与累加：sum-和-cumsum"><a href="#求和与累加：sum-和-cumsum" class="headerlink" title="求和与累加：sum() 和 cumsum()"></a>求和与累加：<code>sum()</code> 和 <code>cumsum()</code></h3><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 求和</span></span><br><span class="line">total = df[<span class="string">&#x27;借款金额&#x27;</span>].<span class="built_in">sum</span>()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;借款金额总和:&quot;</span>, total)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 累加</span></span><br><span class="line">df[<span class="string">&#x27;累计借款金额&#x27;</span>] = df[<span class="string">&#x27;借款金额&#x27;</span>].cumsum()</span><br><span class="line"><span class="built_in">print</span>(df)</span><br></pre></td></tr></table></figure></div>

<p>这部分代码用于计算特定列的总和（<code>sum()</code>）和累加值（<code>cumsum()</code>）。<code>cumsum()</code> 方法在原有数据的基础上添加了一个累加列，显示到当前行为止的累计总和。</p>
<h3 id="排序：sort-values-和-sort-index"><a href="#排序：sort-values-和-sort-index" class="headerlink" title="排序：sort_values() 和 sort_index()"></a>排序：<code>sort_values()</code> 和 <code>sort_index()</code></h3><h4 id="按列值排序"><a href="#按列值排序" class="headerlink" title="按列值排序"></a>按列值排序</h4><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 按照&#x27;借款金额&#x27;列的值进行升序排序</span></span><br><span class="line">df.sort_values(<span class="string">&#x27;借款金额&#x27;</span>, inplace=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 根据&#x27;借款金额&#x27;进行升序排序，&#x27;年龄&#x27;进行降序排序</span></span><br><span class="line">df.sort_values([<span class="string">&#x27;借款金额&#x27;</span>, <span class="string">&#x27;年龄&#x27;</span>], ascending=[<span class="literal">True</span>, <span class="literal">False</span>], inplace=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure></div>

<p>这些例子展示了如何按照一个或多个列的值对 DataFrame 进行排序。可以通过 <code>ascending</code> 参数控制排序的方向（升序或降序）。</p>
<h4 id="按索引排序"><a href="#按索引排序" class="headerlink" title="按索引排序"></a>按索引排序</h4><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 按照索引进行排序</span></span><br><span class="line">df.sort_index(inplace=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure></div>

<p>如果需要根据行索引进行排序，可以使用 <code>sort_index()</code> 方法。这在重置数据顺序时特别有用。</p>
<h3 id="扩展"><a href="#扩展" class="headerlink" title="扩展"></a>扩展</h3><ul>
<li><strong>计算缺失值</strong>：利用 <code>count()</code> 方法的结果可以间接计算出某列或整个 DataFrame 的缺失值数量。例如，DataFrame 总行数减去 <code>count()</code> 方法返回的非缺失值数量即为缺失值数量。</li>
<li><strong>设置列名</strong>：当从函数返回一个 Series 或需要更改 DataFrame 的列名时，可以直接通过修改 <code>columns</code> 属性或者在创建 DataFrame 时指定列名。</li>
<li><strong>读取部分数据</strong>：对于大型数据集，可以使用 <code>pd.read_csv()</code> 函数的 <code>nrows</code> 参数仅读取前 N 行数据，有助于快速测试代码或减少内存消耗。</li>
</ul>
<h2 id="数据分组和聚合"><a href="#数据分组和聚合" class="headerlink" title="数据分组和聚合"></a>数据分组和聚合</h2><h3 id="df-groupby-column-name"><a href="#df-groupby-column-name" class="headerlink" title="df.groupby(column_name)"></a>df.groupby(column_name)</h3><p><code>groupby()</code> 方法是用来对数据进行分组的，特别是当你想要按照某个（或某些）列的值对整个数据集进行分组时。分组后，可以对每个分组应用聚合函数，比如求和、平均、最大值和最小值等。</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 按照&#x27;年龄&#x27;列分组，并计算每个年龄组的数量</span></span><br><span class="line">age_group_count = df.groupby(<span class="string">&#x27;年龄&#x27;</span>).count()</span><br><span class="line"><span class="built_in">print</span>(age_group_count)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 只统计不同年龄组的&#x27;借款金额&#x27;总和</span></span><br><span class="line">age_group_loan_sum = df.groupby(<span class="string">&#x27;年龄&#x27;</span>)[<span class="string">&#x27;借款金额&#x27;</span>].<span class="built_in">sum</span>()</span><br><span class="line"><span class="built_in">print</span>(age_group_loan_sum)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算每个年龄组的&#x27;借款金额&#x27;的最大值、最小值和平均值</span></span><br><span class="line">age_group_loan_max = df.groupby(<span class="string">&#x27;年龄&#x27;</span>)[<span class="string">&#x27;借款金额&#x27;</span>].<span class="built_in">max</span>()</span><br><span class="line">age_group_loan_min = df.groupby(<span class="string">&#x27;年龄&#x27;</span>)[<span class="string">&#x27;借款金额&#x27;</span>].<span class="built_in">min</span>()</span><br><span class="line">age_group_loan_mean = df.groupby(<span class="string">&#x27;年龄&#x27;</span>)[<span class="string">&#x27;借款金额&#x27;</span>].mean()</span><br><span class="line"><span class="built_in">print</span>(age_group_loan_max)</span><br><span class="line"><span class="built_in">print</span>(age_group_loan_min)</span><br><span class="line"><span class="built_in">print</span>(age_group_loan_mean)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 按照&#x27;性别&#x27;分组，并计算&#x27;借款金额&#x27;的最大值、最小值和平均值</span></span><br><span class="line">gender_group_loan_max = df.groupby(<span class="string">&#x27;性别&#x27;</span>)[<span class="string">&#x27;借款金额&#x27;</span>].<span class="built_in">max</span>()</span><br><span class="line">gender_group_loan_min = df.groupby(<span class="string">&#x27;性别&#x27;</span>)[<span class="string">&#x27;借款金额&#x27;</span>].<span class="built_in">min</span>()</span><br><span class="line">gender_group_loan_mean = df.groupby(<span class="string">&#x27;性别&#x27;</span>)[<span class="string">&#x27;借款金额&#x27;</span>].mean()</span><br><span class="line"><span class="built_in">print</span>(gender_group_loan_max)</span><br><span class="line"><span class="built_in">print</span>(gender_group_loan_min)</span><br><span class="line"><span class="built_in">print</span>(gender_group_loan_mean)</span><br></pre></td></tr></table></figure></div>

<h3 id="df-aggregate-function-name"><a href="#df-aggregate-function-name" class="headerlink" title="df.aggregate(function_name)"></a>df.aggregate(function_name)</h3><p><code>aggregate()</code> 方法允许你对整个 DataFrame 或某些选定的列应用一个或多个聚合函数。</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 对整个 DataFrame 应用多个聚合函数</span></span><br><span class="line">agg_results = df.aggregate([<span class="string">&#x27;sum&#x27;</span>, <span class="string">&#x27;mean&#x27;</span>])</span><br><span class="line"><span class="built_in">print</span>(agg_results) <span class="comment"># 可能会报错，因为字符类型的列不能进行数学计算</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 对指定列应用聚合函数</span></span><br><span class="line">agg_specific = df.aggregate(&#123;<span class="string">&#x27;借款金额&#x27;</span>: <span class="string">&#x27;sum&#x27;</span>, <span class="string">&#x27;年龄&#x27;</span>: <span class="string">&#x27;mean&#x27;</span>&#125;)</span><br><span class="line"><span class="built_in">print</span>(agg_specific)</span><br></pre></td></tr></table></figure></div>

<p>如果数据集中包含非数值类型（如字符串），直接应用 <code>sum</code> 或 <code>mean</code> 会导致错误。为了避免这种情况，你应该指定要应用聚合函数的列，或者通过 <code>numeric_only=True</code> 参数来排除非数值列。</p>
<h3 id="df-pivot-table-values-index-columns-aggfunc"><a href="#df-pivot-table-values-index-columns-aggfunc" class="headerlink" title="df.pivot_table(values, index, columns, aggfunc)"></a>df.pivot_table(values, index, columns, aggfunc)</h3><p><code>pivot_table()</code> 方法是用来创建透视表的，这在你想要对数据进行多维度的分组聚合时特别有用。</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建透视表，将&#x27;性别&#x27;作为索引，对&#x27;借款金额&#x27;进行求和</span></span><br><span class="line">gender_loan_pivot_table = df.pivot_table(values=<span class="string">&#x27;借款金额&#x27;</span>, index=<span class="string">&#x27;性别&#x27;</span>, aggfunc=<span class="string">&#x27;sum&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(gender_loan_pivot_table)</span><br></pre></td></tr></table></figure></div>

<p>在透视表中，<code>values</code> 参数是你想要聚合的列，<code>index</code> 参数是你想要作为行索引的列，<code>columns</code> 参数（可选）是你想要作为列索引的列，<code>aggfunc</code> 是定义聚合函数的参数。</p>
<p>这些方法不仅可以帮助你从数据集中提取有意义的统计信息，还可以根据你的特定需求进行高度定制化的数据处理和分析。通过使用这些工具，你可以轻松地对数据进行分组和聚合，从而提取出关键的洞见。</p>
<h2 id="案例-1"><a href="#案例-1" class="headerlink" title="案例"></a>案例</h2><h3 id="数据导入与演示"><a href="#数据导入与演示" class="headerlink" title="数据导入与演示"></a>数据导入与演示</h3><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">df = pd.read_csv(<span class="string">&#x27;./LCIS.csv&#x27;</span>)  </span><br><span class="line"><span class="comment"># 显示所有的数据</span></span><br><span class="line"><span class="comment"># pd.set_option(&#x27;display.max_rows&#x27;, None)  # 显示所有行</span></span><br><span class="line">pd.set_option(<span class="string">&#x27;display.max_columns&#x27;</span>, <span class="literal">None</span>)  <span class="comment"># 显示所有列</span></span><br><span class="line"><span class="comment"># pd.set_option(&#x27;expand_frame_repr&#x27;, False)  # 不自动换行</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(df)</span><br></pre></td></tr></table></figure></div>

<pre><code>        ListingId   借款金额  借款期限  借款利率      借款成功日期 初始评级 借款类型 是否首标  年龄 性别   手机认证  \
0         1693100   3629     6  12.0   2015/1/28   AA   普通    否  31  男   成功认证   
1         1713229   3000    12  12.0   2015/1/30   AA   普通    是  24  男   成功认证   
2         1904026   3629    12  12.0    2015/3/7   AA   普通    否  27  男   成功认证   
3         2158281   3919    12  18.0   2015/4/14    C   普通    否  28  男   成功认证   
4         2257194  14000    12  18.0   2015/4/23    C   普通    否  46  男   成功认证   
...           ...    ...   ...   ...         ...  ...  ...  ...  .. ..    ...   
292534   29087298   7193    12  22.0  2016/12/29    C   普通    否  48  男   成功认证   
292535   29995173   3241    12  22.0    2017/1/5    C   其他    否  25  女   成功认证   
292536   30355195   3004    12  22.0    2017/1/8    C   其他    否  28  男  未成功认证   
292537   30649717   2082    12  22.0   2017/1/11    C   普通    否  52  男   成功认证   
292538   31620657  10000    12  22.0   2017/1/20    D   普通    是  24  女  未成功认证   

         户口认证   视频认证   学历认证   征信认证   淘宝认证  历史成功借款次数  历史成功借款金额     总待还本金  \
0       未成功认证  未成功认证  未成功认证  未成功认证  未成功认证       1.0    3000.0   1313.46   
1       未成功认证  未成功认证  未成功认证  未成功认证  未成功认证       0.0       0.0      0.00   
2       未成功认证  未成功认证  未成功认证  未成功认证  未成功认证       1.0    3000.0    878.58   
3        成功认证  未成功认证  未成功认证  未成功认证  未成功认证       4.0   13800.0   6523.11   
4       未成功认证  未成功认证  未成功认证  未成功认证  未成功认证      11.0   54840.0  11491.04   
...       ...    ...    ...    ...    ...       ...       ...       ...   
292534  未成功认证  未成功认证  未成功认证  未成功认证  未成功认证       1.0    3500.0    306.54   
292535  未成功认证  未成功认证   成功认证  未成功认证  未成功认证       1.0    5000.0   1758.28   
292536  未成功认证  未成功认证  未成功认证  未成功认证  未成功认证       1.0    2200.0   1495.67   
292537  未成功认证  未成功认证  未成功认证  未成功认证  未成功认证       6.0   22064.0   5747.77   
292538  未成功认证  未成功认证   成功认证  未成功认证  未成功认证       0.0       0.0      0.00   

        历史正常还款期数  历史逾期还款期数  我的投资金额  当前到期期数  当前还款期数    已还本金   已还利息    待还本金  \
0              2         2     200       6       6  200.00   7.00    0.00   
1              0         0     500      12       9  500.00  29.80    0.00   
2              5         0     500      12      12  500.00  33.04    0.00   
3             25         0     100      12       2  100.00   1.72    0.00   
4             53         0     100      12       0    0.00   0.00  100.00   
...          ...       ...     ...     ...     ...     ...    ...     ...   
292534        11         0      55       2       2    8.35   1.94   46.65   
292535         3         3      50       1       1    3.76   0.91   46.24   
292536         4         0      50       1       1    3.76   0.91   46.24   
292537        39         6      55       1       1    4.13   1.01   50.87   
292538         0         0      73       1       1    5.49   1.34   67.51   

        待还利息  标当前逾期天数  标当前状态      上次还款日期  上次还款本金  上次还款利息   下次计划还款日期  下次计划还款本金  \
0       0.00        0    已还清   2015/7/28   34.20    0.30        NaN       NaN   
1       0.00        0    已还清  2015/10/19  173.39    1.05        NaN       NaN   
2       0.00        0    已还清    2016/3/6   44.04    0.38        NaN       NaN   
3       0.00        0    已还清   2015/5/19   92.34    0.22        NaN       NaN   
4       9.92      589    逾期中         NaN     NaN     NaN  2015/5/23      7.66   
...      ...      ...    ...         ...     ...     ...        ...       ...   
292534  4.83        0  正常还款中   2017/2/26    4.22    0.93  2017/3/28      4.29   
292535  5.24        0  正常还款中    2017/2/9    3.76    0.91   2017/3/5      3.83   
292536  5.24        0  正常还款中    2017/2/8    3.76    0.91   2017/3/8      3.83   
292537  5.76        0  正常还款中   2017/2/10    4.13    1.01  2017/3/10      4.22   
292538  7.64        0  正常还款中   2017/2/20    5.49    1.34  2017/3/20      5.59   

        下次计划还款利息  recorddate  
0            NaN  2016/12/31  
1            NaN  2016/12/31  
2            NaN  2016/12/31  
3            NaN  2016/12/31  
4           1.50  2016/12/31  
...          ...         ...  
292534      0.86   2017/2/28  
292535      0.85   2017/2/28  
292536      0.85   2017/2/28  
292537      0.93   2017/2/28  
292538      1.24   2017/2/28  

[292539 rows x 37 columns]
</code></pre>
<h3 id="总缺失率"><a href="#总缺失率" class="headerlink" title="总缺失率"></a>总缺失率</h3><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 计算至少含有一个空值的行数</span></span><br><span class="line">rows_with_na = df.isnull().<span class="built_in">any</span>(axis=<span class="number">1</span>).<span class="built_in">sum</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算总缺失率，这里的“总缺失”是指含有至少一个空值的行占总行数的比例</span></span><br><span class="line">total_missing_rate = <span class="built_in">round</span>((rows_with_na / <span class="built_in">len</span>(df) * <span class="number">100</span>), <span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;总缺失率: <span class="subst">&#123;total_missing_rate&#125;</span>%&quot;</span>)</span><br></pre></td></tr></table></figure></div>

<pre><code>总缺失率: 45.15%
</code></pre>
<h3 id="手机认证用户借贷笔数"><a href="#手机认证用户借贷笔数" class="headerlink" title="手机认证用户借贷笔数"></a>手机认证用户借贷笔数</h3><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 手机认证借贷笔数 </span></span><br><span class="line">loan_phone = df[df[<span class="string">&#x27;手机认证&#x27;</span>] == <span class="string">&#x27;成功认证&#x27;</span>].shape[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(loan_phone)</span><br></pre></td></tr></table></figure></div>

<pre><code>153453
</code></pre>
<h3 id="户门认证用户借贷情况"><a href="#户门认证用户借贷情况" class="headerlink" title="户门认证用户借贷情况"></a>户门认证用户借贷情况</h3><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 筛选户口认证为“成功认证”的用户</span></span><br><span class="line">df_hukou_success = df[df[<span class="string">&#x27;户口认证&#x27;</span>] == <span class="string">&#x27;成功认证&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算平均借款金额</span></span><br><span class="line">avg_loan_amount_hukou_success = df_hukou_success[<span class="string">&#x27;借款金额&#x27;</span>].mean()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算平均借款期限</span></span><br><span class="line">avg_loan_duration_hukou_success = df_hukou_success[<span class="string">&#x27;借款期限&#x27;</span>].mean()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算平均借款利率</span></span><br><span class="line">avg_interest_rate_hukou_success = df_hukou_success[<span class="string">&#x27;借款利率&#x27;</span>].mean()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算平均年龄</span></span><br><span class="line">avg_age_hukou_success = df_hukou_success[<span class="string">&#x27;年龄&#x27;</span>].mean()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;户口认证成功的用户平均借款金额: <span class="subst">&#123;avg_loan_amount_hukou_success:<span class="number">.2</span>f&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;户口认证成功的用户平均借款期限: <span class="subst">&#123;avg_loan_duration_hukou_success:<span class="number">.2</span>f&#125;</span> 个月&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;户口认证成功的用户平均借款利率: <span class="subst">&#123;avg_interest_rate_hukou_success:<span class="number">.2</span>f&#125;</span>%&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;户口认证成功的用户平均年龄: <span class="subst">&#123;avg_age_hukou_success:<span class="number">.2</span>f&#125;</span> 岁&quot;</span>)</span><br></pre></td></tr></table></figure></div>

<pre><code>户口认证成功的用户平均借款金额: 36955.01
户口认证成功的用户平均借款期限: 10.04 个月
户口认证成功的用户平均借款利率: 17.15%
户口认证成功的用户平均年龄: 31.42 岁
</code></pre>
<h3 id="征信认证用户借贷情况"><a href="#征信认证用户借贷情况" class="headerlink" title="征信认证用户借贷情况"></a>征信认证用户借贷情况</h3><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 筛选出征信认证为成功认证的行</span></span><br><span class="line">df_credit_approved = df[df[<span class="string">&#x27;征信认证&#x27;</span>] == <span class="string">&#x27;成功认证&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算平均借款金额</span></span><br><span class="line">avg_loan_amount_credit_approved = df_credit_approved[<span class="string">&#x27;借款金额&#x27;</span>].mean()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算平均借款期限</span></span><br><span class="line">avg_loan_duration_credit_approved = df_credit_approved[<span class="string">&#x27;借款期限&#x27;</span>].mean()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算平均借款利率</span></span><br><span class="line">avg_interest_rate_credit_approved = df_credit_approved[<span class="string">&#x27;借款利率&#x27;</span>].mean()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算平均年龄</span></span><br><span class="line">avg_age_credit_approved = df_credit_approved[<span class="string">&#x27;年龄&#x27;</span>].mean()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;征信认证成功的用户平均借款金额: <span class="subst">&#123;avg_loan_amount_credit_approved:<span class="number">.2</span>f&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;征信认证成功的用户平均借款期限: <span class="subst">&#123;avg_loan_duration_credit_approved:<span class="number">.2</span>f&#125;</span> 个月&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;征信认证成功的用户平均借款利率: <span class="subst">&#123;avg_interest_rate_credit_approved:<span class="number">.2</span>f&#125;</span>%&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;征信认证成功的用户平均年龄: <span class="subst">&#123;avg_age_credit_approved:<span class="number">.2</span>f&#125;</span> 岁&quot;</span>)</span><br></pre></td></tr></table></figure></div>

<pre><code>征信认证成功的用户平均借款金额: 9138.00
征信认证成功的用户平均借款期限: 10.59 个月
征信认证成功的用户平均借款利率: 18.27%
征信认证成功的用户平均年龄: 29.79 岁
</code></pre>
<h3 id="性别认证用户还款情况"><a href="#性别认证用户还款情况" class="headerlink" title="性别认证用户还款情况"></a>性别认证用户还款情况</h3><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 确保性别列存在并且不为空</span></span><br><span class="line">df_with_gender = df[df[<span class="string">&#x27;性别&#x27;</span>].notna()]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 按性别分组，并计算各项指标的平均值</span></span><br><span class="line">repayment_status = df_with_gender.groupby(<span class="string">&#x27;性别&#x27;</span>).agg(&#123;</span><br><span class="line">    <span class="string">&#x27;借款金额&#x27;</span>: <span class="string">&#x27;mean&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;历史成功借款次数&#x27;</span>: <span class="string">&#x27;mean&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;历史逾期还款期数&#x27;</span>: <span class="string">&#x27;mean&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;总待还本金&#x27;</span>: <span class="string">&#x27;mean&#x27;</span></span><br><span class="line">&#125;).reset_index()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 重命名列以更清晰地表示它们的内容</span></span><br><span class="line">repayment_status.columns = [<span class="string">&#x27;性别&#x27;</span>, <span class="string">&#x27;平均借款金额&#x27;</span>, <span class="string">&#x27;平均历史成功借款次数&#x27;</span>, <span class="string">&#x27;平均历史逾期还款期数&#x27;</span>, <span class="string">&#x27;平均待还本金&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(repayment_status)</span><br></pre></td></tr></table></figure></div>

<pre><code>  性别       平均借款金额  平均历史成功借款次数  平均历史逾期还款期数       平均待还本金
0  女  6896.238214    2.651062   17.975806  4706.631430
1  男  9385.546621    2.547655   18.575870  4388.516472
</code></pre>
<h3 id="不同性别用户还款占比情况"><a href="#不同性别用户还款占比情况" class="headerlink" title="不同性别用户还款占比情况"></a>不同性别用户还款占比情况</h3><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 定义正常还款状态</span></span><br><span class="line">normal_repayment_statuses = [<span class="string">&#x27;已还清&#x27;</span>, <span class="string">&#x27;正常还款中&#x27;</span>]</span><br><span class="line"></span><br><span class="line">df_per_gender = df</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建一个新列，用于标记是否正常还款</span></span><br><span class="line">df_per_gender[<span class="string">&#x27;是否正常还款&#x27;</span>] = df_per_gender[<span class="string">&#x27;标当前状态&#x27;</span>].apply(<span class="keyword">lambda</span> x: <span class="string">&#x27;正常还款&#x27;</span> <span class="keyword">if</span> x <span class="keyword">in</span> normal_repayment_statuses <span class="keyword">else</span> <span class="string">&#x27;未还清&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算每个性别的还款占比</span></span><br><span class="line">repayment_by_gender = df_per_gender.groupby(<span class="string">&#x27;性别&#x27;</span>)[<span class="string">&#x27;是否正常还款&#x27;</span>].value_counts(normalize=<span class="literal">True</span>).unstack().fillna(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将占比转换为百分比</span></span><br><span class="line">repayment_by_gender_percentage = repayment_by_gender * <span class="number">100</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(repayment_by_gender_percentage)</span><br></pre></td></tr></table></figure></div>

<pre><code>是否正常还款       未还清       正常还款
性别                         
女       3.216114  96.783886
男       3.948184  96.051816
</code></pre>
<h3 id="学历认证用户还款情况"><a href="#学历认证用户还款情况" class="headerlink" title="学历认证用户还款情况"></a>学历认证用户还款情况</h3><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">df_sty_auth = df[df[<span class="string">&#x27;学历认证&#x27;</span>] == <span class="string">&#x27;成功认证&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 分析学历认证用户的还款情况</span></span><br><span class="line"><span class="comment"># 计算历史正常还款期数和历史逾期还款期数的平均值</span></span><br><span class="line">avg_normal_re = df_sty_auth[<span class="string">&#x27;历史正常还款期数&#x27;</span>].mean()</span><br><span class="line">avg_dishor_re = df_sty_auth[<span class="string">&#x27;历史逾期还款期数&#x27;</span>].mean()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算已还本金、已还利息的总和</span></span><br><span class="line">org_done_total = df_sty_auth[<span class="string">&#x27;已还本金&#x27;</span>].<span class="built_in">sum</span>()</span><br><span class="line">fee_done_total = df_sty_auth[<span class="string">&#x27;已还利息&#x27;</span>].<span class="built_in">sum</span>()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;学历认证用户平均历史正常还款期数: <span class="subst">&#123;avg_normal_re&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;学历认证用户平均历史逾期还款期数: <span class="subst">&#123;avg_dishor_re&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;学历认证用户总已还本金: <span class="subst">&#123;org_done_total&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;学历认证用户总已还利息: <span class="subst">&#123;fee_done_total&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure></div>

<pre><code>学历认证用户平均历史正常还款期数: 78.98516016370341
学历认证用户平均历史逾期还款期数: 13.045753352616355
学历认证用户总已还本金: 6445238.179999999
学历认证用户总已还利息: 499930.52000000014
</code></pre>
<h3 id="学历认证用户还款占比情况"><a href="#学历认证用户还款占比情况" class="headerlink" title="学历认证用户还款占比情况"></a>学历认证用户还款占比情况</h3><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 筛选学历认证成功的用户</span></span><br><span class="line">df_education_certified = df[df[<span class="string">&#x27;学历认证&#x27;</span>] == <span class="string">&#x27;成功认证&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算各状态下的用户数量</span></span><br><span class="line">status_counts = df_education_certified[<span class="string">&#x27;标当前状态&#x27;</span>].value_counts()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算总数，用于计算比例</span></span><br><span class="line">total_certified = df_education_certified.shape[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算占比</span></span><br><span class="line">status_proportions = status_counts / total_certified</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打印结果</span></span><br><span class="line"><span class="built_in">print</span>(status_proportions)</span><br></pre></td></tr></table></figure></div>

<pre><code>标当前状态
正常还款中    0.692517
已还清      0.279435
逾期中      0.027097
0        0.000620
0.7      0.000040
2.35     0.000020
0.62     0.000013
5.76     0.000013
1.16     0.000013
1.07     0.000013
4.73     0.000007
1.33     0.000007
0.2      0.000007
2.82     0.000007
0.4      0.000007
0.34     0.000007
2.95     0.000007
3.15     0.000007
2.6      0.000007
2.66     0.000007
5.5      0.000007
2.65     0.000007
0.11     0.000007
5.81     0.000007
1.17     0.000007
1.74     0.000007
0.77     0.000007
4.92     0.000007
2.46     0.000007
0.38     0.000007
6.47     0.000007
1.78     0.000007
0.76     0.000007
3.42     0.000007
0.13     0.000007
1.51     0.000007
0.73     0.000007
0.48     0.000007
3.76     0.000007
4.83     0.000007
0.49     0.000007
3.39     0.000007
Name: count, dtype: float64
</code></pre>
<h3 id="不同年龄段用户借款统计"><a href="#不同年龄段用户借款统计" class="headerlink" title="不同年龄段用户借款统计"></a>不同年龄段用户借款统计</h3><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 定义年龄段</span></span><br><span class="line">bins = [<span class="number">18</span>, <span class="number">25</span>, <span class="number">35</span>, <span class="number">45</span>, <span class="number">55</span>, <span class="number">65</span>, <span class="number">75</span>]</span><br><span class="line">labels = [<span class="string">&#x27;18-24&#x27;</span>, <span class="string">&#x27;25-34&#x27;</span>, <span class="string">&#x27;35-44&#x27;</span>, <span class="string">&#x27;45-54&#x27;</span>, <span class="string">&#x27;55-64&#x27;</span>, <span class="string">&#x27;65-74&#x27;</span>]</span><br><span class="line">age_df = df</span><br><span class="line">age_df[<span class="string">&#x27;年龄段&#x27;</span>] = pd.cut(age_df[<span class="string">&#x27;年龄&#x27;</span>], bins=bins, labels=labels, right=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算每个年龄段的借款统计</span></span><br><span class="line">age_group_stats = df.groupby(<span class="string">&#x27;年龄段&#x27;</span>).agg(&#123;</span><br><span class="line">    <span class="string">&#x27;借款金额&#x27;</span>: [<span class="string">&#x27;sum&#x27;</span>, <span class="string">&#x27;mean&#x27;</span>, <span class="string">&#x27;count&#x27;</span>]</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">age_group_stats.columns = [<span class="string">&#x27;借款金额总和&#x27;</span>, <span class="string">&#x27;平均借款金额&#x27;</span>, <span class="string">&#x27;借款次数&#x27;</span>]</span><br><span class="line">age_group_stats = age_group_stats.reset_index()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 显示结果</span></span><br><span class="line"><span class="built_in">print</span>(age_group_stats)</span><br></pre></td></tr></table></figure></div>

<pre><code>     年龄段      借款金额总和         平均借款金额    借款次数
0  18-24   296139563    4755.963239   62267
1  25-34  1554537910    8642.275290  179876
2  35-44   527141564   12732.272934   41402
3  45-54   106455104   12088.928458    8806
4  55-64     4524174   24722.262295     183
5  65-74     2500000  500000.000000       5
</code></pre>
<h3 id="不同年龄段用户还款占比统计"><a href="#不同年龄段用户还款占比统计" class="headerlink" title="不同年龄段用户还款占比统计"></a>不同年龄段用户还款占比统计</h3><div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 添加年龄段分类</span></span><br><span class="line">bins = [<span class="number">0</span>, <span class="number">24</span>, <span class="number">34</span>, <span class="number">44</span>, <span class="number">54</span>, <span class="number">100</span>]</span><br><span class="line">labels = [<span class="string">&#x27;&lt;25&#x27;</span>, <span class="string">&#x27;25-34&#x27;</span>, <span class="string">&#x27;35-44&#x27;</span>, <span class="string">&#x27;45-54&#x27;</span>, <span class="string">&#x27;55+&#x27;</span>]</span><br><span class="line">age_per_df = df</span><br><span class="line">age_per_df[<span class="string">&#x27;年龄段&#x27;</span>] = pd.cut(age_per_df[<span class="string">&#x27;年龄&#x27;</span>], bins=bins, labels=labels, right=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算每个年龄段的已还本金总额</span></span><br><span class="line">repayment_by_age_group = df.groupby(<span class="string">&#x27;年龄段&#x27;</span>)[<span class="string">&#x27;已还本金&#x27;</span>].<span class="built_in">sum</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算总的已还本金以确定占比</span></span><br><span class="line">total_repayment = df[<span class="string">&#x27;已还本金&#x27;</span>].<span class="built_in">sum</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算占比</span></span><br><span class="line">repayment_ratio = (repayment_by_age_group / total_repayment * <span class="number">100</span>).reset_index()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置新的列名以改进展示</span></span><br><span class="line">repayment_ratio.columns = [<span class="string">&#x27;年龄段&#x27;</span>, <span class="string">&#x27;已还本金占比（%）&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出结果</span></span><br><span class="line"><span class="built_in">print</span>(repayment_ratio)</span><br></pre></td></tr></table></figure></div>

<pre><code>     年龄段  已还本金占比（%）
0    &lt;25  14.278337
1  25-34  62.234454
2  35-44  18.792848
3  45-54   4.536181
4    55+   0.158180
</code></pre>
<h2 id="数据分析常用函数"><a href="#数据分析常用函数" class="headerlink" title="数据分析常用函数"></a>数据分析常用函数</h2><h3 id="数据筛选"><a href="#数据筛选" class="headerlink" title="数据筛选"></a>数据筛选</h3><p>如果是筛选行列的话，通常有以下几种方法：<br>有时我们需要按条件选择部分列、部分行，一般常用的方法有：</p>
<table>
<thead>
<tr>
<th align="center">操作</th>
<th align="center">语法</th>
<th align="center">返回结果</th>
</tr>
</thead>
<tbody><tr>
<td align="center">选择列</td>
<td align="center">df[col]</td>
<td align="center">Series</td>
</tr>
<tr>
<td align="center">按索引选择行</td>
<td align="center">df.loc[label]</td>
<td align="center">Series</td>
</tr>
<tr>
<td align="center">按数字索引选择行</td>
<td align="center">df.iloc[loc]</td>
<td align="center">Series</td>
</tr>
<tr>
<td align="center">使用切片选择行</td>
<td align="center">df[:5]</td>
<td align="center">DataFrame</td>
</tr>
<tr>
<td align="center">用表达式筛选行[3]</td>
<td align="center">df[bool_vec]</td>
<td align="center">DataFrame</td>
</tr>
</tbody></table>
<p>除此以外，还有很多方法&#x2F;函数可以用于“数据筛选”</p>
<h3 id="数据预览"><a href="#数据预览" class="headerlink" title="数据预览"></a>数据预览</h3><p>对于探索性数据分析来说，做数据分析前需要先看一下数据的总体概况。</p>
<ul>
<li><code>info()</code>方法用来查看数据集信息</li>
<li><code>describe()</code>方法将返回描述性统计信息，这两个函数大家应该都很熟悉了。</li>
<li><code>describe</code>方法默认只给出数值型变量的常用统计量，要想对DataFrame中的每个变量进行汇总统计，可以将其中的参数<code>include</code>设为<code>all</code>。<code>head()</code>方法显示数据集的前n行</li>
<li><code>tail()</code> 方法显示数据集的后n行。</li>
<li><code>sample()</code>方法随机看N行的数据。</li>
</ul>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.sample(<span class="number">3</span>)</span><br></pre></td></tr></table></figure></div>

<ul>
<li><code>df.dtypes</code> 检查数据中各列的数据类型。</li>
<li><code>df.columns</code> 查看所有的列名 。</li>
</ul>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df.dtypes</span><br><span class="line">df.columns</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Index([&#x27;日期&#x27;, &#x27;销量&#x27;], dtype=&#x27;object&#x27;)</span><br></pre></td></tr></table></figure></div>

<p><code>.dfshape()</code> 获得数据集的大小（长宽）。</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.shape</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(5, 2)</span><br></pre></td></tr></table></figure></div>

<ul>
<li><code>len(df)</code>可以查看总个数</li>
<li><code>df.count()</code>则可以查看有效个数，不包含无效值（Nan）</li>
</ul>
<h3 id="缺失值与重复值"><a href="#缺失值与重复值" class="headerlink" title="缺失值与重复值"></a>缺失值与重复值</h3><p>Pandas清洗数据时，判断缺失值一般采用<code>isnull()</code>方法。<br><code>isnull().any()</code>会判断哪些”列”存在缺失值。<br><code>isnull().sum()</code>用于将列中为空的个数统计出来。</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.isnull().<span class="built_in">any</span>()</span><br></pre></td></tr></table></figure></div>

<div class="highlight-container" data-rel="Plaintext"><figure class="iseeu highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">日期 False</span><br><span class="line">销量 True</span><br><span class="line">dtype: bool</span><br></pre></td></tr></table></figure></div>

<p>发现“销量”这列存在缺失值后，处理办法要么删除<code>dropna()</code> ，要么填充<code>fillna()</code>。</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.fillna(<span class="number">50</span>)</span><br></pre></td></tr></table></figure></div>

<ul>
<li>Pandas清洗数据时，判断重复值一般采用<code>duplicated()</code>方法。</li>
<li>如果想要直接删除重复值，可以使用<code>drop_duplicates()</code> 方法。</li>
</ul>
<h3 id="数据值操作"><a href="#数据值操作" class="headerlink" title="数据值操作"></a>数据值操作</h3><p>在数值数据操作中，<code>apply()</code>函数的功能是将一个自定义函数作用于DataFrame的行或者列；<code>applymap()</code>函数的功能是将自定义函数作用于DataFrame的所有元素。</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[<span class="string">&quot;数量&quot;</span>].apply(<span class="keyword">lambda</span> x: x+<span class="number">1</span>)</span><br></pre></td></tr></table></figure></div>

<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://imagedelivery.net/sodhLvOXTBoeXxRe03g_RA/7d5c4497-e90c-4da1-278e-f54017a56e00/public"
                      width = "500"
                >

<p>数据批量替换的情况，<code>replace()</code>是很好的解决方法。它既支持替换全部或者某一行，也支持替换指定的某个或指定的多个数值（用字典的形式）。还可以使用正则表达式替换。</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[<span class="string">&quot;编号&quot;</span>].replace(<span class="string">r&#x27;BA.$&#x27;</span>, value=<span class="string">&#x27;NEW&#x27;</span>, regex=<span class="literal">True</span>, inplace = <span class="literal">True</span>)</span><br></pre></td></tr></table></figure></div>

<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://imagedelivery.net/sodhLvOXTBoeXxRe03g_RA/ae4b4a6a-7f4f-43d1-e3cf-dce673bb6b00/public"
                      width = "500"
                >

<p>调⽤<code>rank()</code>⽅法可以实现数据排名。</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[<span class="string">&quot;排名&quot;</span>] = df.rank(method=<span class="string">&quot;dense&quot;</span>).astype(<span class="string">&quot;int&quot;</span>)</span><br></pre></td></tr></table></figure></div>

<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://imagedelivery.net/sodhLvOXTBoeXxRe03g_RA/a2a0b9b7-41e3-46d5-c053-28aedaf97700/public"
                      width = "500"
                >

<p><code>rank()</code>⽅法中的<code>method</code>参数，它有5个常⽤选项，可以帮助我们实现不同情况下的排名。</p>
<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://imagedelivery.net/sodhLvOXTBoeXxRe03g_RA/caa0bb9f-5fdd-40af-1d11-5e3504552400/public"
                      width = "500"
                >

<p>唯一值，<code>unique()</code>是以数组形式返回列的所有唯一值，而<code>nunique()</code>返回的是唯一值的个数。</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df[<span class="string">&quot;gender&quot;</span>].unique()</span><br><span class="line">df[<span class="string">&quot;gender&quot;</span>].nunique()</span><br></pre></td></tr></table></figure></div>

<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://imagedelivery.net/sodhLvOXTBoeXxRe03g_RA/ff43ed8b-8cda-46d5-ff98-a024e0ab2f00/public"
                      width = "500"
                >

<p><code>clip()</code>方法，用于对超过或者低于某些数的数值进行截断[1]，来保证数值在一定范围。比如每月的迟到天数一定是在0-31天之间。</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[<span class="string">&quot;迟到天数&quot;</span>] = df[<span class="string">&quot;迟到天数&quot;</span>].clip(<span class="number">0</span>,<span class="number">31</span>)</span><br></pre></td></tr></table></figure></div>

<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://imagedelivery.net/sodhLvOXTBoeXxRe03g_RA/d49d14b3-820f-4017-8cc2-4e6bd2386900/public"
                      width = "500"
                >

<h3 id="行-列操作"><a href="#行-列操作" class="headerlink" title="行&#x2F;列操作"></a>行&#x2F;列操作</h3><p><code>rename()</code>重命名用于更改行列的标签，即行列的索引。可以传入一个字典或者一个函数。在数据预处理中，比较常用。</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.rename(columns=&#123;<span class="string">&#x27;mark&#x27;</span>: <span class="string">&#x27;sell&#x27;</span>&#125;, inplace=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure></div>

<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://imagedelivery.net/sodhLvOXTBoeXxRe03g_RA/28770c41-d7cb-41a0-58ca-2021fd057f00/public"
                      width = "500"
                >

<p>数据清洗时，会将带空值的行删除，此时DataFrame或Series类型的数据不再是连续的索引，可以使用<code>reset_index()</code>重置索引。</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.reset_index(drop=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure></div>

<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://imagedelivery.net/sodhLvOXTBoeXxRe03g_RA/b50c5bd9-d858-46e2-7719-ff6243beea00/public"
                      width = "500"
                >

<p>删除行列，可以使用<code>drop()</code>。</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.drop(columns=[<span class="string">&quot;mark&quot;</span>])</span><br></pre></td></tr></table></figure></div>

<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://imagedelivery.net/sodhLvOXTBoeXxRe03g_RA/98784bcb-e940-4dd4-446e-357c71cbf700/public"
                      width = "500"
                >

<p>行列转置，我们可以使用<code>T</code>属性获得转置后的DataFrame。</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.T</span><br></pre></td></tr></table></figure></div>

<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://imagedelivery.net/sodhLvOXTBoeXxRe03g_RA/a54d21ce-1686-4feb-7e8b-b8b1f0d85000/public"
                      width = "500"
                >

<p><code>melt()</code>方法可以将宽表转长表，即表格型数据转为树形数据。</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.melt(id_vars=<span class="string">&quot;姓名&quot;</span>, var_name=<span class="string">&quot;科目&quot;</span>, value_name=<span class="string">&quot;成绩&quot;</span>)</span><br></pre></td></tr></table></figure></div>

<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://imagedelivery.net/sodhLvOXTBoeXxRe03g_RA/3619a44d-5c76-4152-24be-518f9b4eb400/public"
                      width = "500"
                >

<p><code>pivot()</code>方法可以将长表转宽表，即树形数据转为表格型数据。</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.pivot(index=<span class="string">&#x27;姓名&#x27;</span>, columns=<span class="string">&#x27;科目&#x27;</span>, values=<span class="string">&#x27;成绩&#x27;</span>)</span><br></pre></td></tr></table></figure></div>

<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://imagedelivery.net/sodhLvOXTBoeXxRe03g_RA/3f978462-5366-4c4e-0c9a-5b8eed105000/public"
                      width = "500"
                >

<p>数据分组与数据透视表更是一个常见的需求，<code>groupby()</code>方法可以用于数据分组。</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.groupby(<span class="string">&quot;科目&quot;</span>).mean()</span><br></pre></td></tr></table></figure></div>

<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://imagedelivery.net/sodhLvOXTBoeXxRe03g_RA/6e9032a0-eac0-4cb0-22f1-aade19634000/public"
                      width = "500"
                >

<p><code>pivot_table()</code>数据透视表</p>
<h3 id="数值数据统计运算"><a href="#数值数据统计运算" class="headerlink" title="数值数据统计运算"></a>数值数据统计运算</h3><p>在对数值型的数据进行统计运算时，除了有算术运算、比较预算还有各种常见的汇总统计运行函数，具体如下表所示</p>
<table>
<thead>
<tr>
<th align="center">函数方法</th>
<th align="center">用法释义</th>
</tr>
</thead>
<tbody><tr>
<td align="center">count</td>
<td align="center">非NaN数据项计数</td>
</tr>
<tr>
<td align="center">sum</td>
<td align="center">求和</td>
</tr>
<tr>
<td align="center">mean</td>
<td align="center">平均值</td>
</tr>
<tr>
<td align="center">median</td>
<td align="center">中位数</td>
</tr>
<tr>
<td align="center">mode</td>
<td align="center">众数</td>
</tr>
<tr>
<td align="center">max</td>
<td align="center">最大值</td>
</tr>
<tr>
<td align="center">min</td>
<td align="center">最小值</td>
</tr>
<tr>
<td align="center">std</td>
<td align="center">标准差</td>
</tr>
<tr>
<td align="center">var</td>
<td align="center">方差</td>
</tr>
<tr>
<td align="center">quantile</td>
<td align="center">分位数</td>
</tr>
<tr>
<td align="center">skew</td>
<td align="center">返回偏态系数</td>
</tr>
<tr>
<td align="center">kurt</td>
<td align="center">返回峰态系数</td>
</tr>
</tbody></table>
<p>累加<code>cumsum()</code>。</p>
<div class="highlight-container" data-rel="Python"><figure class="iseeu highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df[<span class="string">&quot;累计销量&quot;</span>] = df[<span class="string">&quot;销量&quot;</span>].cumsum()</span><br></pre></td></tr></table></figure></div>

<img  
                     lazyload
                     src="/images/loading.svg"
                     data-src="https://imagedelivery.net/sodhLvOXTBoeXxRe03g_RA/288019bf-0614-443b-af05-cadf7e3ba800/public"
                      width = "500"
                >

<h3 id="文本数据操作"><a href="#文本数据操作" class="headerlink" title="文本数据操作"></a>文本数据操作</h3><p>在对文本型的数据进行处理时，我们会大量应用字符串的函数，来实现对一列文本数据进行操作。</p>
<table>
<thead>
<tr>
<th align="center">函数方法</th>
<th align="center">用法释义</th>
</tr>
</thead>
<tbody><tr>
<td align="center">cat</td>
<td align="center">字符串的拼接</td>
</tr>
<tr>
<td align="center">contains</td>
<td align="center">判断某个字符串是否包含给定字符</td>
</tr>
<tr>
<td align="center">startswith&#x2F;endswith</td>
<td align="center">判断某个字符串是否以…开头&#x2F;结尾</td>
</tr>
<tr>
<td align="center">get</td>
<td align="center">获取指定位置的字符串</td>
</tr>
<tr>
<td align="center">len</td>
<td align="center">计算字符串长度</td>
</tr>
<tr>
<td align="center">upper、lower</td>
<td align="center">英文大小写转换</td>
</tr>
<tr>
<td align="center">pad&#x2F;center</td>
<td align="center">在字符串的左边、右边或左右两边添加给定字符</td>
</tr>
<tr>
<td align="center">repeat</td>
<td align="center">重复字符串几次</td>
</tr>
<tr>
<td align="center">slice_replace</td>
<td align="center">使用给定的字符串，替换指定的位置的字符</td>
</tr>
<tr>
<td align="center">split</td>
<td align="center">分割字符串，将一列扩展为多列</td>
</tr>
<tr>
<td align="center">strip、rstrip、lstrip</td>
<td align="center">去除空白符、换行符</td>
</tr>
<tr>
<td align="center">findall</td>
<td align="center">利用正则表达式，去字符串中匹配，返回查找结果的列表</td>
</tr>
<tr>
<td align="center">extract、extractall</td>
<td align="center">接受正则表达式，抽取匹配的字符串(一定要加上括号)</td>
</tr>
</tbody></table>

        </div>

        
            <div class="post-copyright-info w-full my-8 px-2 sm:px-6 md:px-8">
                <div class="article-copyright-info-container">
    <ul>
        <li><strong>标题:</strong> Pandas</li>
        <li><strong>作者:</strong> Yiuhang Chan</li>
        <li><strong>创建于
                :</strong> 2018-11-12 10:23:47</li>
        
            <li>
                <strong>更新于
                    :</strong> 2024-03-19 17:53:53
            </li>
        
        <li>
            <strong>链接:</strong> https://www.yiuhangblog.com/2018/11/12/20181112Pandas/
        </li>
        <li>
            <strong>
                版权声明:
            </strong>
            

            
                本文章采用 <a class="license" target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0">CC BY-NC-SA 4.0</a> 进行许可。
            
        </li>
    </ul>
</div>

            </div>
        

        
            <ul class="post-tags-box text-lg mt-1.5 flex-wrap justify-center flex md:hidden">
                
                    <li class="tag-item mx-0.5">
                        <a href="/tags/%E5%9F%BA%E7%A1%80/">#基础</a>&nbsp;
                    </li>
                
                    <li class="tag-item mx-0.5">
                        <a href="/tags/%E7%90%86%E8%AE%BA/">#理论</a>&nbsp;
                    </li>
                
                    <li class="tag-item mx-0.5">
                        <a href="/tags/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/">#数据分析</a>&nbsp;
                    </li>
                
                    <li class="tag-item mx-0.5">
                        <a href="/tags/Pandas/">#Pandas</a>&nbsp;
                    </li>
                
            </ul>
        

        

        
            <div class="article-nav my-8 flex justify-between items-center px-2 sm:px-6 md:px-8">
                
                    <div class="article-prev border-border-color shadow-redefine-flat shadow-shadow-color-2 rounded-medium px-4 py-2 hover:shadow-redefine-flat-hover hover:shadow-shadow-color-2">
                        <a class="prev"
                        rel="prev"
                        href="/2018/11/13/20181113HTML/"
                        >
                            <span class="left arrow-icon flex justify-center items-center">
                                <i class="fa-solid fa-chevron-left"></i>
                            </span>
                            <span class="title flex justify-center items-center">
                                <span class="post-nav-title-item">HTML</span>
                                <span class="post-nav-item">上一篇</span>
                            </span>
                        </a>
                    </div>
                
                
                    <div class="article-next border-border-color shadow-redefine-flat shadow-shadow-color-2 rounded-medium px-4 py-2 hover:shadow-redefine-flat-hover hover:shadow-shadow-color-2">
                        <a class="next"
                        rel="next"
                        href="/2018/10/22/20181022NumPy/"
                        >
                            <span class="title flex justify-center items-center">
                                <span class="post-nav-title-item">NumPy</span>
                                <span class="post-nav-item">下一篇</span>
                            </span>
                            <span class="right arrow-icon flex justify-center items-center">
                                <i class="fa-solid fa-chevron-right"></i>
                            </span>
                        </a>
                    </div>
                
            </div>
        


        
            <div class="comment-container px-2 sm:px-6 md:px-8 pb-8">
                <div class="comments-container mt-10 w-full ">
    <div id="comment-anchor" class="w-full h-2.5"></div>
    <div class="comment-area-title w-full my-1.5 md:my-2.5 text-xl md:text-3xl font-bold">
        评论
    </div>
    

        
            
    <div id="waline"></div>
    <script type="module" data-swup-reload-script>
      import { init } from '/js/libs/waline.mjs';

      function loadWaline() {
        init({
          el: '#waline',
          serverURL: 'https://comment.yiuhangblog.com',
          lang: 'zh-CN',
          dark: 'body[class~="dark-mode"]',
          requiredMeta: ['nick', 'mail'],
          emoji: [],
          recaptchaV3Key: "wasd",
          
        });
      }

      if (typeof swup !== 'undefined') {
        loadWaline();
      } else {
        window.addEventListener('DOMContentLoaded', loadWaline);
      }
    </script>



        
    
</div>

            </div>
        
    </div>

    
        <div class="toc-content-container">
            <div class="post-toc-wrap">
    <div class="post-toc">
        <div class="toc-title">此页目录</div>
        <div class="page-title">Pandas</div>
        <ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Pandas%E7%AE%80%E4%BB%8B"><span class="nav-text">Pandas简介</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E7%9A%84%E8%AF%BB%E5%8F%96%E4%B8%8E%E6%95%B0%E6%8D%AE%E5%88%9B%E5%BB%BA"><span class="nav-text">文件的读取与数据创建</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%AF%BB%E5%8F%96CSV%E6%96%87%E4%BB%B6"><span class="nav-text">读取CSV文件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AD%98%E5%82%A8CSV%E6%96%87%E4%BB%B6"><span class="nav-text">存储CSV文件</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%84%E7%90%86Excel%E6%96%87%E4%BB%B6"><span class="nav-text">处理Excel文件</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%AF%BB%E5%8F%96Excel%E6%96%87%E4%BB%B6"><span class="nav-text">读取Excel文件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AD%98%E5%82%A8%E4%B8%BAExcel%E6%96%87%E4%BB%B6"><span class="nav-text">存储为Excel文件</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%84%E7%90%86JSON%E6%95%B0%E6%8D%AE"><span class="nav-text">处理JSON数据</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%AF%BB%E5%8F%96JSON%E6%95%B0%E6%8D%AE"><span class="nav-text">读取JSON数据</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AD%98%E5%82%A8%E4%B8%BAJSON%E6%96%87%E4%BB%B6"><span class="nav-text">存储为JSON文件</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%8EMySQL%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BA%A4%E4%BA%92"><span class="nav-text">与MySQL数据库交互</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%AF%BB%E5%8F%96MySQL%E6%95%B0%E6%8D%AE%E5%BA%93%E6%95%B0%E6%8D%AE"><span class="nav-text">读取MySQL数据库数据</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AD%98%E5%82%A8%E6%95%B0%E6%8D%AE%E5%88%B0MySQL%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="nav-text">存储数据到MySQL数据库</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%88%9B%E5%BB%BAPandas-Series"><span class="nav-text">创建Pandas Series</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Series%E7%9A%84%E7%89%B9%E7%82%B9"><span class="nav-text">Series的特点</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95"><span class="nav-text">基础语法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8F%82%E6%95%B0%E8%AF%B4%E6%98%8E"><span class="nav-text">参数说明</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%9B%E5%BB%BASeries%E7%A4%BA%E4%BE%8B"><span class="nav-text">创建Series示例</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%A4%BA%E4%BE%8B1-%E4%BD%BF%E7%94%A8%E5%88%97%E8%A1%A8%E5%88%9B%E5%BB%BASeries"><span class="nav-text">示例1: 使用列表创建Series</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%A4%BA%E4%BE%8B2-%E4%BD%BF%E7%94%A8NumPy%E6%95%B0%E7%BB%84%E5%88%9B%E5%BB%BASeries"><span class="nav-text">示例2: 使用NumPy数组创建Series</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E7%B4%A2%E5%BC%95%E8%8E%B7%E5%8F%96%E6%95%B0%E6%8D%AE"><span class="nav-text">使用索引获取数据</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%A4%BA%E4%BE%8B1-%E4%BD%BF%E7%94%A8%E9%BB%98%E8%AE%A4%E6%95%B4%E6%95%B0%E7%B4%A2%E5%BC%95%E8%8E%B7%E5%8F%96%E6%95%B0%E6%8D%AE"><span class="nav-text">示例1: 使用默认整数索引获取数据</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8C%87%E5%AE%9A%E7%B4%A2%E5%BC%95"><span class="nav-text">指定索引</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%A4%BA%E4%BE%8B2-%E4%BD%BF%E7%94%A8%E8%87%AA%E5%AE%9A%E4%B9%89%E7%B4%A2%E5%BC%95"><span class="nav-text">示例2: 使用自定义索引</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%A4%BA%E4%BE%8B3-%E4%BD%BF%E7%94%A8%E8%87%AA%E5%AE%9A%E4%B9%89%E7%B4%A2%E5%BC%95%E8%AE%BF%E9%97%AE%E6%95%B0%E6%8D%AE"><span class="nav-text">示例3: 使用自定义索引访问数据</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E5%AD%97%E5%85%B8%E5%88%9B%E5%BB%BASeries"><span class="nav-text">使用字典创建Series</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%A4%BA%E4%BE%8B1-%E4%BB%8E%E5%AD%97%E5%85%B8%E5%88%9B%E5%BB%BASeries"><span class="nav-text">示例1: 从字典创建Series</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%A4%BA%E4%BE%8B2-%E6%8C%87%E5%AE%9A%E7%B4%A2%E5%BC%95%E8%BF%87%E6%BB%A4%E6%95%B0%E6%8D%AE"><span class="nav-text">示例2: 指定索引过滤数据</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%AE%BE%E7%BD%AESeries%E5%90%8D%E7%A7%B0%E5%8F%82%E6%95%B0"><span class="nav-text">设置Series名称参数</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C"><span class="nav-text">基本操作</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%8E%B7%E5%8F%96%E5%80%BC"><span class="nav-text">获取值</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%81%8D%E5%8E%86Series"><span class="nav-text">遍历Series</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9F%BA%E6%9C%AC%E8%BF%90%E7%AE%97"><span class="nav-text">基本运算</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%AE%97%E6%9C%AF%E8%BF%90%E7%AE%97"><span class="nav-text">算术运算</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%BF%87%E6%BB%A4"><span class="nav-text">过滤</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%BA%94%E7%94%A8%E6%95%B0%E5%AD%A6%E5%87%BD%E6%95%B0"><span class="nav-text">应用数学函数</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B1%9E%E6%80%A7%E5%92%8C%E6%96%B9%E6%B3%95"><span class="nav-text">属性和方法</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%8E%B7%E5%8F%96%E7%B4%A2%E5%BC%95%E5%92%8C%E5%80%BC"><span class="nav-text">获取索引和值</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8F%8F%E8%BF%B0%E7%BB%9F%E8%AE%A1"><span class="nav-text">描述统计</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%8E%B7%E5%8F%96%E6%9C%80%E5%A4%A7%E5%80%BC%E5%92%8C%E6%9C%80%E5%B0%8F%E5%80%BC%E7%9A%84%E7%B4%A2%E5%BC%95"><span class="nav-text">获取最大值和最小值的索引</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#DataFrame"><span class="nav-text">DataFrame</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9F%BA%E7%A1%80%E8%AF%AD%E6%B3%95-1"><span class="nav-text">基础语法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8F%82%E6%95%B0%E8%AF%B4%E6%98%8E-1"><span class="nav-text">参数说明</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%9B%E5%BB%BADataFrame%E7%A4%BA%E4%BE%8B"><span class="nav-text">创建DataFrame示例</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%80%9A%E8%BF%87%E5%88%97%E8%A1%A8%E5%88%9B%E5%BB%BADataFrame"><span class="nav-text">通过列表创建DataFrame</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%80%9A%E8%BF%87ndarrays%E6%88%96%E5%88%97%E8%A1%A8%E7%9A%84%E5%AD%97%E5%85%B8%E5%88%9B%E5%BB%BA"><span class="nav-text">通过ndarrays或列表的字典创建</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%80%9A%E8%BF%87%E5%AD%97%E5%85%B8%E5%88%97%E8%A1%A8%E5%88%9B%E5%BB%BA"><span class="nav-text">通过字典列表创建</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#loc-%E5%B1%9E%E6%80%A7%E8%BF%94%E5%9B%9E%E6%8C%87%E5%AE%9A%E8%A1%8C%E7%9A%84%E6%95%B0%E6%8D%AE"><span class="nav-text">loc 属性返回指定行的数据</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%BF%94%E5%9B%9E%E5%8D%95%E8%A1%8C%E6%95%B0%E6%8D%AE"><span class="nav-text">返回单行数据</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%BF%94%E5%9B%9E%E5%A4%9A%E8%A1%8C%E6%95%B0%E6%8D%AE"><span class="nav-text">返回多行数据</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E8%87%AA%E5%AE%9A%E4%B9%89%E7%B4%A2%E5%BC%95"><span class="nav-text">使用自定义索引</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C-1"><span class="nav-text">基本操作</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%8E%B7%E5%8F%96%E5%88%97"><span class="nav-text">获取列</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%8E%B7%E5%8F%96%E8%A1%8C"><span class="nav-text">获取行</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%80%89%E6%8B%A9%E5%A4%9A%E5%88%97"><span class="nav-text">选择多列</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%BF%87%E6%BB%A4%E8%A1%8C"><span class="nav-text">过滤行</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B1%9E%E6%80%A7%E5%92%8C%E6%96%B9%E6%B3%95-1"><span class="nav-text">属性和方法</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%8E%B7%E5%8F%96%E5%88%97%E5%90%8D"><span class="nav-text">获取列名</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%8E%B7%E5%8F%96%E5%BD%A2%E7%8A%B6%EF%BC%88%E8%A1%8C%E6%95%B0%E5%92%8C%E5%88%97%E6%95%B0%EF%BC%89"><span class="nav-text">获取形状（行数和列数）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%8E%B7%E5%8F%96%E7%B4%A2%E5%BC%95"><span class="nav-text">获取索引</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%8E%B7%E5%8F%96%E6%8F%8F%E8%BF%B0%E7%BB%9F%E8%AE%A1%E4%BF%A1%E6%81%AF"><span class="nav-text">获取描述统计信息</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E6%93%8D%E4%BD%9C"><span class="nav-text">数据操作</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%B7%BB%E5%8A%A0%E6%96%B0%E5%88%97"><span class="nav-text">添加新列</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%A0%E9%99%A4%E5%88%97"><span class="nav-text">删除列</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8E%92%E5%BA%8F"><span class="nav-text">排序</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%87%8D%E5%91%BD%E5%90%8D%E5%88%97"><span class="nav-text">重命名列</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BB%8E%E5%A4%96%E9%83%A8%E6%95%B0%E6%8D%AE%E6%BA%90%E5%88%9B%E5%BB%BA-DataFrame"><span class="nav-text">从外部数据源创建 DataFrame</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BB%8ECSV%E6%96%87%E4%BB%B6%E5%88%9B%E5%BB%BA"><span class="nav-text">从CSV文件创建</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BB%8EExcel%E6%96%87%E4%BB%B6%E5%88%9B%E5%BB%BA"><span class="nav-text">从Excel文件创建</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BB%8E%E5%AD%97%E5%85%B8%E5%88%97%E8%A1%A8%E5%88%9B%E5%BB%BA"><span class="nav-text">从字典列表创建</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%A1%88%E4%BE%8B"><span class="nav-text">案例</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BC%BA%E5%A4%B1%E7%8E%87"><span class="nav-text">缺失率</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E6%95%B0%E6%8D%AE%E8%A1%A8"><span class="nav-text">创建数据表</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E6%A6%82%E8%A7%88"><span class="nav-text">数据概览</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%AF%8F%E5%88%97%E7%BC%BA%E5%A4%B1%E5%80%BC%E7%9A%84%E6%95%B0%E9%87%8F"><span class="nav-text">每列缺失值的数量</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BC%BA%E5%A4%B1%E7%8E%87-1"><span class="nav-text">缺失率</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#DataFrame%E5%B8%B8%E8%A7%84%E6%93%8D%E4%BD%9C"><span class="nav-text">DataFrame常规操作</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BF%AE%E6%94%B9index%E3%80%81columns"><span class="nav-text">修改index、columns</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BF%AE%E6%94%B9DataFrame%E7%9A%84%E7%B4%A2%E5%BC%95%EF%BC%88index%EF%BC%89"><span class="nav-text">修改DataFrame的索引（index）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%AF%BB%E5%8F%96%E6%96%87%E4%BB%B6%E6%97%B6%E5%8F%AA%E5%A4%84%E7%90%86%E9%83%A8%E5%88%86%E8%A1%8C"><span class="nav-text">读取文件时只处理部分行</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BF%AE%E6%94%B9DataFrame%E7%9A%84%E5%88%97%E5%90%8D%EF%BC%88columns%EF%BC%89"><span class="nav-text">修改DataFrame的列名（columns）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8D%95%E7%8B%AC%E4%BF%AE%E6%94%B9%E4%B8%80%E4%B8%AA%E7%B4%A2%E5%BC%95%E6%88%96%E5%88%97%E5%90%8D"><span class="nav-text">单独修改一个索引或列名</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BB%BC%E5%90%88%E7%A4%BA%E4%BE%8B"><span class="nav-text">综合示例</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E5%AF%BC%E5%85%A5"><span class="nav-text">数据导入</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%BF%AE%E6%94%B9%E7%B4%A2%E5%BC%95%E5%89%8D%E7%9A%84%E8%BE%93%E5%87%BA"><span class="nav-text">修改索引前的输出</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%BF%AE%E6%94%B9%E7%B4%A2%E5%BC%95%E5%90%8E%E7%9A%84%E8%BE%93%E5%87%BA"><span class="nav-text">修改索引后的输出</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%BF%AE%E6%94%B9%E5%88%97%E5%90%8D"><span class="nav-text">修改列名</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8rename%E6%96%B9%E6%B3%95%E9%87%8D%E5%91%BD%E5%90%8D%E5%88%97"><span class="nav-text">使用rename方法重命名列</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%8D%95%E7%8B%AC%E4%BF%AE%E6%94%B9%E4%B8%80%E4%B8%AA%E7%B4%A2%E5%BC%95"><span class="nav-text">单独修改一个索引</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E5%90%88%E5%B9%B6"><span class="nav-text">数据合并</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#concat-%E5%87%BD%E6%95%B0%E6%A6%82%E8%A7%88"><span class="nav-text">concat()函数概览</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%A4%BA%E4%BE%8B%E6%95%B0%E6%8D%AE"><span class="nav-text">示例数据</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E9%80%89%E6%8B%A9%E6%80%A7%E8%AF%BB%E5%8F%96%E8%A1%8C"><span class="nav-text">选择性读取行</span></a></li></ol></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%B2%BF%E7%9D%80%E5%88%97%E5%90%88%E5%B9%B6DataFrame"><span class="nav-text">沿着列合并DataFrame</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%B2%BF%E7%9D%80%E8%A1%8C%E5%90%88%E5%B9%B6DataFrame"><span class="nav-text">沿着行合并DataFrame</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E9%87%8D%E7%BD%AE%E7%B4%A2%E5%BC%95%E4%BB%A5%E9%81%BF%E5%85%8D%E7%B4%A2%E5%BC%95%E9%87%8D%E5%A4%8D"><span class="nav-text">重置索引以避免索引重复</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#merge"><span class="nav-text">merge()</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%A4%BA%E4%BE%8B%E6%95%B0%E6%8D%AE-1"><span class="nav-text">示例数据</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%9F%BA%E4%BA%8E%E5%85%B1%E5%90%8C%E5%88%97%E5%90%88%E5%B9%B6DataFrame"><span class="nav-text">基于共同列合并DataFrame</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%9F%BA%E4%BA%8E%E4%B8%8D%E5%90%8C%E5%88%97%E5%90%8D%E7%9A%84%E5%90%88%E5%B9%B6"><span class="nav-text">基于不同列名的合并</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%8C%87%E5%AE%9A%E5%90%88%E5%B9%B6%E6%96%B9%E5%BC%8F"><span class="nav-text">指定合并方式</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#join"><span class="nav-text">join()</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%B7%A6%E8%BF%9E%E6%8E%A5%EF%BC%88Left-Join%EF%BC%89"><span class="nav-text">左连接（Left Join）</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%8F%B3%E8%BF%9E%E6%8E%A5%EF%BC%88Right-Join%EF%BC%89"><span class="nav-text">右连接（Right Join）</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%A4%96%E8%BF%9E%E6%8E%A5%EF%BC%88Outer-Join%EF%BC%89"><span class="nav-text">外连接（Outer Join）</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%86%85%E8%BF%9E%E6%8E%A5%EF%BC%88Inner-Join%EF%BC%89"><span class="nav-text">内连接（Inner Join）</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E7%A4%BA%E4%BE%8B"><span class="nav-text">使用示例</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E5%88%A0%E9%99%A4"><span class="nav-text">数据删除</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8del%E8%AF%AD%E5%8F%A5%E5%88%A0%E9%99%A4%E5%88%97"><span class="nav-text">使用del语句删除列</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8drop%E6%96%B9%E6%B3%95%E5%88%A0%E9%99%A4%E6%95%B0%E6%8D%AE"><span class="nav-text">使用drop方法删除数据</span></a><ol class="nav-child"><li class="nav-item nav-level-6"><a class="nav-link" href="#%E5%88%A0%E9%99%A4%E8%A1%8C%EF%BC%9A"><span class="nav-text">删除行：</span></a></li><li class="nav-item nav-level-6"><a class="nav-link" href="#%E5%88%A0%E9%99%A4%E5%88%97%EF%BC%9A"><span class="nav-text">删除列：</span></a></li></ol></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Pandas%E6%95%B0%E6%8D%AE%E6%B8%85%E6%B4%97"><span class="nav-text">Pandas数据清洗</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B8%85%E6%B4%97%E9%87%8D%E5%A4%8D%E6%95%B0%E6%8D%AE"><span class="nav-text">清洗重复数据</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%AF%BB%E5%8F%96%E6%95%B0%E6%8D%AE"><span class="nav-text">读取数据</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A3%80%E6%9F%A5%E9%87%8D%E5%A4%8D%E8%A1%8C"><span class="nav-text">检查重复行</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%A0%E9%99%A4%E9%87%8D%E5%A4%8D%E8%A1%8C"><span class="nav-text">删除重复行</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B8%85%E6%B4%97%E7%A9%BA%E5%80%BC"><span class="nav-text">清洗空值</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BB%9F%E8%AE%A1%E7%A9%BA%E5%80%BC%E5%92%8C%E8%AE%A1%E7%AE%97%E7%BC%BA%E5%A4%B1%E7%8E%87"><span class="nav-text">统计空值和计算缺失率</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E7%BB%9F%E8%AE%A1%E7%A9%BA%E5%80%BC%E6%95%B0%E9%87%8F"><span class="nav-text">统计空值数量</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%AE%A1%E7%AE%97%E7%BC%BA%E5%A4%B1%E7%8E%87"><span class="nav-text">计算缺失率</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%A0%E9%99%A4%E5%90%AB%E6%9C%89%E7%A9%BA%E5%80%BC%E7%9A%84%E8%A1%8C%E6%88%96%E5%88%97"><span class="nav-text">删除含有空值的行或列</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#DataFrame-dropna-%E5%8F%82%E6%95%B0%E8%AF%B4%E6%98%8E%EF%BC%9A"><span class="nav-text">DataFrame.dropna 参数说明：</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%A1%AB%E5%85%85%E7%A9%BA%E5%80%BC"><span class="nav-text">填充空值</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%94%99%E8%AF%AF%E6%95%B0%E6%8D%AE%E6%B8%85%E6%B4%97"><span class="nav-text">错误数据清洗</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9B%BF%E6%8D%A2%E9%94%99%E8%AF%AF%E6%95%B0%E6%8D%AE"><span class="nav-text">替换错误数据</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9B%B4%E6%8E%A5%E6%9B%BF%E6%8D%A2%E7%89%B9%E5%AE%9A%E9%94%99%E8%AF%AF%E6%95%B0%E6%8D%AE"><span class="nav-text">直接替换特定错误数据</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%9F%BA%E4%BA%8E%E6%9D%A1%E4%BB%B6%E7%9A%84%E6%89%B9%E9%87%8F%E6%9B%BF%E6%8D%A2"><span class="nav-text">基于条件的批量替换</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%A0%E9%99%A4%E9%94%99%E8%AF%AF%E6%95%B0%E6%8D%AE"><span class="nav-text">删除错误数据</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E6%A0%BC%E5%BC%8F%E9%94%99%E8%AF%AF%E5%A4%84%E7%90%86"><span class="nav-text">数据格式错误处理</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81%E8%A7%A3%E6%9E%90"><span class="nav-text">代码解析</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%89%A9%E5%B1%95%E5%92%8C%E6%94%B9%E8%BF%9B"><span class="nav-text">扩展和改进</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E7%BB%9F%E8%AE%A1%E5%92%8C%E8%BF%90%E7%AE%97"><span class="nav-text">数据统计和运算</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9C%80%E5%A4%A7%E5%80%BC%E5%92%8C%E6%9C%80%E5%B0%8F%E5%80%BC%EF%BC%9Amax-%E5%92%8C-min"><span class="nav-text">最大值和最小值：max() 和 min()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%9D%9E%E7%BC%BA%E5%A4%B1%E5%80%BC%E7%9A%84%E6%95%B0%E9%87%8F%EF%BC%9Acount"><span class="nav-text">非缺失值的数量：count()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B1%82%E5%92%8C%E4%B8%8E%E7%B4%AF%E5%8A%A0%EF%BC%9Asum-%E5%92%8C-cumsum"><span class="nav-text">求和与累加：sum() 和 cumsum()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8E%92%E5%BA%8F%EF%BC%9Asort-values-%E5%92%8C-sort-index"><span class="nav-text">排序：sort_values() 和 sort_index()</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8C%89%E5%88%97%E5%80%BC%E6%8E%92%E5%BA%8F"><span class="nav-text">按列值排序</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8C%89%E7%B4%A2%E5%BC%95%E6%8E%92%E5%BA%8F"><span class="nav-text">按索引排序</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%89%A9%E5%B1%95"><span class="nav-text">扩展</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E5%88%86%E7%BB%84%E5%92%8C%E8%81%9A%E5%90%88"><span class="nav-text">数据分组和聚合</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#df-groupby-column-name"><span class="nav-text">df.groupby(column_name)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#df-aggregate-function-name"><span class="nav-text">df.aggregate(function_name)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#df-pivot-table-values-index-columns-aggfunc"><span class="nav-text">df.pivot_table(values, index, columns, aggfunc)</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%A1%88%E4%BE%8B-1"><span class="nav-text">案例</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E5%AF%BC%E5%85%A5%E4%B8%8E%E6%BC%94%E7%A4%BA"><span class="nav-text">数据导入与演示</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%80%BB%E7%BC%BA%E5%A4%B1%E7%8E%87"><span class="nav-text">总缺失率</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%89%8B%E6%9C%BA%E8%AE%A4%E8%AF%81%E7%94%A8%E6%88%B7%E5%80%9F%E8%B4%B7%E7%AC%94%E6%95%B0"><span class="nav-text">手机认证用户借贷笔数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%88%B7%E9%97%A8%E8%AE%A4%E8%AF%81%E7%94%A8%E6%88%B7%E5%80%9F%E8%B4%B7%E6%83%85%E5%86%B5"><span class="nav-text">户门认证用户借贷情况</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BE%81%E4%BF%A1%E8%AE%A4%E8%AF%81%E7%94%A8%E6%88%B7%E5%80%9F%E8%B4%B7%E6%83%85%E5%86%B5"><span class="nav-text">征信认证用户借贷情况</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%80%A7%E5%88%AB%E8%AE%A4%E8%AF%81%E7%94%A8%E6%88%B7%E8%BF%98%E6%AC%BE%E6%83%85%E5%86%B5"><span class="nav-text">性别认证用户还款情况</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%8D%E5%90%8C%E6%80%A7%E5%88%AB%E7%94%A8%E6%88%B7%E8%BF%98%E6%AC%BE%E5%8D%A0%E6%AF%94%E6%83%85%E5%86%B5"><span class="nav-text">不同性别用户还款占比情况</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AD%A6%E5%8E%86%E8%AE%A4%E8%AF%81%E7%94%A8%E6%88%B7%E8%BF%98%E6%AC%BE%E6%83%85%E5%86%B5"><span class="nav-text">学历认证用户还款情况</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AD%A6%E5%8E%86%E8%AE%A4%E8%AF%81%E7%94%A8%E6%88%B7%E8%BF%98%E6%AC%BE%E5%8D%A0%E6%AF%94%E6%83%85%E5%86%B5"><span class="nav-text">学历认证用户还款占比情况</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%8D%E5%90%8C%E5%B9%B4%E9%BE%84%E6%AE%B5%E7%94%A8%E6%88%B7%E5%80%9F%E6%AC%BE%E7%BB%9F%E8%AE%A1"><span class="nav-text">不同年龄段用户借款统计</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%8D%E5%90%8C%E5%B9%B4%E9%BE%84%E6%AE%B5%E7%94%A8%E6%88%B7%E8%BF%98%E6%AC%BE%E5%8D%A0%E6%AF%94%E7%BB%9F%E8%AE%A1"><span class="nav-text">不同年龄段用户还款占比统计</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90%E5%B8%B8%E7%94%A8%E5%87%BD%E6%95%B0"><span class="nav-text">数据分析常用函数</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E7%AD%9B%E9%80%89"><span class="nav-text">数据筛选</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E9%A2%84%E8%A7%88"><span class="nav-text">数据预览</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BC%BA%E5%A4%B1%E5%80%BC%E4%B8%8E%E9%87%8D%E5%A4%8D%E5%80%BC"><span class="nav-text">缺失值与重复值</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E5%80%BC%E6%93%8D%E4%BD%9C"><span class="nav-text">数据值操作</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%A1%8C-%E5%88%97%E6%93%8D%E4%BD%9C"><span class="nav-text">行&#x2F;列操作</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%95%B0%E5%80%BC%E6%95%B0%E6%8D%AE%E7%BB%9F%E8%AE%A1%E8%BF%90%E7%AE%97"><span class="nav-text">数值数据统计运算</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%96%87%E6%9C%AC%E6%95%B0%E6%8D%AE%E6%93%8D%E4%BD%9C"><span class="nav-text">文本数据操作</span></a></li></ol></li></ol>

    </div>
</div>
        </div>
    
</div>



                

            </div>

            

        </div>

        <div class="main-content-footer">
            <footer class="footer mt-5 py-5 h-auto text-base text-third-text-color relative border-t-2 border-t-border-color">
    <div class="info-container py-3 text-center">
        
        <div class="text-center">
            &copy;
            
              <span>2018</span>
              -
            
            2024&nbsp;&nbsp;<i class="fa-solid fa-cog fa-spin" style="--fa-animation-duration: 5s"></i>&nbsp;&nbsp;<a href="/">Yiuhang Chan</a>
            
                
                <p class="post-count space-x-0.5">
                    <span>
                        共 41 篇文章
                    </span>
                    
                        <span>
                            共 348k 字
                        </span>
                    
                </p>
            
        </div>
        
            <script data-swup-reload-script src="https://cn.vercount.one/js"></script>
            <div class="relative text-center lg:absolute lg:right-[20px] lg:top-1/2 lg:-translate-y-1/2 lg:text-right">
                
                    <span id="busuanzi_container_site_uv" class="lg:!block">
                        <span class="text-sm">访问人数</span>
                        <span id="busuanzi_value_site_uv"></span>
                    </span>
                
                
                    <span id="busuanzi_container_site_pv" class="lg:!block">
                        <span class="text-sm">总访问量</span>
                        <span id="busuanzi_value_site_pv"></span>
                    </span>
                
            </div>
        
        <div class="relative text-center lg:absolute lg:left-[20px] lg:top-1/2 lg:-translate-y-1/2 lg:text-left">
            <span class="lg:block text-sm">由 <?xml version="1.0" encoding="utf-8"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg class="relative top-[2px] inline-block align-baseline" version="1.1" id="圖層_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="1rem" height="1rem" viewBox="0 0 512 512" enable-background="new 0 0 512 512" xml:space="preserve"><path fill="#0E83CD" d="M256.4,25.8l-200,115.5L56,371.5l199.6,114.7l200-115.5l0.4-230.2L256.4,25.8z M349,354.6l-18.4,10.7l-18.6-11V275H200v79.6l-18.4,10.7l-18.6-11v-197l18.5-10.6l18.5,10.8V237h112v-79.6l18.5-10.6l18.5,10.8V354.6z"/></svg><a target="_blank" class="text-base" href="https://hexo.io">Hexo</a> 驱动</span>
            <span class="text-sm lg:block">主题&nbsp;<a class="text-base" target="_blank" href="https://github.com/EvanNotFound/hexo-theme-redefine">Redefine v2.6.1</a></span>
        </div>
        
        
            <div>
                博客已运行 <span class="odometer" id="runtime_days" ></span> 天 <span class="odometer" id="runtime_hours"></span> 小时 <span class="odometer" id="runtime_minutes"></span> 分钟 <span class="odometer" id="runtime_seconds"></span> 秒
            </div>
        
        
            <script data-swup-reload-script>
                try {
                    function odometer_init() {
                    const elements = document.querySelectorAll('.odometer');
                    elements.forEach(el => {
                        new Odometer({
                            el,
                            format: '( ddd).dd',
                            duration: 200
                        });
                    });
                    }
                    odometer_init();
                } catch (error) {}
            </script>
        
        
        
    </div>  
</footer>
        </div>
    </div>

    
        <div class="post-tools">
            <div class="post-tools-container">
    <ul class="article-tools-list">
        <!-- TOC aside toggle -->
        
            <li class="right-bottom-tools page-aside-toggle">
                <i class="fa-regular fa-outdent"></i>
            </li>
        

        <!-- go comment -->
        
            <li class="go-comment">
                <i class="fa-regular fa-comments"></i>
            </li>
        
    </ul>
</div>

        </div>
    

    <div class="right-side-tools-container">
        <div class="side-tools-container">
    <ul class="hidden-tools-list">
        <li class="right-bottom-tools tool-font-adjust-plus flex justify-center items-center">
            <i class="fa-regular fa-magnifying-glass-plus"></i>
        </li>

        <li class="right-bottom-tools tool-font-adjust-minus flex justify-center items-center">
            <i class="fa-regular fa-magnifying-glass-minus"></i>
        </li>

        <li class="right-bottom-tools tool-dark-light-toggle flex justify-center items-center">
            <i class="fa-regular fa-moon"></i>
        </li>

        <!-- rss -->
        
            <li class="right-bottom-tools rss flex justify-center items-center">
                <a class="flex justify-center items-center"
                   href="/atom.xml"
                   target="_blank"
                >
                <i class="fa-regular fa-rss"></i>
                </a>
            </li>
        

        

        <li class="right-bottom-tools tool-scroll-to-bottom flex justify-center items-center">
            <i class="fa-regular fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="visible-tools-list">
        <li class="right-bottom-tools toggle-tools-list flex justify-center items-center">
            <i class="fa-regular fa-cog fa-spin"></i>
        </li>
        
            <li class="right-bottom-tools tool-scroll-to-top flex justify-center items-center">
                <i class="arrow-up fas fa-arrow-up"></i>
                <span class="percent"></span>
            </li>
        
        
    </ul>
</div>

    </div>

    <div class="image-viewer-container">
    <img src="">
</div>


    
        <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
          <span class="search-input-field-pre">
            <i class="fa-solid fa-keyboard"></i>
          </span>
            <div class="search-input-container">
                <input autocomplete="off"
                       autocorrect="off"
                       autocapitalize="off"
                       placeholder="搜索..."
                       spellcheck="false"
                       type="search"
                       class="search-input"
                >
            </div>
            <span class="popup-btn-close">
                <i class="fa-solid fa-times"></i>
            </span>
        </div>
        <div id="search-result">
            <div id="no-result">
                <i class="fa-solid fa-spinner fa-spin-pulse fa-5x fa-fw"></i>
            </div>
        </div>
    </div>
</div>

    

</main>


    
<script src="/js/libs/Swup.min.js"></script>

<script src="/js/libs/SwupSlideTheme.min.js"></script>

<script src="/js/libs/SwupScriptsPlugin.min.js"></script>

<script src="/js/libs/SwupProgressPlugin.min.js"></script>

<script src="/js/libs/SwupScrollPlugin.min.js"></script>

<script src="/js/libs/SwupPreloadPlugin.min.js"></script>

<script>
    const swup = new Swup({
        plugins: [
            new SwupScriptsPlugin({
                optin: true,
            }),
            new SwupProgressPlugin(),
            new SwupScrollPlugin({
                offset: 80,
            }),
            new SwupSlideTheme({
                mainElement: ".main-content-body",
            }),
            new SwupPreloadPlugin(),
        ],
        containers: ["#swup"],
    });
</script>







<script src="/js/tools/imageViewer.js" type="module"></script>

<script src="/js/utils.js" type="module"></script>

<script src="/js/main.js" type="module"></script>

<script src="/js/layouts/navbarShrink.js" type="module"></script>

<script src="/js/tools/scrollTopBottom.js" type="module"></script>

<script src="/js/tools/lightDarkSwitch.js" type="module"></script>

<script src="/js/layouts/categoryList.js" type="module"></script>



    
<script src="/js/tools/localSearch.js" type="module"></script>




    
<script src="/js/tools/codeBlock.js" type="module"></script>




    
<script src="/js/layouts/lazyload.js" type="module"></script>




    
<script src="/js/tools/runtime.js"></script>

    
<script src="/js/libs/odometer.min.js"></script>

    
<link rel="stylesheet" href="/assets/odometer-theme-minimal.css">




  
<script src="/js/libs/Typed.min.js"></script>

  
<script src="/js/plugins/typed.js" type="module"></script>




    
<script src="/js/libs/mermaid.min.js"></script>

    
<script src="/js/plugins/mermaid.js"></script>







<div class="post-scripts" data-swup-reload-script>
    
        
<script src="/js/tools/tocToggle.js" type="module"></script>

<script src="/js/layouts/toc.js" type="module"></script>

<script src="/js/plugins/tabs.js" type="module"></script>

    
</div>


</body>
</html>
